---
title: Bir İşlemde Kaynakları Katılımcı Olarak Kaydetme
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 786a12c2-d530-49f4-9c59-5c973e15a11d
ms.openlocfilehash: 98872bd3ccddb1696b37eace0e28156cdbe002dc
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/23/2019
ms.locfileid: "61793737"
---
# <a name="enlisting-resources-as-participants-in-a-transaction"></a><span data-ttu-id="e2251-102">Bir İşlemde Kaynakları Katılımcı Olarak Kaydetme</span><span class="sxs-lookup"><span data-stu-id="e2251-102">Enlisting Resources as Participants in a Transaction</span></span>

<span data-ttu-id="e2251-103">Bir işlemde katılan her kaynak eylemlerini bir işlem yöneticisi tarafından düzenlenir bir kaynak yöneticisi tarafından yönetilir.</span><span class="sxs-lookup"><span data-stu-id="e2251-103">Each resource participating in a transaction is managed by a resource manager, whose actions are coordinated by a transaction manager.</span></span> <span data-ttu-id="e2251-104">İşbirliği İşlem Yöneticisi aracılığıyla bir işlemde kayıtlı aboneleri için verilen bildirimleri üzerinden yapılır.</span><span class="sxs-lookup"><span data-stu-id="e2251-104">The coordination is done through notifications given to subscribers who have enlisted in a transaction through the transaction manager.</span></span>

<span data-ttu-id="e2251-105">Bu konu nasıl bir kaynak (veya birden fazla kaynak) bir işlem, yanı sıra liste farklı türde kaydedilebilir kapsar.</span><span class="sxs-lookup"><span data-stu-id="e2251-105">This topic covers how a resource (or multiple resources) can be enlisted in a transaction, as well as the different types of enlistment.</span></span> <span data-ttu-id="e2251-106">[Tek aşamalı ve çok aşamalı bir işlem Sistemi'ne](../../../../docs/framework/data/transactions/committing-a-transaction-in-single-phase-and-multi-phase.md) konuyu kapsayan nasıl işlem taahhüt kayıtlı kaynakları arasında Eşgüdümlü olabilir.</span><span class="sxs-lookup"><span data-stu-id="e2251-106">The [Committing a Transaction in Single-Phase and Multi-Phase](../../../../docs/framework/data/transactions/committing-a-transaction-in-single-phase-and-multi-phase.md) topic covers how transaction commitment can be coordinated among enlisted resources.</span></span>

## <a name="enlisting-resources-in-a-transaction"></a><span data-ttu-id="e2251-107">Bir işlemde kaynakları kaydetme</span><span class="sxs-lookup"><span data-stu-id="e2251-107">Enlisting Resources in a Transaction</span></span>

<span data-ttu-id="e2251-108">Bir işlemde bir kaynak için sırada bu işleme gerekir.</span><span class="sxs-lookup"><span data-stu-id="e2251-108">In order for a resource to participate in a transaction, it must enlist in the transaction.</span></span> <span data-ttu-id="e2251-109"><xref:System.Transactions.Transaction> Sınıfı tanımlayan bir dizi yöntem adları ile başlayan **Enlist** bu işlevselliği sağlar.</span><span class="sxs-lookup"><span data-stu-id="e2251-109">The <xref:System.Transactions.Transaction> class defines a set of methods whose names begin with **Enlist** that provide this functionality.</span></span> <span data-ttu-id="e2251-110">Farklı **Enlist** yöntemleri karşılık farklı türde bir kaynak yöneticisi olabilir liste için.</span><span class="sxs-lookup"><span data-stu-id="e2251-110">The different **Enlist** methods correspond to the different types of enlistment that a resource manager may have.</span></span> <span data-ttu-id="e2251-111">Özellikle, kullandığınız <xref:System.Transactions.Transaction.EnlistVolatile%2A> geçici kaynaklar için yöntemleri ve <xref:System.Transactions.Transaction.EnlistDurable%2A> kalıcı kaynaklar için yöntem.</span><span class="sxs-lookup"><span data-stu-id="e2251-111">Specifically, you use the <xref:System.Transactions.Transaction.EnlistVolatile%2A> methods for volatile resources, and the <xref:System.Transactions.Transaction.EnlistDurable%2A> method for durable resources.</span></span> <span data-ttu-id="e2251-112">Süreklilik (veya tersine volatility) kaynak yöneticisi kaynak yöneticisi hatası kurtarma destekleyip başvuruyor.</span><span class="sxs-lookup"><span data-stu-id="e2251-112">The durability (or conversely the volatility) of a resource manager refers to whether the resource manager supports failure recovery.</span></span> <span data-ttu-id="e2251-113">Bir kaynak yöneticisi hatası kurtarma destekliyorsa, aşama 1 sırasında veri kalıcı depolama devam (Hazırla) sağlayacak şekilde kaynak yöneticisi kalırsa, onu kurtarma sonra işlemi yeniden listeleme ve bildirimlere dayalı uygun eylemleri gerçekleştirin TM alınan.</span><span class="sxs-lookup"><span data-stu-id="e2251-113">If a resource manager supports failure recovery, it persists data to durable storage during Phase1 (prepare) such that if the resource manager goes down, it can re-enlist in the transaction upon recovery and perform the proper actions based on the notifications received from the TM.</span></span> <span data-ttu-id="e2251-114">Genel olarak, geçici kaynak yöneticileri bir bellek içi veri yapısı (örneğin, bir bellek içi hareket gerçekleşti-karma tablosu) gibi geçici kaynaklarını yönetmek ve kalıcı kaynak yöneticileri daha kalıcı bir yedekleme deposu sahip kaynakları yönetin (örneğin, bir Veritabanı) yedekleme deposu ayarlanmış olan bir disktir.</span><span class="sxs-lookup"><span data-stu-id="e2251-114">In general, volatile resource managers manage volatile resources such as an in-memory data structure (for example, an in-memory transacted-hashtable), and durable resource managers manage resources that have a more persistent backing store (for example, a database whose backing store is disk).</span></span>

<span data-ttu-id="e2251-115">Kullanılacak karar sonra kolaylık <xref:System.Transactions.Transaction.EnlistDurable%2A> veya <xref:System.Transactions.Transaction.EnlistVolatile%2A> , kaynağın süreklilik desteğini tabanlı yöntemi, iki aşaması yürütme içinde (2PC) uygulayarak katılmak için kaynak listeleme <xref:System.Transactions.IEnlistmentNotification> , kaynak yöneticisi için arabirim.</span><span class="sxs-lookup"><span data-stu-id="e2251-115">For simplicity, after deciding whether to use the <xref:System.Transactions.Transaction.EnlistDurable%2A> or <xref:System.Transactions.Transaction.EnlistVolatile%2A> method based on your resource's durability support, you should enlist your resource to participate in Two Phase Commit (2PC) by implementing the <xref:System.Transactions.IEnlistmentNotification> interface for your resource manager.</span></span> <span data-ttu-id="e2251-116">2PC hakkında daha fazla bilgi için bkz. [tek aşamalı ve çok aşamalı bir işlem Sistemi'ne](../../../../docs/framework/data/transactions/committing-a-transaction-in-single-phase-and-multi-phase.md).</span><span class="sxs-lookup"><span data-stu-id="e2251-116">For more information on 2PC, see [Committing a Transaction in Single-Phase and Multi-Phase](../../../../docs/framework/data/transactions/committing-a-transaction-in-single-phase-and-multi-phase.md).</span></span>

<span data-ttu-id="e2251-117">Tek bir katılımcı çağırarak birden fazla bu iletişim kuralları için listeleme <xref:System.Transactions.Transaction.EnlistDurable%2A> ve <xref:System.Transactions.Transaction.EnlistVolatile%2A> birden çok kez.</span><span class="sxs-lookup"><span data-stu-id="e2251-117">A single participant can enlist for more than one of these protocols by calling <xref:System.Transactions.Transaction.EnlistDurable%2A> and <xref:System.Transactions.Transaction.EnlistVolatile%2A> multiple times.</span></span>

### <a name="durable-enlistment"></a><span data-ttu-id="e2251-118">Kalıcı liste</span><span class="sxs-lookup"><span data-stu-id="e2251-118">Durable Enlistment</span></span>

<span data-ttu-id="e2251-119"><xref:System.Transactions.Transaction.EnlistDurable%2A> Yöntemleri kalıcı bir kaynak olarak işlem katılım için bir kaynak yöneticisi listeleme için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="e2251-119">The <xref:System.Transactions.Transaction.EnlistDurable%2A> methods are used to enlist a resource manager for participation in the transaction as a durable resource.</span></span>  <span data-ttu-id="e2251-120">Kalıcı Kaynak Yöneticisi ortasında bir işlem alınırsa, reenlisting tarafından tekrar çevrimiçi olana sonra onu kurtarma gerçekleştirebileceğiniz beklenir (kullanarak <xref:System.Transactions.TransactionManager.Reenlist%2A> yöntemi), bu katılımcı oluştu ve belirtmiyor tüm işlemlerde 2. Aşama tamamlandı ve çağrı <xref:System.Transactions.TransactionManager.RecoveryComplete%2A> kurtarma işlemini tamamladıktan sonra.</span><span class="sxs-lookup"><span data-stu-id="e2251-120">It is expected that if a durable resource manager is brought down in the middle of a transaction, it can perform recovery once it is brought back online by reenlisting (using the <xref:System.Transactions.TransactionManager.Reenlist%2A> method) in all transactions in which it was a participant and did not complete phase 2, and call <xref:System.Transactions.TransactionManager.RecoveryComplete%2A> once it finishes recovery processing.</span></span> <span data-ttu-id="e2251-121">Kurtarma hakkında daha fazla bilgi için bkz. [kurtarma gerçekleştirme](../../../../docs/framework/data/transactions/performing-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="e2251-121">For more information on recovery, see [Performing Recovery](../../../../docs/framework/data/transactions/performing-recovery.md).</span></span>

<span data-ttu-id="e2251-122"><xref:System.Transactions.Transaction.EnlistDurable%2A> Tüm getirin yöntemleri bir <xref:System.Guid> kendi ilk parameTRe olarak nesne.</span><span class="sxs-lookup"><span data-stu-id="e2251-122">The <xref:System.Transactions.Transaction.EnlistDurable%2A> methods all take a <xref:System.Guid> object as their first parameter.</span></span> <span data-ttu-id="e2251-123"><xref:System.Guid> Hareket yöneticisi tarafından kalıcı bir liste belirli kaynak yöneticisi ile ilişkilendirmek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="e2251-123">The <xref:System.Guid> is used by the transaction manager to associate a durable enlistment with a particular resource manager.</span></span> <span data-ttu-id="e2251-124">Bu nedenle, bu kaynak yöneticisi tutarlı bir şekilde aynı kullandığını zorunludur <xref:System.Guid> kendisi arasında bile yeniden başlatıldığında farklı kaynak yöneticileri belirlemek için Aksi takdirde kurtarma başarısız olabilir.</span><span class="sxs-lookup"><span data-stu-id="e2251-124">As such, it is imperative that a resource manager consistently uses the same <xref:System.Guid> to identify itself even across different resource managers upon restarting, otherwise the recovery can fail.</span></span>

<span data-ttu-id="e2251-125">İkinci parametresi <xref:System.Transactions.Transaction.EnlistDurable%2A> için işlem bildirimi almak için kaynak yöneticisi uygulayan nesnenin bir başvuru yöntemdir.</span><span class="sxs-lookup"><span data-stu-id="e2251-125">The second parameter of the <xref:System.Transactions.Transaction.EnlistDurable%2A> method is a reference to the object that the resource manager implements to receive transaction notifications.</span></span> <span data-ttu-id="e2251-126">Kullandığınız aşırı yüklemesi, kaynak yöneticisi tek aşaması yürütme (SPC) en iyi duruma getirme destekleyip desteklemediğini hareket yöneticisi bildirir.</span><span class="sxs-lookup"><span data-stu-id="e2251-126">The overload you use informs the transaction manager whether your resource manager supports the Single Phase Commit (SPC) optimization.</span></span> <span data-ttu-id="e2251-127">Çoğu zaman uygulamak <xref:System.Transactions.IEnlistmentNotification> Two-Phase (2PC) içinde yürütme katılmak için arabirim.</span><span class="sxs-lookup"><span data-stu-id="e2251-127">Most of the time you would implement the <xref:System.Transactions.IEnlistmentNotification> interface to take part in Two-Phase Commit (2PC).</span></span> <span data-ttu-id="e2251-128">Kaydetme işlemi iyileştirmek istiyorsanız, ancak, uygulama düşünebilirsiniz <xref:System.Transactions.ISinglePhaseNotification> SPC için arabirim.</span><span class="sxs-lookup"><span data-stu-id="e2251-128">However, if you want to optimize the commit process, you can consider implementing the <xref:System.Transactions.ISinglePhaseNotification> interface for SPC.</span></span> <span data-ttu-id="e2251-129">SPC hakkında daha fazla bilgi için bkz. [tek aşamalı ve çok aşamalı bir işlem Sistemi'ne](../../../../docs/framework/data/transactions/committing-a-transaction-in-single-phase-and-multi-phase.md) ve [tek aşamalı işleme ve yükseltilebilir tek aşamalı bildirim kullanarak en iyi duruma getirme](../../../../docs/framework/data/transactions/optimization-spc-and-promotable-spn.md).</span><span class="sxs-lookup"><span data-stu-id="e2251-129">For more information on SPC, see [Committing a Transaction in Single-Phase and Multi-Phase](../../../../docs/framework/data/transactions/committing-a-transaction-in-single-phase-and-multi-phase.md) and [Optimization using Single Phase Commit and Promotable Single Phase Notification](../../../../docs/framework/data/transactions/optimization-spc-and-promotable-spn.md).</span></span>

<span data-ttu-id="e2251-130">Üçüncü parameTRe bir <xref:System.Transactions.EnlistmentOptions> numaralandırma değeri ya da olabilir, <xref:System.Transactions.EnlistmentOptions.None> veya <xref:System.Transactions.EnlistmentOptions.EnlistDuringPrepareRequired>.</span><span class="sxs-lookup"><span data-stu-id="e2251-130">The third parameter is an <xref:System.Transactions.EnlistmentOptions> enumeration, whose value can be either <xref:System.Transactions.EnlistmentOptions.None> or <xref:System.Transactions.EnlistmentOptions.EnlistDuringPrepareRequired>.</span></span> <span data-ttu-id="e2251-131">Değer ayarlanmışsa <xref:System.Transactions.EnlistmentOptions.EnlistDuringPrepareRequired>, liste hazırla bildirim alma İşlem Yöneticisi'nden sonra ek kaynak yöneticileri listeleyebilir.</span><span class="sxs-lookup"><span data-stu-id="e2251-131">If the value is set to <xref:System.Transactions.EnlistmentOptions.EnlistDuringPrepareRequired>, the enlistment may enlist additional resource managers upon receiving the Prepare notification from the transaction manager.</span></span> <span data-ttu-id="e2251-132">Ancak, bu liste türü tek aşaması yürütme en iyi hale getirme için uygun değil bilmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="e2251-132">However, you should be aware that this type of enlistment is not eligible for the Single Phase Commit optimization.</span></span>

### <a name="volatile-enlistment"></a><span data-ttu-id="e2251-133">Geçici liste</span><span class="sxs-lookup"><span data-stu-id="e2251-133">Volatile Enlistment</span></span>

<span data-ttu-id="e2251-134">Gibi bir önbellek kullanarak listeleme geçici kaynaklarını yönetme katılımcıları <xref:System.Transactions.Transaction.EnlistVolatile%2A> yöntemleri.</span><span class="sxs-lookup"><span data-stu-id="e2251-134">Participants managing volatile resources such as a cache should enlist using the <xref:System.Transactions.Transaction.EnlistVolatile%2A> methods.</span></span> <span data-ttu-id="e2251-135">Bu tür nesneler bir işlem sonucunu elde veya bunlar sonra bir sistem hatası katılmak herhangi bir işlem durumunu kurtarma mümkün olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="e2251-135">Such objects might not be able to obtain the outcome of a transaction or recover the state of any transaction they participate in after a system failure.</span></span>

<span data-ttu-id="e2251-136">Bir bellek içi, geçici kaynak yönettiği, yukarıda belirtildiği gibi bir kaynak yöneticisi geçici bir liste hale getireceği.</span><span class="sxs-lookup"><span data-stu-id="e2251-136">As stated previously, a resource manager would make a volatile enlistment if it manages an in-memory, volatile resource.</span></span> <span data-ttu-id="e2251-137">Kullanmanın faydaları birini <xref:System.Transactions.Transaction.EnlistVolatile%2A> olan işlemin gereksiz bir yükseltme zorlamaz.</span><span class="sxs-lookup"><span data-stu-id="e2251-137">One of the benefits of using <xref:System.Transactions.Transaction.EnlistVolatile%2A> is that it does not force an unnecessary escalation of the transaction.</span></span> <span data-ttu-id="e2251-138">İşlem yükseltme hakkında daha fazla bilgi için bkz. [işlem yönetim yükseltme](../../../../docs/framework/data/transactions/transaction-management-escalation.md) konu.</span><span class="sxs-lookup"><span data-stu-id="e2251-138">For more information on transaction escalation, see [Transaction Management Escalation](../../../../docs/framework/data/transactions/transaction-management-escalation.md) topic.</span></span> <span data-ttu-id="e2251-139">Liste işlem yöneticisi tarafından nasıl işlendiğini içinde her iki fark gelir geçiciliğine kaydetme hareket yöneticisi tarafından Kaynak Yöneticisi'nin beklenen yanı sıra.</span><span class="sxs-lookup"><span data-stu-id="e2251-139">Enlisting volatility implies both a difference in how the enlistment is handled by the transaction manager, as well as what is expected of the resource manager by the transaction manager.</span></span> <span data-ttu-id="e2251-140">Geçici Kaynak Yöneticisi kurtarma gerçekleştirmez olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="e2251-140">This is because a volatile resource manager does not perform recovery.</span></span> <span data-ttu-id="e2251-141"><xref:System.Transactions.Transaction.EnlistVolatile%2A> Yöntemleri olması değil bir <xref:System.Guid> parameTResi, çünkü geçici Kaynak Yöneticisi kurtarma gerçekleştirmez ve değil çağırırsınız <xref:System.Transactions.TransactionManager.Reenlist%2A> gereken yöntemi bir <xref:System.Guid>.</span><span class="sxs-lookup"><span data-stu-id="e2251-141">The <xref:System.Transactions.Transaction.EnlistVolatile%2A> methods do not take a <xref:System.Guid> parameter, because a volatile resource manager does not perform recovery and would not call the <xref:System.Transactions.TransactionManager.Reenlist%2A> method which needs a <xref:System.Guid>.</span></span>

<span data-ttu-id="e2251-142">Kalıcı kayıtlar gibi ile hareket yöneticisi ile listeleme için kullandığınız hangi aşırı yükleme yöntemi, kaynak yöneticisi tek aşaması yürütme en iyi duruma getirme destekleyip desteklemediğini gösterir.</span><span class="sxs-lookup"><span data-stu-id="e2251-142">As with durable enlistments, whichever overload method you use to enlist denotes to the transaction manager whether your resource manager supports the Single Phase Commit optimization.</span></span> <span data-ttu-id="e2251-143">Geçici Kaynak Yöneticisi kurtarma gerçekleştiremezsiniz dolayı hiçbir kurtarma bilgi hazırla aşamasında geçici bir liste için yazılır.</span><span class="sxs-lookup"><span data-stu-id="e2251-143">Since a volatile resource manager cannot perform recovery, no recovery information is written for a volatile enlistment during the Prepare phase.</span></span> <span data-ttu-id="e2251-144">Bu nedenle, çağırma <xref:System.Transactions.PreparingEnlistment.RecoveryInformation%2A> yöntemi sonuçlanıyor bir <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="e2251-144">Therefore, calling the <xref:System.Transactions.PreparingEnlistment.RecoveryInformation%2A> method results in an <xref:System.InvalidOperationException>.</span></span>

<span data-ttu-id="e2251-145">Aşağıdaki örnekte, böyle bir nesne katılımcı kullanarak işlem listeleme gösterilmiştir <xref:System.Transactions.Transaction.EnlistVolatile%2A> yöntemi.</span><span class="sxs-lookup"><span data-stu-id="e2251-145">The following example shows how to enlist such an object as a participant in a transaction using the <xref:System.Transactions.Transaction.EnlistVolatile%2A> method.</span></span>

[!code-csharp[Tx_Enlist#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/tx_enlist/cs/enlist.cs#1)]
[!code-vb[Tx_Enlist#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/tx_enlist/vb/enlist.vb#1)]

### <a name="optimizing-performance"></a><span data-ttu-id="e2251-146">Performansı en iyi duruma getirme</span><span class="sxs-lookup"><span data-stu-id="e2251-146">Optimizing Performance</span></span>

<span data-ttu-id="e2251-147"><xref:System.Transactions.Transaction> Sınıfı sağlar <xref:System.Transactions.Transaction.EnlistPromotableSinglePhase%2A> bir Promotable tek aşaması liste'nı (PSPE) listeleme yöntemi.</span><span class="sxs-lookup"><span data-stu-id="e2251-147">The <xref:System.Transactions.Transaction> class also provides the <xref:System.Transactions.Transaction.EnlistPromotableSinglePhase%2A> method to enlist a Promotable Single Phase Enlistment (PSPE).</span></span> <span data-ttu-id="e2251-148">Bu bir kalıcı Kaynak Yöneticisi (ana bilgisayar ve "daha sonra gerekirse MSDTC tarafından yönetilmek üzere ilerletilmiş bir işlem sahibi" RM) sağlar.</span><span class="sxs-lookup"><span data-stu-id="e2251-148">This allows a durable resource manager (RM) to host and "own" a transaction that can later be escalated to be managed by the MSDTC if necessary.</span></span> <span data-ttu-id="e2251-149">Bunun hakkında daha fazla bilgi için bkz. [tek aşamalı işleme ve yükseltilebilir tek aşamalı bildirim kullanarak en iyi duruma getirme](../../../../docs/framework/data/transactions/optimization-spc-and-promotable-spn.md).</span><span class="sxs-lookup"><span data-stu-id="e2251-149">For more information on this, see [Optimization using Single Phase Commit and Promotable Single Phase Notification](../../../../docs/framework/data/transactions/optimization-spc-and-promotable-spn.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="e2251-150">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="e2251-150">See also</span></span>

- [<span data-ttu-id="e2251-151">Tek Aşamalı İşleme ve Yükseltilebilir Tek Aşamalı Bildirim kullanarak en iyi duruma getirme</span><span class="sxs-lookup"><span data-stu-id="e2251-151">Optimization using Single Phase Commit and Promotable Single Phase Notification</span></span>](../../../../docs/framework/data/transactions/optimization-spc-and-promotable-spn.md)
- [<span data-ttu-id="e2251-152">Tek Aşamalı ve Çok Aşamalı İşlem Gerçekleştirme</span><span class="sxs-lookup"><span data-stu-id="e2251-152">Committing a Transaction in Single-Phase and Multi-Phase</span></span>](../../../../docs/framework/data/transactions/committing-a-transaction-in-single-phase-and-multi-phase.md)
