---
title: Veri hizmeti bağlamını yönetme (WCF Veri Hizmetleri)
ms.date: 03/30/2017
ms.assetid: 15b19d09-7de7-4638-9556-6ef396cc45ec
ms.openlocfilehash: 0278e8c31ffa7e9aaab5960c71cee091c9ea586a
ms.sourcegitcommit: d2e1dfa7ef2d4e9ffae3d431cf6a4ffd9c8d378f
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 09/07/2019
ms.locfileid: "70779864"
---
# <a name="managing-the-data-service-context-wcf-data-services"></a>Veri hizmeti bağlamını yönetme (WCF Veri Hizmetleri)
Sınıfı <xref:System.Data.Services.Client.DataServiceContext> , belirtilen bir veri hizmetine göre desteklenen işlemleri kapsüller. Hizmetler [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] durum bilgisiz olsa da bağlam değildir. Bu nedenle, değişiklik yönetimi gibi <xref:System.Data.Services.Client.DataServiceContext> özellikleri desteklemek için veri hizmeti ile etkileşimler arasında istemcideki durumu korumak için sınıfını kullanabilirsiniz. Bu sınıf Ayrıca kimlikleri yönetir ve değişiklikleri izler.  
  
## <a name="merge-options-and-identity-resolution"></a>Birleştirme seçenekleri ve kimlik çözümlemesi  
 Bir <xref:System.Data.Services.Client.DataServiceQuery%601> yürütüldüğünde, yanıt akışındaki varlıklar nesnelere uygulanır. Daha fazla bilgi için bkz. [nesne materialization](object-materialization-wcf-data-services.md). Yanıt iletisindeki girdilerin nesnelere nasıl gerçekleştirildiği, kimlik çözümlemesine göre yapılır ve sorgu yürütüldüğü birleştirme seçeneğine bağlıdır. Tek <xref:System.Data.Services.Client.DataServiceContext>bir kapsamda birden çok sorgu veya yükleme isteği yürütüldüğünde [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] , istemci yalnızca belirli bir anahtar değeri olan bir nesnenin tek bir örneğini izler. Kimlik çözümlemesi yapmak için kullanılan bu anahtar, benzersiz olarak bir varlığı tanımlar.  
  
 Varsayılan olarak, istemci, <xref:System.Data.Services.Client.DataServiceContext>yanıt akışındaki bir girişi yalnızca tarafından izlenmekte olan varlıklar için bir nesneye çıkarır. Bu, önbellekte bulunan nesnelerdeki değişikliklerin üzerine yazılmayacağı anlamına gelir. Bu davranış sorgular ve yükleme işlemleri için <xref:System.Data.Services.Client.MergeOption> bir değer belirtilerek denetlenir. Bu seçenek, <xref:System.Data.Services.Client.DataServiceContext.MergeOption%2A> <xref:System.Data.Services.Client.DataServiceContext>üzerinde özelliği ayarlanarak belirtilir. Varsayılan birleştirme seçeneği değeri <xref:System.Data.Services.Client.MergeOption.AppendOnly>. Bu, yalnızca izlenmekte olmayan varlıklar için nesneleri çıkarır, bu da mevcut nesnelerin üzerine yazılmayacağı anlamına gelir. İstemci üzerindeki nesnelerdeki değişikliklerin, veri hizmetindeki güncelleştirmeler tarafından üzerine yazılmasını önlemenin bir başka yolu da belirtmektir <xref:System.Data.Services.Client.MergeOption.PreserveChanges>. Belirttiğinizde <xref:System.Data.Services.Client.MergeOption.OverwriteChanges>, istemci üzerindeki nesne değerleri, bu nesnelerde değişiklik yapılmış olsa bile yanıt akışındaki girişlerden en son değerlerle değiştirilir. Birleştirme seçeneği kullanıldığında <xref:System.Data.Services.Client.DataServiceContext> , istemci nesnelerinde yapılan değişiklikleri veri hizmetine gönderemez. <xref:System.Data.Services.Client.MergeOption.NoTracking> Bu seçenekle, değişikliklerin her zaman veri hizmetindeki değerlerle üzerine yazılır.  
  
## <a name="managing-concurrency"></a>Eşzamanlılık yönetimi  
 [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)], veri hizmetinin güncelleştirme çakışmalarını algılamasını sağlayan iyimser eşzamanlılığı destekler. Veri hizmeti sağlayıcısı, veri hizmetinin bir eşzamanlılık belirteci kullanarak varlıklara yapılan değişiklikleri denetlemesi için bu şekilde yapılandırılabilir. Bu belirteç, bir kaynağın değişip değişmediğini anlamak üzere veri hizmeti tarafından doğrulanan bir varlık türünün bir veya daha fazla özelliğini içerir. İsteklerin ETag üstbilgisine ve veri hizmetinden gelen yanıtlara dahil edilen eşzamanlılık belirteçleri, sizin için [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] istemci tarafından yönetilir. Daha fazla bilgi için bkz. [veri hizmetini güncelleştirme](updating-the-data-service-wcf-data-services.md).  
  
 ,,<xref:System.Data.Services.Client.DataServiceContext.AddObject%2A>, Veya <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> kullanılarak<xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A>elile bildirilen nesnelerde yapılan değişiklikleri <xref:System.Data.Services.Client.DataServiceContext>izler. <xref:System.Data.Services.Client.DataServiceCollection%601> <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> Yöntemi çağrıldığında, istemci değişiklikleri veri hizmetine geri gönderir. <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A>istemcideki veri değişiklikleri veri hizmetindeki değişikliklerle çakışıyorsa başarısız olabilir. Bu gerçekleştiğinde, güncelleştirme verilerini almak için varlık kaynağını yeniden sorgumalısınız. Veri hizmetindeki değişikliklerin üzerine yazmak için, <xref:System.Data.Services.Client.MergeOption.PreserveChanges> birleştirme seçeneğini kullanarak sorguyu yürütün. Yeniden çağırdığınızda <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> , istemci üzerinde korunan değişiklikler, veri hizmetindeki kaynakta daha fazla değişiklik yapılmadığından, veri hizmetine kalıcı hale getirilir.  
  
## <a name="saving-changes"></a>Değişiklikler kaydediliyor  
 Değişiklikler <xref:System.Data.Services.Client.DataServiceContext> örnekte izlenir, ancak anında sunucuya gönderilmez. Belirtilen bir etkinlik için gerekli değişikliklerle işiniz bittiğinde, tüm değişiklikleri veri hizmetine göndermek <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> için çağırın. İşlem<xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> tamamlandıktan sonra bir <xref:System.Data.Services.Client.DataServiceResponse> nesne döndürülür. Nesnesi, kalıcı veya denenen değişiklikleri <xref:System.Data.Services.Client.OperationResponse> temsil eden bir dizi <xref:System.Data.Services.Client.EntityDescriptor> veya <xref:System.Data.Services.Client.LinkDescriptor> örnek içeren bir nesne dizisi içerir. <xref:System.Data.Services.Client.DataServiceResponse> Veri hizmetinde <xref:System.Data.Services.Client.EntityDescriptor> bir varlık oluşturulduğunda veya değiştirildiğinde, önceki örnekteki oluşturulan `ProductID` değer gibi sunucu tarafından oluşturulan özellik değerleri de dahil olmak üzere, güncelleştirilmiş varlığa yönelik bir başvuru içerir. İstemci kitaplığı, .NET Framework nesnesini bu yeni değerlere sahip olacak şekilde otomatik olarak güncelleştirir.  
  
 Başarılı ekleme ve güncelleştirme işlemleri için, işlemle <xref:System.Data.Services.Client.EntityDescriptor> ilişkili veya <xref:System.Data.Services.Client.LinkDescriptor> nesnesinin State özelliği olarak <xref:System.Data.Services.Client.EntityStates.Unchanged> ayarlanır ve yeni değerler kullanılarak <xref:System.Data.Services.Client.MergeOption.OverwriteChanges>birleştirilir. Veri hizmetinde bir INSERT, Update veya delete işlemi başarısız olduğunda, <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> varlık durumu çağrıldıktan önceki <xref:System.Data.Services.Client.OperationResponse.Error%2A> ile aynı kalır ve öğesinin <xref:System.Data.Services.Client.OperationResponse> özelliği, şu bilgilerle ilgili bilgiler içeren bir <xref:System.Data.Services.Client.DataServiceRequestException> öğesine ayarlanır. hatayla. Daha fazla bilgi için bkz. [veri hizmetini güncelleştirme](updating-the-data-service-wcf-data-services.md).  
  
### <a name="setting-the-http-method-for-updates"></a>Güncelleştirmeler için HTTP yöntemini ayarlama  
 Varsayılan olarak, .NET Framework istemci kitaplığı, güncelleştirmeleri varolan varlıklara BIRLEŞTIRME istekleri olarak gönderir. BIRLEŞTIRME isteği varlığın seçili özelliklerini güncelleştirir; ancak istemci her zaman BIRLEŞTIRME isteğindeki tüm özellikleri, hatta değişmemiş özellikleri içerir. Protokol [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] Ayrıca, varlıkları güncelleştirmek için PUT istekleri göndermeyi destekler. Bir PUT isteğinde, mevcut bir varlık temelde, istemcinin özellik değerleriyle birlikte varlığın yeni bir örneğiyle değiştirilmiştir. Put isteklerini kullanmak için, çağrılırken <xref:System.Data.Services.Client.SaveChangesOptions.ReplaceOnUpdate> <xref:System.Data.Services.Client.SaveChangesOptions> <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A>Numaralandırmadaki bayrağı ayarlayın.  
  
> [!NOTE]
> Bir PUT isteği, istemci varlığın tüm özellikleri hakkında bilgi sahibi olmadığında BIRLEŞTIRME isteğinden farklı davranabilecektir. Bu durum, bir varlık türünü istemcideki yeni bir türe yansıtılabilen ortaya çıkabilir. Ayrıca hizmet veri modelindeki varlığa yeni özellikler eklendiğinde ve <xref:System.Data.Services.Client.DataServiceContext.IgnoreMissingProperties%2A> <xref:System.Data.Services.Client.DataServiceContext> üzerindeki özelliği bu tür istemci eşleme hatalarını yoksayacak şekilde ayarlandığında `true` da gerçekleşebilir. Bu durumlarda, bir PUT isteği, istemci için bilinmeyen tüm özellikleri varsayılan değerlerine sıfırlayacaktır.  
  
### <a name="post-tunneling"></a>Tünel SONRASı  
 Varsayılan olarak, istemci kitaplığı Post, Get, put/Merge/Patch ve delete için karşılık [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] gelen http yöntemlerini kullanarak bir hizmete oluşturma, okuma, güncelleştirme ve silme istekleri gönderir. Bu, temsili durum aktarımının (REST) temel ilkelerini barındırır. Ancak, her Web sunucusu uygulamasında HTTP yöntemlerinin tam kümesini desteklememektedir. Bazı durumlarda, desteklenen yöntemler yalnızca GET ve POST ile sınırlandırılmış olabilir. Bu, bir güvenlik duvarı gibi bir aracı belirli yöntemlerle istekleri engellediğinde meydana gelebilir. Get ve post yöntemleri en sık desteklendiğinden, [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] bir post isteği kullanarak desteklenmeyen http yöntemlerini yürütmek için bir yol kullanın. *Yöntem tünel oluşturma* veya *gönderi tüneli*olarak bilinen bu, istemcinin özel `X-HTTP-Method` üstbilgide belirtilen gerçek yöntemle bir post isteği göndermesini sağlar. İstekler için gönderi tünelini etkinleştirmek üzere <xref:System.Data.Services.Client.DataServiceContext.UsePostTunneling%2A> <xref:System.Data.Services.Client.DataServiceContext> örnekteki özelliğini olarak `true`ayarlayın.  
  
## <a name="see-also"></a>Ayrıca bkz.

- [WCF Veri Hizmetleri İstemci Kitaplığı](wcf-data-services-client-library.md)
- [Veri Hizmetini Güncelleştirme](updating-the-data-service-wcf-data-services.md)
- [Zaman Uyumsuz İşlemler](asynchronous-operations-wcf-data-services.md)
- [Toplu İşlemler](batching-operations-wcf-data-services.md)
