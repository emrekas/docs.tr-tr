---
title: 'Nasıl yapılır: Sorunlu Yazdırma İşini Tanımlama'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- troubleshooting print job problems [WPF]
- print jobs [WPF], troubleshooting
- print jobs [WPF], diagnosing problems
ms.assetid: b081a170-84c6-48f9-a487-5766a8d58a82
ms.openlocfilehash: fc38d239720b5d5a8e159f91749b03512568cd9b
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/23/2019
ms.locfileid: "61776265"
---
# <a name="how-to-diagnose-problematic-print-job"></a><span data-ttu-id="321ff-102">Nasıl yapılır: Sorunlu Yazdırma İşini Tanımlama</span><span class="sxs-lookup"><span data-stu-id="321ff-102">How to: Diagnose Problematic Print Job</span></span>
<span data-ttu-id="321ff-103">Ağ yöneticileri genellikle şikayetlerinin değil veya yavaş yazdırma, yazdırma işlerini ilgili olarak kullanıcılardan alan.</span><span class="sxs-lookup"><span data-stu-id="321ff-103">Network administrators often field complaints from users about print jobs that do not print or print slowly.</span></span> <span data-ttu-id="321ff-104">Zengin, kullanıma sunulan yazdırma işi Özellikler [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] hızlı bir uzaktan tanılama yazdırma işi gerçekleştirmek için Microsoft .NET Framework'ü bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="321ff-104">The rich set of print job properties exposed in the [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] of Microsoft .NET Framework provide a means for performing a rapid remote diagnosis of print jobs.</span></span>  
  
## <a name="example"></a><span data-ttu-id="321ff-105">Örnek</span><span class="sxs-lookup"><span data-stu-id="321ff-105">Example</span></span>  
 <span data-ttu-id="321ff-106">Bu tür bir yardımcı programı oluşturmak için önemli adımlar aşağıdaki gibidir.</span><span class="sxs-lookup"><span data-stu-id="321ff-106">The major steps for creating this kind of utility are as follows.</span></span>  
  
1. <span data-ttu-id="321ff-107">Kullanıcı hakkında şikayetçi yazdırma işi tanımlayın.</span><span class="sxs-lookup"><span data-stu-id="321ff-107">Identify the print job that the user is complaining about.</span></span> <span data-ttu-id="321ff-108">Kullanıcılar genellikle tam olarak bunu yapamaz.</span><span class="sxs-lookup"><span data-stu-id="321ff-108">Users often cannot do this precisely.</span></span> <span data-ttu-id="321ff-109">Yazıcı ve yazdırma sunucularının adlarını bilemeyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="321ff-109">They may not know the names of the print servers or printers.</span></span> <span data-ttu-id="321ff-110">Ayarında kullanılandan farklı bir terminoloji yazıcıya konumunu açıklayabilir kendi <xref:System.Printing.PrintQueue.Location%2A> özelliği.</span><span class="sxs-lookup"><span data-stu-id="321ff-110">They may describe the location of the printer in different terminology than was used in setting its <xref:System.Printing.PrintQueue.Location%2A> property.</span></span> <span data-ttu-id="321ff-111">Buna göre bu kullanıcının listesi şu anda oluşturmak iyi bir fikir gönderilen olur.</span><span class="sxs-lookup"><span data-stu-id="321ff-111">Accordingly, it is a good idea to generate a list of the user's currently submitted jobs.</span></span> <span data-ttu-id="321ff-112">Varsa birden fazla kullanıcı ve yazdırma sistemi yönetici arasındaki iletişimi sorunları ortaya çıktığında iş saptamak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="321ff-112">If there is more than one, then communication between the user and the print system administrator can be used to pinpoint the job that is having problems.</span></span> <span data-ttu-id="321ff-113">Alt adımlar aşağıdaki gibidir.</span><span class="sxs-lookup"><span data-stu-id="321ff-113">The substeps are as follows.</span></span>  
  
    1. <span data-ttu-id="321ff-114">Tüm yazdırma sunucularının bir listesini alın.</span><span class="sxs-lookup"><span data-stu-id="321ff-114">Obtain a list of all print servers.</span></span>  
  
    2. <span data-ttu-id="321ff-115">Kendi yazdırma sorgulamak için sunucular üzerinden döngü.</span><span class="sxs-lookup"><span data-stu-id="321ff-115">Loop through the servers to query their print queues.</span></span>  
  
    3. <span data-ttu-id="321ff-116">Sunucu döngüsünün her geçişinde işlerini sorgulamak için sunucunun tüm kuyruklar üzerinden döngü</span><span class="sxs-lookup"><span data-stu-id="321ff-116">Within each pass of the server loop, loop through all the server's queues to query their jobs</span></span>  
  
    4. <span data-ttu-id="321ff-117">Kuyruk döngünün her geçişinde döngü, işlerini ve şikayetçi kullanıcı tarafından gönderilen bu hakkında tanımlayıcı bilgileri toplayın.</span><span class="sxs-lookup"><span data-stu-id="321ff-117">Within each pass of the queue loop, loop through its jobs and gather identifying information about those that were submitted by the complaining user.</span></span>  
  
2. <span data-ttu-id="321ff-118">Sorunlu yazdırma işini tanımlandığı zaman hangi sorunu olabileceğini görmek için ilgili özelliklerini inceleyin.</span><span class="sxs-lookup"><span data-stu-id="321ff-118">When the problematic print job has been identified, examine relevant properties to see what might be the problem.</span></span> <span data-ttu-id="321ff-119">Örneğin, bir hata durumunda iş veya yazıcı sırası işi yazdırmadan önce çevrimdışı hizmet verme muydunuz?</span><span class="sxs-lookup"><span data-stu-id="321ff-119">For example, is job in an error state or did the printer servicing the queue go offline before the job could print?</span></span>  
  
 <span data-ttu-id="321ff-120">Aşağıdaki kod, kod örnekleri bir dizisidir.</span><span class="sxs-lookup"><span data-stu-id="321ff-120">The code below is series of code examples.</span></span> <span data-ttu-id="321ff-121">İlk örnek kod, yazdırma sıralarını döngü içerir.</span><span class="sxs-lookup"><span data-stu-id="321ff-121">The first code example contains the loop through the print queues.</span></span> <span data-ttu-id="321ff-122">(1 c yukarıdaki adım.) Değişken `myPrintQueues` olduğu <xref:System.Printing.PrintQueueCollection> geçerli yazdırma sunucusu için nesne.</span><span class="sxs-lookup"><span data-stu-id="321ff-122">(Step 1c above.) The variable `myPrintQueues` is the <xref:System.Printing.PrintQueueCollection> object for the current print server.</span></span>  
  
 <span data-ttu-id="321ff-123">Kod örneği geçerli bir yazdırma sırasını nesneyle yenileyerek başlar <xref:System.Printing.PrintQueue.Refresh%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="321ff-123">The code example begins by refreshing the current print queue object with <xref:System.Printing.PrintQueue.Refresh%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="321ff-124">Bu, nesnenin özelliklerini temsil ettiği fiziksel yazıcı durumunu doğru şekilde temsil sağlar.</span><span class="sxs-lookup"><span data-stu-id="321ff-124">This ensures that the object's properties accurately represent the state of the physical printer that it represents.</span></span> <span data-ttu-id="321ff-125">Uygulama yazdırma işlerini koleksiyonu şu anda yazdırma kuyruğunda kullanarak alır, ardından <xref:System.Printing.PrintQueue.GetPrintJobInfoCollection%2A>.</span><span class="sxs-lookup"><span data-stu-id="321ff-125">Then the application gets the collection of print jobs currently in the print queue by using <xref:System.Printing.PrintQueue.GetPrintJobInfoCollection%2A>.</span></span>  
  
 <span data-ttu-id="321ff-126">Uygulamayı sonraki döngü <xref:System.Printing.PrintSystemJobInfo> toplama ve karşılaştırır <xref:System.Printing.PrintSystemJobInfo.Submitter%2A> şikayetçi olan kullanıcı diğer adı ile özelliği.</span><span class="sxs-lookup"><span data-stu-id="321ff-126">Next the application loops through the <xref:System.Printing.PrintSystemJobInfo> collection and compares each <xref:System.Printing.PrintSystemJobInfo.Submitter%2A> property with the alias of the complaining user.</span></span> <span data-ttu-id="321ff-127">Eşleşiyorlarsa uygulama işi hakkında tanıtıcı bilgi sunulacak dizesine ekler.</span><span class="sxs-lookup"><span data-stu-id="321ff-127">If they match, the application adds identifying information about the job to the string that will be presented.</span></span> <span data-ttu-id="321ff-128">( `userName` Ve `jobList` değişkenleri, uygulamada daha önce başlatılır.)</span><span class="sxs-lookup"><span data-stu-id="321ff-128">(The `userName` and `jobList` variables are initialized earlier in the application.)</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#enumeratejobsinqueues)]
 [!code-csharp[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#enumeratejobsinqueues)]
 [!code-vb[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#enumeratejobsinqueues)]  
  
 <span data-ttu-id="321ff-129">2. adım uygulamayı sonraki kod örneğinde seçer.</span><span class="sxs-lookup"><span data-stu-id="321ff-129">The next code example picks up the application at Step 2.</span></span> <span data-ttu-id="321ff-130">(Yukarıya bakın.) Sorunlu iş belirlenmiştir ve uygulamayı tanımlayacak bilgileri ister.</span><span class="sxs-lookup"><span data-stu-id="321ff-130">(See above.) The problematic job has been identified and the application prompts for the information that will identify it.</span></span> <span data-ttu-id="321ff-131">Bu bilgiyi oluşturduğu <xref:System.Printing.PrintServer>, <xref:System.Printing.PrintQueue>, ve <xref:System.Printing.PrintSystemJobInfo> nesneleri.</span><span class="sxs-lookup"><span data-stu-id="321ff-131">From this information it creates <xref:System.Printing.PrintServer>, <xref:System.Printing.PrintQueue>, and <xref:System.Printing.PrintSystemJobInfo> objects.</span></span>  
  
 <span data-ttu-id="321ff-132">Bu noktada uygulama, karşılık gelen bir yazdırma işin durumunu denetleme için iki yol bir dallandırma yapısını içerir:</span><span class="sxs-lookup"><span data-stu-id="321ff-132">At this point the application contains a branching structure corresponding to the two ways of checking a print job's status:</span></span>  
  
- <span data-ttu-id="321ff-133">Bayraklarını edinebilirsiniz <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> tür özelliği <xref:System.Printing.PrintJobStatus>.</span><span class="sxs-lookup"><span data-stu-id="321ff-133">You can read the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property which is of type <xref:System.Printing.PrintJobStatus>.</span></span>  
  
- <span data-ttu-id="321ff-134">Her bir ilgili özellik gibi edinebilirsiniz <xref:System.Printing.PrintSystemJobInfo.IsBlocked%2A> ve <xref:System.Printing.PrintSystemJobInfo.IsInError%2A>.</span><span class="sxs-lookup"><span data-stu-id="321ff-134">You can read each relevant property such as <xref:System.Printing.PrintSystemJobInfo.IsBlocked%2A> and <xref:System.Printing.PrintSystemJobInfo.IsInError%2A>.</span></span>  
  
 <span data-ttu-id="321ff-135">Bu örnekte, her iki yöntem gösterir, böylece kullanıcı daha önce hangi metodu kullanmak için istenir ve bayraklarını kullanmak istiyordu, "Y" ile yanıt verdi <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> özelliği.</span><span class="sxs-lookup"><span data-stu-id="321ff-135">This example demonstrates both methods, so the user was previously prompted as to which method to use and responded with "Y" if he or she wanted to use the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property.</span></span> <span data-ttu-id="321ff-136">İki yöntemden biriyle ayrıntıları için aşağıya bakın.</span><span class="sxs-lookup"><span data-stu-id="321ff-136">See below for the details of the two methods.</span></span> <span data-ttu-id="321ff-137">Son olarak, uygulama adında bir yöntem kullanır **ReportQueueAndJobAvailability** iş günün bu saatinde yazdırılabilir olup olmadığını bildirmek için.</span><span class="sxs-lookup"><span data-stu-id="321ff-137">Finally, the application uses a method called **ReportQueueAndJobAvailability** to report on whether the job can be printed at this time of day.</span></span> <span data-ttu-id="321ff-138">Bu yöntem içinde ele alınmıştır [keşfedin olup olmadığını bir yazdırma işi yapabilirsiniz olması yazdırılan sırasında bu günün saati](how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day.md).</span><span class="sxs-lookup"><span data-stu-id="321ff-138">This method is discussed in [Discover Whether a Print Job Can Be Printed At This Time of Day](how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day.md).</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#identifyanddiagnoseproblematicjob)]
 [!code-csharp[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#identifyanddiagnoseproblematicjob)]
 [!code-vb[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#identifyanddiagnoseproblematicjob)]  
  
 <span data-ttu-id="321ff-139">Bayraklarını kullanarak yazdırma işinin durumunu denetlemek için <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> özelliği, ilgili her bayrağı ayarlanmış olup olmadığını görmek için denetleyin.</span><span class="sxs-lookup"><span data-stu-id="321ff-139">To check print job status using the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property, you check each relevant flag to see if it is set.</span></span> <span data-ttu-id="321ff-140">Bir bit bit bayrakları kümesi içinde ayarlanmış olup olmadığını görmek için standart bayrakları kümesini tek bir işlenen ve diğer bayrağını kendisini olarak bir mantıksal AND işlemini gerçekleştirmek için yoludur.</span><span class="sxs-lookup"><span data-stu-id="321ff-140">The standard way to see if one bit is set in a set of bit flags is to perform a logical AND operation with the set of flags as one operand and the flag itself as the other.</span></span> <span data-ttu-id="321ff-141">En fazla bayrağı ayarlayın, mantıksal sonucunu bir bit varsa ve bu yana aynı söz konusu bit ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="321ff-141">Since the flag itself has only one bit set, the result of the logical AND is that, at most, that same bit is set.</span></span> <span data-ttu-id="321ff-142">Bunu veya olduğunu bulmak için yalnızca sonuç mantıksal AND bayrağı ile karşılaştırın.</span><span class="sxs-lookup"><span data-stu-id="321ff-142">To find out whether it is or not, just compare the result of the logical AND with the flag itself.</span></span> <span data-ttu-id="321ff-143">Daha fazla bilgi için <xref:System.Printing.PrintJobStatus>, [& işleci (C# başvuru)](~/docs/csharp/language-reference/operators/and-operator.md), ve <xref:System.FlagsAttribute>.</span><span class="sxs-lookup"><span data-stu-id="321ff-143">For more information, see <xref:System.Printing.PrintJobStatus>, the [& Operator (C# Reference)](~/docs/csharp/language-reference/operators/and-operator.md), and <xref:System.FlagsAttribute>.</span></span>  
  
 <span data-ttu-id="321ff-144">Biti ayarlanmış, her bir öznitelik için kod, bu rapor, konsol ekranına ve bazen yanıt için bir yol önerir.</span><span class="sxs-lookup"><span data-stu-id="321ff-144">For each attribute whose bit is set, the code reports this to the console screen and sometimes suggests a way to respond.</span></span> <span data-ttu-id="321ff-145">( **HandlePausedJob** iş veya sıra duraklatılmışsa çağrılan yöntem aşağıda ele alınmıştır.)</span><span class="sxs-lookup"><span data-stu-id="321ff-145">(The **HandlePausedJob** method that is called if the job or queue is paused is discussed below.)</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobattributes)]
 [!code-csharp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobattributes)]
 [!code-vb[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobattributes)]  
  
 <span data-ttu-id="321ff-146">Ayrı özellikleri kullanarak yazdırma işinin durumunu denetlemek için yalnızca her bir özellik okuyun ve özellik ise `true`, rapor konsol ekranına ve büyük olasılıkla yanıt için bir yol önerin.</span><span class="sxs-lookup"><span data-stu-id="321ff-146">To check print job status using separate properties, you simply read each property and, if the property is `true`, report to the console screen and possibly suggest a way to respond.</span></span> <span data-ttu-id="321ff-147">( **HandlePausedJob** iş veya sıra duraklatılmışsa çağrılan yöntem aşağıda ele alınmıştır.)</span><span class="sxs-lookup"><span data-stu-id="321ff-147">(The **HandlePausedJob** method that is called if the job or queue is paused is discussed below.)</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobproperties)]
 [!code-csharp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobproperties)]
 [!code-vb[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobproperties)]  
  
 <span data-ttu-id="321ff-148">**HandlePausedJob** uzaktan duraklatılmış işler devam etmek uygulamanın kullanıcı yöntemi sağlar.</span><span class="sxs-lookup"><span data-stu-id="321ff-148">The **HandlePausedJob** method enables the application's user to remotely resume paused jobs.</span></span> <span data-ttu-id="321ff-149">Yazdırma sırasını neden duraklatıldı geçerli bir nedeniniz olabileceğinden yöntem bunu sürdürmek konusunda bir kullanıcı karar isteyerek başlar.</span><span class="sxs-lookup"><span data-stu-id="321ff-149">Because there might be a good reason why the print queue was paused, the method begins by prompting for a user decision about whether to resume it.</span></span> <span data-ttu-id="321ff-150">"Y" ise sonra <xref:System.Printing.PrintQueue.Resume%2A?displayProperty=nameWithType> yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="321ff-150">If the answer is "Y", then the <xref:System.Printing.PrintQueue.Resume%2A?displayProperty=nameWithType> method is called.</span></span>  
  
 <span data-ttu-id="321ff-151">Sonraki kullanıcı işi sürdürülemiyor varsa, bağımsız olarak yazdırma sırasını duraklatıldı durumunda karar vermeniz istenir.</span><span class="sxs-lookup"><span data-stu-id="321ff-151">Next the user is prompted to decide if the job itself should be resumed, just in case it is paused independently of the print queue.</span></span> <span data-ttu-id="321ff-152">(Karşılaştırma <xref:System.Printing.PrintQueue.IsPaused%2A?displayProperty=nameWithType> ve <xref:System.Printing.PrintSystemJobInfo.IsPaused%2A?displayProperty=nameWithType>.) Yanıt "Y", ardından ise <xref:System.Printing.PrintSystemJobInfo.Resume%2A?displayProperty=nameWithType> çağrılan; Aksi takdirde <xref:System.Printing.PrintSystemJobInfo.Cancel%2A> çağrılır.</span><span class="sxs-lookup"><span data-stu-id="321ff-152">(Compare <xref:System.Printing.PrintQueue.IsPaused%2A?displayProperty=nameWithType> and <xref:System.Printing.PrintSystemJobInfo.IsPaused%2A?displayProperty=nameWithType>.) If the answer is "Y", then <xref:System.Printing.PrintSystemJobInfo.Resume%2A?displayProperty=nameWithType> is called; otherwise <xref:System.Printing.PrintSystemJobInfo.Cancel%2A> is called.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#HandlePausedJob](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#handlepausedjob)]
 [!code-csharp[DiagnoseProblematicPrintJob#HandlePausedJob](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#handlepausedjob)]
 [!code-vb[DiagnoseProblematicPrintJob#HandlePausedJob](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#handlepausedjob)]  
  
## <a name="see-also"></a><span data-ttu-id="321ff-153">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="321ff-153">See also</span></span>

- <xref:System.Printing.PrintJobStatus>
- <xref:System.Printing.PrintSystemJobInfo>
- <xref:System.FlagsAttribute>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="321ff-154">& İşleci (C# Başvurusu)</span><span class="sxs-lookup"><span data-stu-id="321ff-154">& Operator (C# Reference)</span></span>](~/docs/csharp/language-reference/operators/and-operator.md)
- [<span data-ttu-id="321ff-155">WPF'deki Belgeler</span><span class="sxs-lookup"><span data-stu-id="321ff-155">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="321ff-156">Yazdırmaya Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="321ff-156">Printing Overview</span></span>](printing-overview.md)
