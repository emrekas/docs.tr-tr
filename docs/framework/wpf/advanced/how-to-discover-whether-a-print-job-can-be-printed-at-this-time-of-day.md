---
title: 'Nasıl yapılır: Günün Bu Saatinde Yazdırmanın Yapılıp Yapılmayacağını Keşfetme'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print queues [WPF], timing
- printers [WPF], availability
- print jobs [WPF], timing
ms.assetid: 7e9c8ec1-abf6-4b3d-b1c6-33b35d3c4063
ms.openlocfilehash: 859dc75169e443d07361951692a428507886fa2e
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 08/22/2019
ms.locfileid: "69947807"
---
# <a name="how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day"></a><span data-ttu-id="0c54b-102">Nasıl yapılır: Günün Bu Saatinde Yazdırmanın Yapılıp Yapılmayacağını Keşfetme</span><span class="sxs-lookup"><span data-stu-id="0c54b-102">How to: Discover Whether a Print Job Can Be Printed At This Time of Day</span></span>
<span data-ttu-id="0c54b-103">Yazdırma kuyrukları her zaman günde 24 saat boyunca kullanılabilir değildir.</span><span class="sxs-lookup"><span data-stu-id="0c54b-103">Print queues are not always available for 24 hours a day.</span></span> <span data-ttu-id="0c54b-104">Bunlar, günün belirli saatlerinde kullanılamaz hale getirmek için ayarlanabilecekleri başlangıç ve bitiş zamanı özelliklerine sahiptirler.</span><span class="sxs-lookup"><span data-stu-id="0c54b-104">They have start and end time properties that can be set to make them unavailable at certain times of day.</span></span> <span data-ttu-id="0c54b-105">Bu özellik, örneğin, 5 P.M. sonra belirli bir departmanın özel kullanımı için bir yazıcı ayırmak üzere kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="0c54b-105">This feature can be used, for example, to reserve a printer for the exclusive use of a certain department after 5 P.M..</span></span> <span data-ttu-id="0c54b-106">Bu bölümün, yazıcıya hizmet veren farklı bir kuyruğu vardır.</span><span class="sxs-lookup"><span data-stu-id="0c54b-106">That department would have a different queue servicing the printer than other departments use.</span></span> <span data-ttu-id="0c54b-107">Diğer Departmanlar için sıra 5 P.M. sonra kullanılamaz, ancak sık kırmızı bölüm kuyruğu her zaman kullanılabilir olacak şekilde ayarlanabilir.</span><span class="sxs-lookup"><span data-stu-id="0c54b-107">The queue for the other departments would be set to be unavailable after 5 P.M., while queue for the favored department could be set to be available at all times.</span></span>  
  
 <span data-ttu-id="0c54b-108">Üstelik, yazdırma işlerinin kendileri yalnızca belirtilen zaman aralığında yazdırılabilir olarak ayarlanabilir.</span><span class="sxs-lookup"><span data-stu-id="0c54b-108">Moreover, print jobs themselves can be set to be printable only within a specified span of time.</span></span>  
  
 <span data-ttu-id="0c54b-109">Microsoft .net <xref:System.Printing.PrintQueue> Framework <xref:System.Printing.PrintSystemJobInfo> API 'lerinde sunulan ve sınıfları, belirli bir yazdırma işinin geçerli zamanda belirli bir sıraya göre yazdırıp yazdıramayacağını uzaktan denetlemek için bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="0c54b-109">The <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> classes exposed in the APIs of Microsoft .NET Framework provide a means for remotely checking whether a given print job can print on a given queue at the current time.</span></span>  
  
## <a name="example"></a><span data-ttu-id="0c54b-110">Örnek</span><span class="sxs-lookup"><span data-stu-id="0c54b-110">Example</span></span>  
 <span data-ttu-id="0c54b-111">Aşağıdaki örnek, bir yazdırma işiyle ilgili sorunları tanılamak için bir örnektir.</span><span class="sxs-lookup"><span data-stu-id="0c54b-111">The example below is a sample that can diagnose problems with a print job.</span></span>  
  
 <span data-ttu-id="0c54b-112">Bu tür bir işlev için aşağıdaki gibi iki önemli adım vardır.</span><span class="sxs-lookup"><span data-stu-id="0c54b-112">There are two major steps for this kind of function as follows.</span></span>  
  
1. <span data-ttu-id="0c54b-113">Geçerli saatin aralarında <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> olup olmadığını öğrenmek <xref:System.Printing.PrintQueue> için öğesinin veözellikleriniokuyun.<xref:System.Printing.PrintQueue.StartTimeOfDay%2A></span><span class="sxs-lookup"><span data-stu-id="0c54b-113">Read the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintQueue> to determine whether the current time is between them.</span></span>  
  
2. <span data-ttu-id="0c54b-114">Geçerli saatin aralarında <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> olup olmadığını öğrenmek <xref:System.Printing.PrintSystemJobInfo> için öğesinin veözellikleriniokuyun.<xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A></span><span class="sxs-lookup"><span data-stu-id="0c54b-114">Read the <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> and <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintSystemJobInfo> to determine whether the current time is between them.</span></span>  
  
 <span data-ttu-id="0c54b-115">Ancak bu özelliklerin nesneler olmadığı <xref:System.DateTime> gerçeden karmaşıklıklar ortaya çıkar.</span><span class="sxs-lookup"><span data-stu-id="0c54b-115">But complications arise from the fact that these properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="0c54b-116">Bunun yerine, <xref:System.Int32> günün saatini gece yarısından beri geçen dakika sayısı olarak ifade eden nesnelerdir.</span><span class="sxs-lookup"><span data-stu-id="0c54b-116">Instead they are <xref:System.Int32> objects that express the time of day as the number of minutes since midnight.</span></span> <span data-ttu-id="0c54b-117">Üstelik, bu, geçerli saat diliminde gece yarısı, ancak gece yarısı UTC (Eşgüdümlü Evrensel Saat).</span><span class="sxs-lookup"><span data-stu-id="0c54b-117">Moreover, this is not midnight in the current time zone, but midnight UTC (Coordinated Universal Time).</span></span>  
  
 <span data-ttu-id="0c54b-118">İlk kod örneği, gönderilen <xref:System.Printing.PrintSystemJobInfo> **ReportQueueAndJobAvailability**statik yöntemini gösterir ve işin geçerli saatte yazdırıp yazdıramayacağını ve ne zaman yazdırılacağını ve ne zaman yazdıramayacağını belirleyen yardımcı yöntemleri çağırır.</span><span class="sxs-lookup"><span data-stu-id="0c54b-118">The first code example presents the static method **ReportQueueAndJobAvailability**, which is passed a <xref:System.Printing.PrintSystemJobInfo> and calls helper methods to determine whether the job can print at the current time and, if not, when it can print.</span></span> <span data-ttu-id="0c54b-119">Yöntemine bir <xref:System.Printing.PrintQueue> yönteminin geçirilmediğine dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="0c54b-119">Notice that a <xref:System.Printing.PrintQueue> is not passed to the method.</span></span> <span data-ttu-id="0c54b-120">Bunun nedeni, <xref:System.Printing.PrintSystemJobInfo> öğesinin <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> özelliğindeki sıraya bir başvuru içereceğinden oluşur.</span><span class="sxs-lookup"><span data-stu-id="0c54b-120">This is because the <xref:System.Printing.PrintSystemJobInfo> includes a reference to the queue in its <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> property.</span></span>  
  
 <span data-ttu-id="0c54b-121">Alt yöntemler, bir <xref:System.Printing.PrintQueue> veya bir <xref:System.Printing.PrintSystemJobInfo> parametresini parametre olarak ele geçirebilen aşırı yüklenmiş **ReportAvailabilityAtThisTime** yöntemini içerir.</span><span class="sxs-lookup"><span data-stu-id="0c54b-121">The subordinate methods include the overloaded **ReportAvailabilityAtThisTime** method which can take either a <xref:System.Printing.PrintQueue> or a <xref:System.Printing.PrintSystemJobInfo> as a parameter.</span></span> <span data-ttu-id="0c54b-122">Ayrıca bir **TimeConverter. ConvertToLocalHumanReadableTime**vardır.</span><span class="sxs-lookup"><span data-stu-id="0c54b-122">There is also a **TimeConverter.ConvertToLocalHumanReadableTime**.</span></span> <span data-ttu-id="0c54b-123">Bu yöntemlerin hepsi aşağıda ele alınmıştır.</span><span class="sxs-lookup"><span data-stu-id="0c54b-123">All of these methods are discussed below.</span></span>  
  
 <span data-ttu-id="0c54b-124">**ReportQueueAndJobAvailability** yöntemi, sıranın veya yazdırma işinin Şu anda kullanılabilir olup olmadığını kontrol ederek başlar.</span><span class="sxs-lookup"><span data-stu-id="0c54b-124">The **ReportQueueAndJobAvailability** method begins by checking to see if either the queue or the print job is unavailable at this time.</span></span> <span data-ttu-id="0c54b-125">Bunlardan biri kullanılamıyorsa, sıranın kullanılamıyor olup olmadığını kontrol eder.</span><span class="sxs-lookup"><span data-stu-id="0c54b-125">If either of them is unavailable, it then checks to see if the queue unavailable.</span></span> <span data-ttu-id="0c54b-126">Kullanılabilir değilse, yöntemi bu olguyu ve kuyruğun yeniden kullanılabilir olacağı saati raporlar.</span><span class="sxs-lookup"><span data-stu-id="0c54b-126">If it is not available, then the method reports this fact and the time when the queue will become available again.</span></span> <span data-ttu-id="0c54b-127">Ardından işi denetler ve kullanılabilir değilse, bir sonraki sefer, yazdırane zaman zaman dilimi bildirir.</span><span class="sxs-lookup"><span data-stu-id="0c54b-127">It then checks the job and if it is unavailable, it reports the next time span when it when it can print.</span></span> <span data-ttu-id="0c54b-128">Son olarak, yöntemi işin yazdırabileceği en erken zamanı bildirir.</span><span class="sxs-lookup"><span data-stu-id="0c54b-128">Finally, the method reports the earliest time when the job can print.</span></span> <span data-ttu-id="0c54b-129">Bu, aşağıdaki iki kez daha oluşur.</span><span class="sxs-lookup"><span data-stu-id="0c54b-129">This is the later of following two times.</span></span>  
  
- <span data-ttu-id="0c54b-130">Yazdırma sırasının bir sonraki kullanıma hazır olduğu zaman.</span><span class="sxs-lookup"><span data-stu-id="0c54b-130">The time when the print queue is next available.</span></span>  
  
- <span data-ttu-id="0c54b-131">Yazdırma işinin bir sonraki kullanıma hazır olduğu zaman.</span><span class="sxs-lookup"><span data-stu-id="0c54b-131">The time when the print job is next available.</span></span>  
  
 <span data-ttu-id="0c54b-132">Günün raporlanması sırasında <xref:System.DateTime.ToShortTimeString%2A> yöntem de çağrılır, çünkü bu yöntem çıktısından yıl, ay ve günü bastırır.</span><span class="sxs-lookup"><span data-stu-id="0c54b-132">When reporting times of day, the <xref:System.DateTime.ToShortTimeString%2A> method is also called because this method suppresses the years, months, and days from the output.</span></span> <span data-ttu-id="0c54b-133">Bir yazdırma sırasının veya bir yazdırma işinin kullanılabilirliğini belirli yıl, ay veya günlere göre kısıtlayamazsınız.</span><span class="sxs-lookup"><span data-stu-id="0c54b-133">You cannot restrict the availability of either a print queue or a print job to particular years, months, or days.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#reportqueueandjobavailability)]
 [!code-csharp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#reportqueueandjobavailability)]
 [!code-vb[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#reportqueueandjobavailability)]  
  
 <span data-ttu-id="0c54b-134">**ReportAvailabilityAtThisTime** yönteminin iki aşırı yüklemesi, geçirilen tür haricinde aynıdır, bu nedenle yalnızca <xref:System.Printing.PrintQueue> sürüm aşağıda sunulmuştur.</span><span class="sxs-lookup"><span data-stu-id="0c54b-134">The two overloads of the **ReportAvailabilityAtThisTime** method are identical except for the type passed to them, so only the <xref:System.Printing.PrintQueue> version is presented below.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0c54b-135">Metodun tür hariç özdeş olması, örneğin, örnek **\<ReportAvailabilityAtThisTime T >** genel bir yöntem oluşturmamasının sorusunu oluşturur.</span><span class="sxs-lookup"><span data-stu-id="0c54b-135">The fact that the methods are identical except for type raises the question of why the sample does not create a generic method **ReportAvailabilityAtThisTime\<T>**.</span></span> <span data-ttu-id="0c54b-136">Bunun nedeni, bu yöntemin, **StartTimeOfDay** ve yöntemin çağırdığı **UntilTimeOfDay** özelliklerine sahip bir sınıfla sınırlandırılmalıdır, ancak genel bir yöntem yalnızca tek bir sınıfla ve her ikisi için ortak olan tek sınıfla kısıtlanabilir Devralma ağacında Butür<xref:System.Printing.PrintSystemObject>özellikleriyoktur. <xref:System.Printing.PrintQueue> <xref:System.Printing.PrintSystemJobInfo></span><span class="sxs-lookup"><span data-stu-id="0c54b-136">The reason is that such a method would have to be restricted to a class that has the **StartTimeOfDay** and **UntilTimeOfDay** properties that the method calls, but a generic method can only be restricted to a single class and the only class common to both <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> in the inheritance tree is <xref:System.Printing.PrintSystemObject> which has no such properties.</span></span>  
  
 <span data-ttu-id="0c54b-137">**ReportAvailabilityAtThisTime** yöntemi (Aşağıdaki kod örneğinde sunulan), için <xref:System.Boolean> `true`bir Sentinel değişkeni başlatılarak başlar.</span><span class="sxs-lookup"><span data-stu-id="0c54b-137">The **ReportAvailabilityAtThisTime** method (presented in the code example below) begins by initializing a <xref:System.Boolean> sentinel variable to `true`.</span></span> <span data-ttu-id="0c54b-138">Sıra kullanılamıyorsa, olarak `false`sıfırlanır.</span><span class="sxs-lookup"><span data-stu-id="0c54b-138">It will be reset to `false`, if the queue is not available.</span></span>  
  
 <span data-ttu-id="0c54b-139">Sonra, yöntemi başlangıç ve "Until" zamanlarının aynı olup olmadığını denetler.</span><span class="sxs-lookup"><span data-stu-id="0c54b-139">Next, the method checks to see if the start and "until" times are identical.</span></span> <span data-ttu-id="0c54b-140">Varsa, kuyruk her zaman kullanılabilir olduğundan, yöntemi döndürür `true`.</span><span class="sxs-lookup"><span data-stu-id="0c54b-140">If they are, the queue is always available, so the method returns `true`.</span></span>  
  
 <span data-ttu-id="0c54b-141">Sıra her zaman kullanılabilir değilse, yöntemi geçerli saati bir <xref:System.DateTime.UtcNow%2A> <xref:System.DateTime> nesne olarak almak için static özelliğini kullanır.</span><span class="sxs-lookup"><span data-stu-id="0c54b-141">If the queue is not available all the time, the method uses the static <xref:System.DateTime.UtcNow%2A> property to get the current time as a <xref:System.DateTime> object.</span></span> <span data-ttu-id="0c54b-142">( <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> Ve<xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> özellikleri UTC saat içinde olduğundan yerel saate ihtiyacım yoktur.)</span><span class="sxs-lookup"><span data-stu-id="0c54b-142">(We do not need local time because the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties are themselves in UTC time.)</span></span>  
  
 <span data-ttu-id="0c54b-143">Ancak, bu iki özellik nesne değildir <xref:System.DateTime> .</span><span class="sxs-lookup"><span data-stu-id="0c54b-143">However, these two properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="0c54b-144"><xref:System.Int32>Bu, saati saat-UTC-gece yarısı olarak ifade ederler.</span><span class="sxs-lookup"><span data-stu-id="0c54b-144">They are <xref:System.Int32>s expressing the time as the number of minutes-after-UTC-midnight.</span></span> <span data-ttu-id="0c54b-145">Bu nedenle nesnemizi <xref:System.DateTime> dakika sonra gece yarısından dönüştürmemiz gerekir.</span><span class="sxs-lookup"><span data-stu-id="0c54b-145">So we do have to convert our <xref:System.DateTime> object to minutes-after-midnight.</span></span> <span data-ttu-id="0c54b-146">Bu işlem tamamlandığında, yöntemi "Şimdi" kuyruğun başlangıç ve "Until" zamanları arasında olup olmadığını denetler, "Şimdi" iki kez değilse Sentinel değerini false olarak ayarlar ve Sentinel değerini döndürür.</span><span class="sxs-lookup"><span data-stu-id="0c54b-146">When that is done, the method simply checks to see whether "now" is between the queue's start and "until" times, sets the sentinel to false if "now" is not between the two times, and returns the sentinel.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#printqueuestartuntil)]
 [!code-csharp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#printqueuestartuntil)]
 [!code-vb[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#printqueuestartuntil)]  
  
 <span data-ttu-id="0c54b-147">**TimeConverter. ConvertToLocalHumanReadableTime** yöntemi (Aşağıdaki kod örneğinde sunulan) Microsoft .NET Framework ile tanıtılan herhangi bir yöntemi kullanmaz. bu nedenle, tartışma kısa olur.</span><span class="sxs-lookup"><span data-stu-id="0c54b-147">The **TimeConverter.ConvertToLocalHumanReadableTime** method (presented in the code example below) does not use any methods introduced with Microsoft .NET Framework, so the discussion is brief.</span></span> <span data-ttu-id="0c54b-148">Yöntemin bir çift dönüştürme görevi vardır: dakika sonra gece yarısından sonra bir tamsayı almalıdır ve bunu insanla okunabilir bir zamana dönüştürür ve bunu yerel saate dönüştürmelidir.</span><span class="sxs-lookup"><span data-stu-id="0c54b-148">The method has a double conversion task: it must take an integer expressing minutes-after-midnight and convert it to a human-readable time and it must convert this to the local time.</span></span> <span data-ttu-id="0c54b-149">Önce gece yarısı UTC olarak ayarlanmış bir <xref:System.DateTime> nesne oluşturarak bunu gerçekleştirir ve ardından yöntemine geçirilen dakikaları eklemek için <xref:System.DateTime.AddMinutes%2A> yöntemini kullanır.</span><span class="sxs-lookup"><span data-stu-id="0c54b-149">It accomplishes this by first creating a <xref:System.DateTime> object that is set to midnight UTC and then it uses the <xref:System.DateTime.AddMinutes%2A> method to add the minutes that were passed to the method.</span></span> <span data-ttu-id="0c54b-150">Bu, yönteme geçirilen <xref:System.DateTime> özgün saati ifade eden yeni bir ifade döndürür.</span><span class="sxs-lookup"><span data-stu-id="0c54b-150">This returns a new <xref:System.DateTime> expressing the original time that was passed to the method.</span></span> <span data-ttu-id="0c54b-151"><xref:System.DateTime.ToLocalTime%2A> Yöntemi daha sonra bunu yerel saate dönüştürür.</span><span class="sxs-lookup"><span data-stu-id="0c54b-151">The <xref:System.DateTime.ToLocalTime%2A> method then converts this to local time.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#timeconverter)]
 [!code-csharp[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#timeconverter)]
 [!code-vb[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#timeconverter)]  
  
## <a name="see-also"></a><span data-ttu-id="0c54b-152">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="0c54b-152">See also</span></span>

- <xref:System.DateTime>
- <xref:System.Printing.PrintSystemJobInfo>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="0c54b-153">WPF'deki Belgeler</span><span class="sxs-lookup"><span data-stu-id="0c54b-153">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="0c54b-154">Yazdırmaya Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="0c54b-154">Printing Overview</span></span>](printing-overview.md)
