---
title: WPF Eklentilerine Genel Bakış
ms.date: 03/30/2017
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
ms.openlocfilehash: 48981a942461570c0ef822dba9b18cb9a41f59f8
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 01/23/2019
ms.locfileid: "54662744"
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="4875b-102">WPF Eklentilerine Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="4875b-102">WPF Add-Ins Overview</span></span>
<a name="Introduction"></a> <span data-ttu-id="4875b-103">.NET Framework, geliştiricilerin eklentiyi genişletilebilirlik destekleyen uygulamalar oluşturmak için kullanabileceğiniz bir eklenti modeli içerir.</span><span class="sxs-lookup"><span data-stu-id="4875b-103">The .NET Framework includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="4875b-104">Bu eklenti modeli ile tümleştirin ve uygulama işlevselliğini genişleten eklentileri oluşturulmasına izin verir.</span><span class="sxs-lookup"><span data-stu-id="4875b-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="4875b-105">Bazı senaryolarda uygulamalar eklenti tarafından sağlanan kullanıcı arabirimlerini görüntülemek de gerekir. Bu konuda, WPF bu senaryolar, mimarisi, aboneliğin avantajları ve kısıtlamalarını arkasında etkinleştirmek için .NET Framework eklenti modeli nasıl artırmaktadır gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="4875b-105">In some scenarios, applications also need to display user interfaces that are provided by add-ins. This topic shows how WPF augments the .NET Framework add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>  
  

  
<a name="Requirements"></a>   
## <a name="prerequisites"></a><span data-ttu-id="4875b-106">Önkoşullar</span><span class="sxs-lookup"><span data-stu-id="4875b-106">Prerequisites</span></span>  
 <span data-ttu-id="4875b-107">.NET Framework eklenti modeli konusunda gereklidir.</span><span class="sxs-lookup"><span data-stu-id="4875b-107">Familiarity with the .NET Framework add-in model is required.</span></span> <span data-ttu-id="4875b-108">Daha fazla bilgi için [eklentiler ve genişletilebilirlik](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span><span class="sxs-lookup"><span data-stu-id="4875b-108">For more information, see [Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span></span>  
  
<a name="AddInsOverview"></a>   
## <a name="add-ins-overview"></a><span data-ttu-id="4875b-109">Eklentilere genel bakış</span><span class="sxs-lookup"><span data-stu-id="4875b-109">Add-Ins Overview</span></span>  
 <span data-ttu-id="4875b-110">Karmaşıklığını uygulama yeniden derleme ve yeni işlevsellikler eklemek için yeniden dağıtım kaçınmak için geliştiricilerin (hem birinci taraf hem de üçüncü taraf) genişletilebilirlik mekanizması uygulamaları uygular, diğer uygulamalar oluşturma onlarla tümleştirin.</span><span class="sxs-lookup"><span data-stu-id="4875b-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="4875b-111">Add-INS kullanımı ("eklentiler" ve "eklentiler" olarak da bilinir) bu tür bir genişletilebilirlik desteklemek için en yaygın yoludur.</span><span class="sxs-lookup"><span data-stu-id="4875b-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="4875b-112">Genişletilebilirlik eklentiler ile kullanıma gerçek uygulamaları örnekleri şunlardır:</span><span class="sxs-lookup"><span data-stu-id="4875b-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>  
  
-   <span data-ttu-id="4875b-113">Internet Explorer eklentiler.</span><span class="sxs-lookup"><span data-stu-id="4875b-113">Internet Explorer add-ons.</span></span>  
  
-   <span data-ttu-id="4875b-114">Windows Media Player eklentiler.</span><span class="sxs-lookup"><span data-stu-id="4875b-114">Windows Media Player plug-ins.</span></span>  
  
-   <span data-ttu-id="4875b-115">Visual Studio eklentileri.</span><span class="sxs-lookup"><span data-stu-id="4875b-115">Visual Studio add-ins.</span></span>  
  
 <span data-ttu-id="4875b-116">Örneğin, "kod çözücüleri ve Windows tarafından yerel olarak desteklenmeyen medya biçimleri Kodlayıcıları oluşturma dahil olmak üzere çeşitli Windows Media Player'ı genişleten eklentiler" uygulamak üçüncü taraf geliştiriciler Windows Media Player eklenti modeli sağlar Media Player (örneğin, DVD, MP3), ses efekti ve dış.</span><span class="sxs-lookup"><span data-stu-id="4875b-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="4875b-117">Her eklenti modeli, varlıklar ve eklenti tüm modelleri için ortak olan davranışları olsa bir uygulama için benzersiz olan işlevselliği göstermek için oluşturulmuştur.</span><span class="sxs-lookup"><span data-stu-id="4875b-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>  
  
 <span data-ttu-id="4875b-118">Üç ana varlıklardır tipik eklenti genişletilebilirliği çözümlerinin *sözleşmeleri*, *eklentileri*, ve *ana bilgisayar uygulamalarını*.</span><span class="sxs-lookup"><span data-stu-id="4875b-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="4875b-119">Sözleşmeler, eklentiler iki yolla konak uygulamalarıyla tümleştirmek tanımlar:</span><span class="sxs-lookup"><span data-stu-id="4875b-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>  
  
-   <span data-ttu-id="4875b-120">Eklentiler, konak uygulamalar tarafından uygulanan işlevleri ile tümleştirin.</span><span class="sxs-lookup"><span data-stu-id="4875b-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>  
  
-   <span data-ttu-id="4875b-121">Ana bilgisayar uygulamaları tümleştirmek eklentiler için işlevselliği kullanıma sunar.</span><span class="sxs-lookup"><span data-stu-id="4875b-121">Host applications expose functionality for add-ins to integrate with.</span></span>  
  
 <span data-ttu-id="4875b-122">Kullanılacak eklentiler için konak uygulamalar bulup bunları çalışma zamanında yük gerekir.</span><span class="sxs-lookup"><span data-stu-id="4875b-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="4875b-123">Sonuç olarak, eklentiler destekleyen uygulamalar, aşağıdaki ek sorumluluklara sahiptir:</span><span class="sxs-lookup"><span data-stu-id="4875b-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>  
  
-   <span data-ttu-id="4875b-124">**Bulma**: Konak uygulamalar tarafından desteklenen sözleşmeleri izliyor eklentiler bulma.</span><span class="sxs-lookup"><span data-stu-id="4875b-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>  
  
-   <span data-ttu-id="4875b-125">**Etkinleştirme**: Yükleniyor, çalıştırma ve eklentiler ile iletişim kurma.</span><span class="sxs-lookup"><span data-stu-id="4875b-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>  
  
-   <span data-ttu-id="4875b-126">**Yalıtım**: Uygulama olası güvenlik ve eklentileri yürütme sorunlarını korumak, yalıtım sınırlarını kurmak için uygulama etki alanları veya işlemleri kullanarak.</span><span class="sxs-lookup"><span data-stu-id="4875b-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>  
  
-   <span data-ttu-id="4875b-127">**İletişim**: Eklentileri izin vererek ve birbirleriyle yöntemlerini çağırmaya ve veri geçirme yalıtım sınırlarının arasında iletişim için uygulamaları barındırın.</span><span class="sxs-lookup"><span data-stu-id="4875b-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>  
  
-   <span data-ttu-id="4875b-128">**Ömür Yönetimi**: Yükleme ve temiz, tahmin edilebilir bir biçimde uygulama etki alanları ve işlemleri kaldırma (bkz [uygulama etki alanları](../../../../docs/framework/app-domains/application-domains.md)).</span><span class="sxs-lookup"><span data-stu-id="4875b-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../../../docs/framework/app-domains/application-domains.md)).</span></span>  
  
-   <span data-ttu-id="4875b-129">**Sürüm oluşturma**: Ya da yeni sürümlerini oluşturulduğunda konak uygulamalar ve eklentiler hala iletişim kurabildiğinden emin olma.</span><span class="sxs-lookup"><span data-stu-id="4875b-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>  
  
 <span data-ttu-id="4875b-130">Sonuç olarak, sağlam bir eklenti modeli geliştirme Önemsiz olmayan bir iş değil.</span><span class="sxs-lookup"><span data-stu-id="4875b-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="4875b-131">Bu nedenle, .NET Framework eklenti modeli oluşturmaya yönelik bir altyapı sağlar.</span><span class="sxs-lookup"><span data-stu-id="4875b-131">For this reason, the .NET Framework provides an infrastructure for building add-in models.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="4875b-132">Eklentiler hakkında daha ayrıntılı bilgi için bkz: [eklentiler ve genişletilebilirlik](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span><span class="sxs-lookup"><span data-stu-id="4875b-132">For more detailed information on add-ins, see [Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span></span>  
  
<a name="NETFrameworkAddInModelOverview"></a>   
## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="4875b-133">.NET framework eklenti modeli genel bakış</span><span class="sxs-lookup"><span data-stu-id="4875b-133">.NET Framework Add-In Model Overview</span></span>  
 <span data-ttu-id="4875b-134">.NET Framework eklenti modeli bulunan <xref:System.AddIn> ad alanı, eklenti genişletilebilirliği geliştirilmesini basitleştirmek için tasarlanmış türleri kümesi içerir.</span><span class="sxs-lookup"><span data-stu-id="4875b-134">The .NET Framework add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="4875b-135">.NET Framework eklenti modeli temel birimidir *sözleşme*eklenti birbiriyle ve ana bilgisayar uygulamasına nasıl tanımlar.</span><span class="sxs-lookup"><span data-stu-id="4875b-135">The fundamental unit of the .NET Framework add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="4875b-136">Bir anlaşma kullanarak bir konak uygulamaya özgü bir ana bilgisayar uygulamasına sunulur *görünümü* sözleşme.</span><span class="sxs-lookup"><span data-stu-id="4875b-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="4875b-137">Benzer şekilde, bir ekleme-özel *görünümü* sözleşme eklenti için sunulur.</span><span class="sxs-lookup"><span data-stu-id="4875b-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="4875b-138">Bir *bağdaştırıcısı* bir konak uygulama ve bir eklenti ilgili kendi ilgili görünümler arasında iletişim kurmasına izin vermek için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="4875b-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="4875b-139">Sözleşmeler, görünümler ve bağdaştırıcılar adlandırılır segmentler ve ilgili kesimleri kümesi oluşturan bir *işlem hattı*.</span><span class="sxs-lookup"><span data-stu-id="4875b-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="4875b-140">İşlem hatları, bulma, etkinleştirme, güvenlik yalıtımı, yürütme yalıtım (uygulama etki alanları ve işlemleri kullanarak), iletişim, ömür yönetimi ve sürüm oluşturma .NET Framework eklenti modeli destekler temelidir.</span><span class="sxs-lookup"><span data-stu-id="4875b-140">Pipelines are the foundation upon which the .NET Framework add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>  
  
 <span data-ttu-id="4875b-141">Bu destek toplamını konak uygulamanın işlevselliğini tümleştirmek eklentileri geliştiricilerin sağlar.</span><span class="sxs-lookup"><span data-stu-id="4875b-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="4875b-142">Ancak, bazı senaryolar eklentiler tarafından sağlanan kullanıcı arabirimlerini görüntülemek için konak uygulamalar gerektirir. .NET Framework içindeki her bir sunu teknolojiyi kullanıcı arabirimlerini uygulamak için kendi modeli olduğundan, .NET Framework eklenti modeli herhangi belirli sunu teknolojisi desteklemez.</span><span class="sxs-lookup"><span data-stu-id="4875b-142">However, some scenarios require host applications to display user interfaces provided by add-ins. Because each presentation technology in the .NET Framework has its own model for implementing user interfaces, the .NET Framework add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="4875b-143">Bunun yerine, WPF, .NET Framework eklenti modeli eklentiler için kullanıcı Arabirimi desteği genişletir.</span><span class="sxs-lookup"><span data-stu-id="4875b-143">Instead, WPF extends the .NET Framework add-in model with UI support for add-ins.</span></span>  
  
<a name="WPFAddInModel"></a>   
## <a name="wpf-add-ins"></a><span data-ttu-id="4875b-144">WPF eklentileri</span><span class="sxs-lookup"><span data-stu-id="4875b-144">WPF Add-Ins</span></span>  
 <span data-ttu-id="4875b-145">WPF, .NET Framework eklenti modeli ile birlikte, çok çeşitli eklentiler kullanıcı arabirimlerini görüntülemek için uygulamaları barındırmak gerektiren senaryolar adresi sağlar. Özellikle, bu senaryolar aşağıdaki iki programlama modeli ile WPF tarafından ele alınır:</span><span class="sxs-lookup"><span data-stu-id="4875b-145">WPF, in conjunction with the .NET Framework add-in model, allows you to address a wide variety of scenarios that require host applications to display user interfaces from add-ins. In particular, these scenarios are addressed by WPF with the following two programming models:</span></span>  
  
1.  <span data-ttu-id="4875b-146">**Eklenti UI döndüren**.</span><span class="sxs-lookup"><span data-stu-id="4875b-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="4875b-147">Bir eklentiyi bir kullanıcı Arabirimi ana bilgisayar uygulamasına bir yöntem çağrısının anlaşma tarafından tanımlandığı şekilde döndürür.</span><span class="sxs-lookup"><span data-stu-id="4875b-147">An add-in returns a UI to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="4875b-148">Bu senaryo, aşağıdaki durumlarda kullanılır:</span><span class="sxs-lookup"><span data-stu-id="4875b-148">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="4875b-149">Bir kullanıcı Arabirimi eklentisi tarafından döndürülen görünümünün ya da verilere bağımlı olduğundan veya yalnızca çalışma zamanında dinamik olarak gibi mevcut koşulları oluşturulan raporlar.</span><span class="sxs-lookup"><span data-stu-id="4875b-149">The appearance of a UI that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>  
  
    -   <span data-ttu-id="4875b-150">Kullanıcı Arabirimi eklentisi tarafından sağlanan hizmetleri için eklentiyi kullanan konak uygulamalar Arabiriminden farklıdır.</span><span class="sxs-lookup"><span data-stu-id="4875b-150">The UI for services provided by an add-in differs from the UI of the host applications that can use the add-in.</span></span>  
  
    -   <span data-ttu-id="4875b-151">Eklentiyi öncelikle ana uygulama için bir hizmet gerçekleştirir ve bir kullanıcı Arabirimi ile ana bilgisayar uygulaması durumu bildirir.</span><span class="sxs-lookup"><span data-stu-id="4875b-151">The add-in primarily performs a service for the host application, and reports status to the host application with a UI.</span></span>  
  
2.  <span data-ttu-id="4875b-152">**Eklenti UI olan**.</span><span class="sxs-lookup"><span data-stu-id="4875b-152">**The add-in is a UI**.</span></span> <span data-ttu-id="4875b-153">Bir eklenti, sözleşmesi tarafından tanımlandığı şekilde UI'dir.</span><span class="sxs-lookup"><span data-stu-id="4875b-153">An add-in is a UI, as defined by the contract.</span></span> <span data-ttu-id="4875b-154">Bu senaryo, aşağıdaki durumlarda kullanılır:</span><span class="sxs-lookup"><span data-stu-id="4875b-154">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="4875b-155">Bir eklenti gibi bir reklam görüntülenen dışındaki hizmetleri sağlamaz.</span><span class="sxs-lookup"><span data-stu-id="4875b-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>  
  
    -   <span data-ttu-id="4875b-156">Hesaplayıcı veya Renk Seçici gibi eklenti kullanan tüm konak uygulamalar için kullanıcı Arabirimi eklentisi tarafından sağlanan hizmetleri için yaygındır.</span><span class="sxs-lookup"><span data-stu-id="4875b-156">The UI for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>  
  
 <span data-ttu-id="4875b-157">Bu senaryolar, eklenti uygulama etki alanları ve ana bilgisayar uygulaması arasında UI nesneleri geçirilebilir gerektirir.</span><span class="sxs-lookup"><span data-stu-id="4875b-157">These scenarios require that UI objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="4875b-158">Eklenti modeli uygulama etki alanları arasında iletişim kurmak için uzaktan iletişim kullanır olan .NET Framework beri bunlar arasında geçirilen nesneleri, Uzaktan erişilebilir olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="4875b-158">Since the .NET Framework add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>  
  
 <span data-ttu-id="4875b-159">Uzaktan erişilebilir bir veya daha fazlasını yapan bir sınıf örneği nesnedir:</span><span class="sxs-lookup"><span data-stu-id="4875b-159">A remotable object is an instance of a class that does one or more of the following:</span></span>  
  
-   <span data-ttu-id="4875b-160">Öğesinden türetilen <xref:System.MarshalByRefObject> sınıfı.</span><span class="sxs-lookup"><span data-stu-id="4875b-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>  
  
-   <span data-ttu-id="4875b-161">Implements <xref:System.Runtime.Serialization.ISerializable> arabirimi.</span><span class="sxs-lookup"><span data-stu-id="4875b-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>  
  
-   <span data-ttu-id="4875b-162">Sahip <xref:System.SerializableAttribute> özniteliği uygulandı.</span><span class="sxs-lookup"><span data-stu-id="4875b-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="4875b-163">Uzaktan erişilebilir .NET Framework nesneleri oluşturma hakkında daha fazla bilgi için bkz. [nesneleri Uzaktan erişilebilir hale getirme](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span><span class="sxs-lookup"><span data-stu-id="4875b-163">For more information regarding the creation of remotable .NET Framework objects, see [Making Objects Remotable](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span></span>  
  
 <span data-ttu-id="4875b-164">WPF UI türleri Uzaktan erişilebilir değildir.</span><span class="sxs-lookup"><span data-stu-id="4875b-164">The WPF UI types are not remotable.</span></span> <span data-ttu-id="4875b-165">Sorunu çözmek için ana uygulamalardan görüntülenecek WPF UI eklentileri tarafından oluşturulan etkinleştirmek için .NET Framework eklenti modeli WPF genişletir.</span><span class="sxs-lookup"><span data-stu-id="4875b-165">To solve the problem, WPF extends the .NET Framework add-in model to enable WPF UI created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="4875b-166">Bu destek, iki tür tarafından WPF sağladığı: <xref:System.AddIn.Contract.INativeHandleContract> arabirimi ve iki statik yöntemler tarafından uygulanan <xref:System.AddIn.Pipeline.FrameworkElementAdapters> sınıfı: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> ve <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="4875b-166">This support is provided by WPF by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="4875b-167">Yüksek düzeyde, bu türleri ve yöntemleri şu şekilde kullanılır:</span><span class="sxs-lookup"><span data-stu-id="4875b-167">At a high level, these types and methods are used in the following manner:</span></span>  
  
1.  <span data-ttu-id="4875b-168">WPF gerektiren eklentiler tarafından sağlanan kullanıcı arabirimleri doğrudan veya dolaylı olarak türetilen sınıflar olduklarını <xref:System.Windows.FrameworkElement>şekiller, denetimleri, kullanıcı denetimleri, Düzen bölmeleri ve sayfaları gibi.</span><span class="sxs-lookup"><span data-stu-id="4875b-168">WPF requires that user interfaces provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>  
  
2.  <span data-ttu-id="4875b-169">Sözleşme, eklenti ve barındırma uygulaması UI'dir geçirilecek bildirir her yerde, onu olarak bildirilmelidir bir <xref:System.AddIn.Contract.INativeHandleContract> (değil bir <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> yalıtım sınırlarında geçirilebilir eklenti UI Uzaktan erişilebilir gösterimidir.</span><span class="sxs-lookup"><span data-stu-id="4875b-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in UI that can be passed across isolation boundaries.</span></span>  
  
3.  <span data-ttu-id="4875b-170">Eklentinin uygulama etki alanından geçirilmeden önce bir <xref:System.Windows.FrameworkElement> olarak paketlenmiş bir <xref:System.AddIn.Contract.INativeHandleContract> çağırarak <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="4875b-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
4.  <span data-ttu-id="4875b-171">Konak uygulamanın uygulama etki alanı için geçirilen sonra <xref:System.AddIn.Contract.INativeHandleContract> olarak paketlenmiş gereken bir <xref:System.Windows.FrameworkElement> çağırarak <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="4875b-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>  
  
 <span data-ttu-id="4875b-172">Nasıl <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, ve <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> kullanılan belirli bir senaryoya bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="4875b-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="4875b-173">Aşağıdaki bölümlerde, her bir programlama modeli için ayrıntıları sağlayın.</span><span class="sxs-lookup"><span data-stu-id="4875b-173">The following sections provide details for each programming model.</span></span>  
  
<a name="ReturnUIFromAddInContract"></a>   
## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="4875b-174">Eklenti kullanıcı arayüzü döndürür.</span><span class="sxs-lookup"><span data-stu-id="4875b-174">Add-In Returns a User Interface</span></span>  
 <span data-ttu-id="4875b-175">Bir kullanıcı Arabirimi bir ana bilgisayar uygulamasına döndürülecek eklenti için aşağıdakiler gereklidir:</span><span class="sxs-lookup"><span data-stu-id="4875b-175">For an add-in to return a UI to a host application, the following are required:</span></span>  
  
1.  <span data-ttu-id="4875b-176">Ana bilgisayar uygulaması, eklenti ve işlem hattı, .NET Framework tarafından açıklandığı oluşturulmalıdır [eklentiler ve genişletilebilirlik](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) belgeleri.</span><span class="sxs-lookup"><span data-stu-id="4875b-176">The host application, add-in, and pipeline must be created, as described by the .NET Framework [Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) documentation.</span></span>  
  
2.  <span data-ttu-id="4875b-177">Sözleşme uygulamalıdır <xref:System.AddIn.Contract.IContract> ve bir kullanıcı Arabirimi döndürülecek sözleşme türü dönüş değerine sahip bir yöntemi bildirmeniz gerekir <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="4875b-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a UI, the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="4875b-178">Eklenti ile ana bilgisayar uygulaması arasında geçirilen kullanıcı Arabirimi öğesinden türetilmelidir doğrudan veya dolaylı olarak <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="4875b-178">The UI that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="4875b-179">Kullanıcı Arabirimi eklentisi tarafından döndürülen dönüştürülmüş olmalıdır bir <xref:System.Windows.FrameworkElement> için bir <xref:System.AddIn.Contract.INativeHandleContract> yalıtım sınırı geçmeden önce.</span><span class="sxs-lookup"><span data-stu-id="4875b-179">The UI that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="4875b-180">Öğesinden döndürülen UI dönüştürülmelidir bir <xref:System.AddIn.Contract.INativeHandleContract> için bir <xref:System.Windows.FrameworkElement> yalıtım sınırı geçmesinden sonra.</span><span class="sxs-lookup"><span data-stu-id="4875b-180">The UI that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="4875b-181">Konak uygulama döndürülen görüntüler <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="4875b-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="4875b-182">UI döndüren eklenti uygulama yapmayı gösteren bir örnek için bkz: [bir eklenti döndüren bir kullanıcı Arabirimi oluşturma](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="4875b-182">For an example that demonstrates how to implement an add-in that returns a UI, see [Create an Add-In That Returns a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span></span>  
  
<a name="AddInIsAUI"></a>   
## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="4875b-183">Bir kullanıcı arabirimi eklentisi olan</span><span class="sxs-lookup"><span data-stu-id="4875b-183">Add-In Is a User Interface</span></span>  
 <span data-ttu-id="4875b-184">Bir eklenti UI olduğunda, aşağıdakiler gereklidir:</span><span class="sxs-lookup"><span data-stu-id="4875b-184">When an add-in is a UI, the following are required:</span></span>  
  
1.  <span data-ttu-id="4875b-185">Ana bilgisayar uygulaması, eklenti ve işlem hattı, .NET Framework tarafından açıklandığı oluşturulmalıdır [eklentiler ve genişletilebilirlik](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) belgeleri.</span><span class="sxs-lookup"><span data-stu-id="4875b-185">The host application, add-in, and pipeline must be created, as described by the .NET Framework [Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) documentation.</span></span>  
  
2.  <span data-ttu-id="4875b-186">Eklenti anlaşma arabirimi uygulamalıdır <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="4875b-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="4875b-187">Ana uygulamaya geçirilen eklentiyi doğrudan veya dolaylı olarak öğesinden türetilmelidir <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="4875b-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="4875b-188">Eklenti gelen dönüştürülmelidir bir <xref:System.Windows.FrameworkElement> için bir <xref:System.AddIn.Contract.INativeHandleContract> yalıtım sınırı geçmeden önce.</span><span class="sxs-lookup"><span data-stu-id="4875b-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="4875b-189">Eklenti gelen dönüştürülmelidir bir <xref:System.AddIn.Contract.INativeHandleContract> için bir <xref:System.Windows.FrameworkElement> yalıtım sınırı geçmesinden sonra.</span><span class="sxs-lookup"><span data-stu-id="4875b-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="4875b-190">Konak uygulama döndürülen görüntüler <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="4875b-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="4875b-191">UI olan eklenti uygulama yapmayı gösteren bir örnek için bkz: [bir eklenti olan bir kullanıcı Arabirimi oluşturma](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="4875b-191">For an example that demonstrates how to implement an add-in that is a UI, see [Create an Add-In That Is a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span></span>  
  
<a name="ReturningMultipleUIsFromAnAddIn"></a>   
## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="4875b-192">Eklenti birden çok UI döndüren</span><span class="sxs-lookup"><span data-stu-id="4875b-192">Returning Multiple UIs from an Add-In</span></span>  
 <span data-ttu-id="4875b-193">Eklentiler, genellikle görüntülemek uygulamaları barındırmak için birden çok kullanıcı arabirimi sağlar.</span><span class="sxs-lookup"><span data-stu-id="4875b-193">Add-ins often provide multiple user interfaces for host applications to display.</span></span> <span data-ttu-id="4875b-194">Ayrıca konak uygulama durum bilgilerini de bir kullanıcı Arabirimi olarak sağlayan UI olan eklenti gibi göz önünde bulundurun.</span><span class="sxs-lookup"><span data-stu-id="4875b-194">For example, consider an add-in that is a UI that also provides status information to the host application, also as a UI.</span></span> <span data-ttu-id="4875b-195">Böyle bir eklenti hem tekniklerinin bir bileşimini kullanarak uygulanabilir [bir kullanıcı arayüzü döndürür eklenti](#ReturnUIFromAddInContract) ve [eklenti kullanıcı arayüzü](#AddInIsAUI) modelleri.</span><span class="sxs-lookup"><span data-stu-id="4875b-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>  
  
<a name="AddInsAndXBAPs"></a>   
## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="4875b-196">Eklentiler ve XAML tarayıcı uygulamaları</span><span class="sxs-lookup"><span data-stu-id="4875b-196">Add-Ins and XAML Browser Applications</span></span>  
 <span data-ttu-id="4875b-197">Örneklerde, şu ana kadar yüklü tek başına uygulama konak uygulama olmuştur.</span><span class="sxs-lookup"><span data-stu-id="4875b-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="4875b-198">Ancak [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] eklentileri, aşağıdaki ek derleme ve uygulama gereksinimleri paralelleştirmeye da barındırabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="4875b-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>  
  
-   <span data-ttu-id="4875b-199">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Uygulama bildirimi, işlem hattını (klasörleri ve derlemeleri) ve eklenti derlemesi için özel olarak indirmek için yapılandırılmalıdır [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] aynı klasörde bir istemci makine üzerinde uygulama önbelleğine [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4875b-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>  
  
-   <span data-ttu-id="4875b-200">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Keşfedip eklentileri yükleyecek kod kullanmalıdır [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] uygulama önbelleği için [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] eklentisi ardışık düzen ve konum olarak.</span><span class="sxs-lookup"><span data-stu-id="4875b-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>  
  
-   <span data-ttu-id="4875b-201">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Eklenti tarafından barındırıldığında; kaynak sitede bulunan gevşek dosyalar başvuruyorsa bir özel güvenlik bağlamına eklenti gerekir [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-INS konak uygulamanın sitede bulunan gevşek dosyalar yalnızca başvurabilir kaynağı.</span><span class="sxs-lookup"><span data-stu-id="4875b-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>  
  
 <span data-ttu-id="4875b-202">Bu görevleri, aşağıdaki alt bölümlerde ayrıntılı olarak açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="4875b-202">These tasks are described in detail in the following subsections.</span></span>  
  
### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="4875b-203">İşlem hattı ve ClickOnce dağıtımı için eklentiyi yapılandırma</span><span class="sxs-lookup"><span data-stu-id="4875b-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>  
 [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] <span data-ttu-id="4875b-204">için indirilir ve güvenli bir klasörde çalıştırılan [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] dağıtım önbellek.</span><span class="sxs-lookup"><span data-stu-id="4875b-204">are downloaded to and run from a safe folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment cache.</span></span> <span data-ttu-id="4875b-205">Sırayla bir [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] eklenti barındırmak için işlem hattı ve eklenti bütünleştirilmiş kod da güvenli klasöre yüklenmelidir.</span><span class="sxs-lookup"><span data-stu-id="4875b-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="4875b-206">Bunu başarmak için uygulama bildirimini işlem hattı ve eklenti derlemesini içerecek şekilde yapılandırmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="4875b-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="4875b-207">Bu en bir kolayca yapılabilir [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], işlem hattı ve eklenti derlemesi konak olması gerekiyor ancak [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] projesinin kök klasörüne sırayla [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] ardışık düzen derlemeleri algılamak için.</span><span class="sxs-lookup"><span data-stu-id="4875b-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>  
  
 <span data-ttu-id="4875b-208">Sonuç olarak, Eklenti derlemesine ve işlem hattı oluşturmak için ilk adım olan [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] yapı çıkışını her işlem hattı ayarlayarak derleme projeleri derleme ve Eklenti projesinin kök.</span><span class="sxs-lookup"><span data-stu-id="4875b-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="4875b-209">Aşağıdaki tabloda çözüm ve kök klasörde konağı olarak işlem hattı derleme projeleri ve derleme eklenti projesi yapı çıkış yolları gösterilmektedir [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] proje.</span><span class="sxs-lookup"><span data-stu-id="4875b-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>  
  
 <span data-ttu-id="4875b-210">Tablo 1: Çıkış yolu bir XBAP tarafından barındırılan işlem hattı derlemeler için derleme</span><span class="sxs-lookup"><span data-stu-id="4875b-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>  
  
|<span data-ttu-id="4875b-211">İşlem hattı derleme projesi</span><span class="sxs-lookup"><span data-stu-id="4875b-211">Pipeline assembly project</span></span>|<span data-ttu-id="4875b-212">Yapı çıkış yolu</span><span class="sxs-lookup"><span data-stu-id="4875b-212">Build output path</span></span>|  
|-------------------------------|-----------------------|  
|<span data-ttu-id="4875b-213">Daralma</span><span class="sxs-lookup"><span data-stu-id="4875b-213">Contract</span></span>|`..\HostXBAP\Contracts\`|  
|<span data-ttu-id="4875b-214">Eklenti görünümü</span><span class="sxs-lookup"><span data-stu-id="4875b-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|  
|<span data-ttu-id="4875b-215">Ekleme tarafı bağdaştırıcısı</span><span class="sxs-lookup"><span data-stu-id="4875b-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|  
|<span data-ttu-id="4875b-216">Konak tarafı bağdaştırıcısı</span><span class="sxs-lookup"><span data-stu-id="4875b-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|  
|<span data-ttu-id="4875b-217">Eklentisi</span><span class="sxs-lookup"><span data-stu-id="4875b-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|  
  
 <span data-ttu-id="4875b-218">Eklenti derleme olarak ve işlem hattı derlemeleri belirtmek için sonraki adımdır [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] içerik dosyaları [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] aşağıdakileri yaparak:</span><span class="sxs-lookup"><span data-stu-id="4875b-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="4875b-219">Her işlem hattı klasör Çözüm Gezgini'nde sağ tıklayıp seçerek işlem hattı ve eklenti bütünleştirilmiş kod projesinde dahil **projeye dahil et**.</span><span class="sxs-lookup"><span data-stu-id="4875b-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>  
  
2.  <span data-ttu-id="4875b-220">Ayarı **derleme eylemi** her işlem hattı derleme ve Eklenti derlemesine **içerik** gelen **özellikleri** penceresi.</span><span class="sxs-lookup"><span data-stu-id="4875b-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>  
  
 <span data-ttu-id="4875b-221">Son adım, işlem hattı derleme dosyaları ve derleme eklenti dosyası indirme için eklenecek uygulama bildirimi yapılandırmaktır.</span><span class="sxs-lookup"><span data-stu-id="4875b-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="4875b-222">Klasörün kökünde klasörlerdeki dosyaları yerleştirilmelidir [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] önbelleğindeki [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] uygulama kaplar.</span><span class="sxs-lookup"><span data-stu-id="4875b-222">The files should be located in folders at the root of the folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="4875b-223">Yapılandırma sağlanabilir [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] aşağıdakileri yaparak:</span><span class="sxs-lookup"><span data-stu-id="4875b-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="4875b-224">Sağ tıklayın [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] proje, tıklayın **özellikleri**, tıklayın **Yayımla**ve ardından **uygulama dosyaları** düğmesi.</span><span class="sxs-lookup"><span data-stu-id="4875b-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>  
  
2.  <span data-ttu-id="4875b-225">İçinde **uygulama dosyaları** iletişim kutusunda, kümesi **yayımlama durumu** her işlem hattı ve DLL eklentisini **Ekle (otomatik)** ve **indirmegrubu** her işlem hattı ve DLL eklentisini **(gerekli)**.</span><span class="sxs-lookup"><span data-stu-id="4875b-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>  
  
### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="4875b-226">İşlem hattı ve kullanarak uygulama tabanından</span><span class="sxs-lookup"><span data-stu-id="4875b-226">Using the Pipeline and Add-In from the Application Base</span></span>  
 <span data-ttu-id="4875b-227">Ne zaman işlem hattı ve için yapılandırıldığında [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] dağıtım, aynı yüklenen [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] Önbellek klasörü olarak [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4875b-227">When the pipeline and add-in are configured for [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment, they are downloaded to the same [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="4875b-228">İşlem hattını kullanma ve gelen eklentisi için [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] kodu gerekir alma bunları uygulamadan temel.</span><span class="sxs-lookup"><span data-stu-id="4875b-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="4875b-229">Çeşitli türleri ve üyeleri için işlem hatları ve eklentiler kullanarak .NET Framework eklenti modeli, bu senaryo için özel desteği sağlar.</span><span class="sxs-lookup"><span data-stu-id="4875b-229">The various types and members of the .NET Framework add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="4875b-230">İlk olarak, yol ile tanımlanan <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> numaralandırma değeri.</span><span class="sxs-lookup"><span data-stu-id="4875b-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="4875b-231">Aşağıdakileri içeren işlem hattı kullanmak için uygun eklenti üyeleri aşırı yüklemeleri ile bu değeri kullanın:</span><span class="sxs-lookup"><span data-stu-id="4875b-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="4875b-232">Ana bilgisayarın Site kaynak erişimi</span><span class="sxs-lookup"><span data-stu-id="4875b-232">Accessing the Host's Site of Origin</span></span>  
 <span data-ttu-id="4875b-233">Eklenti dosyaları kaynak siteden başvurabileceğini emin olmak için eklentinin ana bilgisayar uygulamasına eşdeğerdir ve güvenlik yalıtımı ile yüklenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="4875b-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="4875b-234">Bu güvenlik düzeyi tarafından tanımlanan <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> numaralandırma değeri geçirilir <xref:System.AddIn.Hosting.AddInToken.Activate%2A> eklenti etkinleştirildiğinde yöntemi.</span><span class="sxs-lookup"><span data-stu-id="4875b-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>  
  
<a name="WPFAddInModelArchitecture"></a>   
## <a name="wpf-add-in-architecture"></a><span data-ttu-id="4875b-235">WPF eklentisi mimarisi</span><span class="sxs-lookup"><span data-stu-id="4875b-235">WPF Add-In Architecture</span></span>  
 <span data-ttu-id="4875b-236">Anlatıldığı gibi en üst düzeyde, WPF .NET Framework kullanıcı arabirimlerini eklentiler sağlar. (Bu türetilen doğrudan veya dolaylı olarak <xref:System.Windows.FrameworkElement>) kullanarak <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ve <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="4875b-236">At the highest level, as we've seen, WPF enables .NET Framework add-ins to implement user interfaces (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="4875b-237">Ana bilgisayar uygulaması döndürülür sonucu olan bir <xref:System.Windows.FrameworkElement> görüntülenen kullanıcı Arabiriminden ana uygulamada.</span><span class="sxs-lookup"><span data-stu-id="4875b-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from UI in the host application.</span></span>  
  
 <span data-ttu-id="4875b-238">Basit kullanıcı Arabirimi eklentisi senaryolar için bir geliştiricinin ihtiyaç duyduğu kadar ayrıntı budur.</span><span class="sxs-lookup"><span data-stu-id="4875b-238">For simple UI add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="4875b-239">Daha karmaşık senaryolarda, düzen, kaynakları ve veri bağlama gibi ek WPF hizmetlerini kullanan denemek için WPF UI desteği ile .NET Framework eklenti modeli nasıl genişlettiğini, daha ayrıntılı bilgiye faydalarını anlamak için gereklidir ve sınırlamaları.</span><span class="sxs-lookup"><span data-stu-id="4875b-239">For more complex scenarios, particularly those that try to utilize additional WPF services such as layout, resources, and data binding, more detailed knowledge of how WPF extends the .NET Framework add-in model with UI support is required to understand its benefits and limitations.</span></span>  
  
 <span data-ttu-id="4875b-240">Temelde, WPF bir ana bilgisayar uygulaması için bir eklentiyi bir UI geçirmez; Bunun yerine, WPF WPF birlikte çalışabilirliği kullanılarak Win32 pencere tanıtıcısı kullanıcı Arabiriminde geçirir.</span><span class="sxs-lookup"><span data-stu-id="4875b-240">Fundamentally, WPF doesn't pass a UI from an add-in to a host application; instead, WPF passes the Win32 window handle for the UI by using WPF interoperability.</span></span> <span data-ttu-id="4875b-241">Bir kullanıcı Arabiriminden bir eklenti için bir ana bilgisayar uygulaması geçirildiğinde, bu nedenle, aşağıdakiler gerçekleşir:</span><span class="sxs-lookup"><span data-stu-id="4875b-241">As such, when a UI from an add-in is passed to a host application, the following occurs:</span></span>  
  
-   <span data-ttu-id="4875b-242">Eklenti tarafında WPF konak uygulama tarafından görüntülenen kullanıcı Arabirimi için bir pencere tutucu devralır.</span><span class="sxs-lookup"><span data-stu-id="4875b-242">On the add-in side, WPF acquires a window handle for the UI that will be displayed by the host application.</span></span> <span data-ttu-id="4875b-243">Türetilen bir iç WPF sınıf pencere tanıtıcısı yalıtılan <xref:System.Windows.Interop.HwndSource> ve uygulayan <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="4875b-243">The window handle is encapsulated by an internal WPF class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="4875b-244">Bu sınıfın bir örneği tarafından döndürülen <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ve eklentinin uygulama etki alanından konak uygulamanın uygulama etki alanına taşınır.</span><span class="sxs-lookup"><span data-stu-id="4875b-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>  
  
-   <span data-ttu-id="4875b-245">Konak uygulama tarafında WPF tüketen <xref:System.Windows.Interop.HwndSource> türetildiği bir iç WPF sınıf olarak <xref:System.Windows.Interop.HwndHost> ve <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="4875b-245">On the host application side, WPF repackages the <xref:System.Windows.Interop.HwndSource> as an internal WPF class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="4875b-246">Bu sınıfın bir örneği tarafından döndürülen <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> konak uygulama.</span><span class="sxs-lookup"><span data-stu-id="4875b-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>  
  
 <span data-ttu-id="4875b-247"><xref:System.Windows.Interop.HwndHost> pencere tanıtıcısı, WPF kullanıcı arabirimleri ile tanımlanan kullanıcı arabirimlerini görüntülemek için var.</span><span class="sxs-lookup"><span data-stu-id="4875b-247"><xref:System.Windows.Interop.HwndHost> exists to display user interfaces, identified by window handles, from WPF user interfaces.</span></span> <span data-ttu-id="4875b-248">Daha fazla bilgi için [WPF ve Win32 birlikte çalışması](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span><span class="sxs-lookup"><span data-stu-id="4875b-248">For more information, see [WPF and Win32 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span></span>  
  
 <span data-ttu-id="4875b-249">Özet olarak, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, ve <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> bir eklentiyi bir ana bilgisayar uygulamasına Burada, saklanmış olduğu tarafından geçirilecek bir WPF UI için Pencere işleyicisi izin vermek için mevcut bir <xref:System.Windows.Interop.HwndHost> ve konak uygulamanın kullanıcı Arabiriminde görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="4875b-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a WPF UI to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's UI.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="4875b-250">Ana bilgisayar uygulaması aldığından bir <xref:System.Windows.Interop.HwndHost>, ana bilgisayar uygulaması tarafından döndürülen nesne dönüştürülemiyor <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> eklenti tarafından uygulanan türüne (örneğin, bir <xref:System.Windows.Controls.UserControl>).</span><span class="sxs-lookup"><span data-stu-id="4875b-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>  
  
 <span data-ttu-id="4875b-251">Doğası, <xref:System.Windows.Interop.HwndHost> uygulamalarını barındırmak bunları nasıl kullanabileceğiniz etkileyen belirli sınırlamaları vardır.</span><span class="sxs-lookup"><span data-stu-id="4875b-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="4875b-252">Ancak WPF genişletir <xref:System.Windows.Interop.HwndHost> eklenti senaryoları için çeşitli özelliklere sahip.</span><span class="sxs-lookup"><span data-stu-id="4875b-252">However, WPF extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="4875b-253">Bu avantajlar ve sınırlamalar aşağıda açıklanmıştır.</span><span class="sxs-lookup"><span data-stu-id="4875b-253">These benefits and limitations are described below.</span></span>  
  
<a name="WPFAddInModelBenefits"></a>   
## <a name="wpf-add-in-benefits"></a><span data-ttu-id="4875b-254">WPF eklentisi avantajları</span><span class="sxs-lookup"><span data-stu-id="4875b-254">WPF Add-In Benefits</span></span>  
 <span data-ttu-id="4875b-255">WPF eklentisi kullanıcı arabirimleri, türetilen bir iç sınıf kullanarak ana uygulamadan görüntülendiğinden <xref:System.Windows.Interop.HwndHost>, bu kullanıcı arabirimleri yeteneklerini tarafından kısıtlanmıştır <xref:System.Windows.Interop.HwndHost> düzeni gibi bir WPF UI Hizmetleri göre işleme, veri bağlama, stiller, şablonlar ve kaynaklar.</span><span class="sxs-lookup"><span data-stu-id="4875b-255">Because WPF add-in user interfaces are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those user interfaces are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to WPF UI services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="4875b-256">Ancak WPF iç artırmaktadır <xref:System.Windows.Interop.HwndHost> aşağıdakiler dahil ek özellikler olan alt sınıf:</span><span class="sxs-lookup"><span data-stu-id="4875b-256">However, WPF augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>  
  
-   <span data-ttu-id="4875b-257">Konak uygulamanın kullanıcı Arabirimi ile bir eklentinin kullanıcı Arabirimi arasında sekmeyle gitmeyi.</span><span class="sxs-lookup"><span data-stu-id="4875b-257">Tabbing between a host application's UI and an add-in's UI.</span></span> <span data-ttu-id="4875b-258">"Eklenti UI'dir." bir programlama modeli için geçersiz kılmak Ekle tarafı bağdaştırıcısı gerektiğini unutmayın <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> sekmeyi, eklentinin tam güvenilir veya kısmen güvenilen etkinleştirmek için.</span><span class="sxs-lookup"><span data-stu-id="4875b-258">Note that the "add-in is a UI" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>  
  
-   <span data-ttu-id="4875b-259">Konak uygulama kullanıcı arabirimlerinden görüntülenen bir eklenti kullanıcı arabirimleri için erişilebilirlik gereksinimleri uygularken.</span><span class="sxs-lookup"><span data-stu-id="4875b-259">Honoring accessibility requirements for add-in user interfaces that are displayed from host application user interfaces.</span></span>  
  
-   <span data-ttu-id="4875b-260">WPF uygulamaları birden çok uygulama etki alanı senaryolarında güvenli bir şekilde çalıştırmak etkinleştiriliyor.</span><span class="sxs-lookup"><span data-stu-id="4875b-260">Enabling WPF applications to run safely in multiple application domain scenarios.</span></span>  
  
-   <span data-ttu-id="4875b-261">Eklentileri (diğer bir deyişle, kısmi güven güvenliği sandbox) güvenlik yalıtımı ile çalıştırdığınızda kullanıcı Arabirimi eklentisi için geçersiz erişimi önleme penceresi işler.</span><span class="sxs-lookup"><span data-stu-id="4875b-261">Preventing illegal access to add-in UI window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="4875b-262">Çağırma <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> bu güvenlik sağlar:</span><span class="sxs-lookup"><span data-stu-id="4875b-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>  
  
    -   <span data-ttu-id="4875b-263">"Eklenti UI döndüren" programlama modeli için Pencere işleyicisi eklenti UI için yalıtım sınırı arasında geçirmek için tek yolu çağırmaktır <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="4875b-263">For the "add-in returns a UI" programming model, the only way to pass the window handle for an add-in UI across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
    -   <span data-ttu-id="4875b-264">"Eklenti UI olan" programlama modeli için geçersiz kılma <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> arama ve ekleme tarafı bağdaştırıcısı <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (önceki örneklerde gösterildiği gibi), ekleme tarafı bağdaştırıcının çağırma gibi gereklidir `QueryContract` uygulamasından konak tarafı bağdaştırıcısı.</span><span class="sxs-lookup"><span data-stu-id="4875b-264">For the "add-in is a UI" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>  
  
-   <span data-ttu-id="4875b-265">Birden çok uygulama etki alanı yürütme korumasını sağlama.</span><span class="sxs-lookup"><span data-stu-id="4875b-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="4875b-266">Yalıtım sınırı yer alsa bile uygulama etki alanlarıyla sınırlamaları nedeniyle, eklenti uygulama etki alanında oluşturulan işlenmeyen özel durumları uygulamanın tamamı çökmesine neden.</span><span class="sxs-lookup"><span data-stu-id="4875b-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="4875b-267">Ancak, WPF ve .NET Framework eklenti modeli, bu sorunu gidermek ve uygulama kararlılığını artırmak için basit bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="4875b-267">However, WPF and the .NET Framework add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="4875b-268">Bir kullanıcı Arabirimi görüntüler WPF eklentisi oluşturur bir <xref:System.Windows.Threading.Dispatcher> konak uygulama WPF uygulaması ise, uygulama etki alanı üzerinde çalıştığı iş parçacığı için.</span><span class="sxs-lookup"><span data-stu-id="4875b-268">A WPF add-in that displays a UI creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a WPF application.</span></span> <span data-ttu-id="4875b-269">Uygulama etki alanında işleyerek meydana gelen tüm işlenmemiş özel durumları algılayabilirsiniz <xref:System.Windows.Threading.Dispatcher.UnhandledException> WPF eklentisi olayı <xref:System.Windows.Threading.Dispatcher>.</span><span class="sxs-lookup"><span data-stu-id="4875b-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the WPF add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="4875b-270">Alabileceğiniz <xref:System.Windows.Threading.Dispatcher> gelen <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> özelliği.</span><span class="sxs-lookup"><span data-stu-id="4875b-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>  
  
<a name="WPFAddInModelLimitations"></a>   
## <a name="wpf-add-in-limitations"></a><span data-ttu-id="4875b-271">WPF eklentisi sınırlamaları</span><span class="sxs-lookup"><span data-stu-id="4875b-271">WPF Add-In Limitations</span></span>  
 <span data-ttu-id="4875b-272">WPF tarafından sağlanan varsayılan davranışlar ekler avantajları ötesinde <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>ve pencere işleyicilerini, aynı zamanda ana uygulamalardan görüntülenen bir eklenti kullanıcı arabirimleri için sınırlamalar vardır:</span><span class="sxs-lookup"><span data-stu-id="4875b-272">Beyond the benefits that WPF adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in user interfaces that are displayed from host applications:</span></span>  
  
-   <span data-ttu-id="4875b-273">Bir konak uygulamasından görüntülenen eklenti kullanıcı arabirimleri konak uygulamanın kırpma davranışını dikkate almaz.</span><span class="sxs-lookup"><span data-stu-id="4875b-273">Add-in user interfaces displayed from a host application do not respect the host application's clipping behavior.</span></span>  
  
-   <span data-ttu-id="4875b-274">Kavramını *hava sahası* birlikte çalışabilirlik senaryolarında de eklentiler için geçerlidir (bkz [teknoloji bölgelerine genel bakış](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="4875b-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span></span>  
  
-   <span data-ttu-id="4875b-275">Kaynağın devralmayı, veri bağlama ve komut vermeye genel, eklenti otomatik olarak kullanılabilir değil gibi bir konak uygulamanın UI Hizmetleri kullanıcı arabirimleri.</span><span class="sxs-lookup"><span data-stu-id="4875b-275">A host application's UI services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in user interfaces.</span></span> <span data-ttu-id="4875b-276">Eklenti, bu hizmetleri sağlamak üzere işlem hattı güncelleştirmeniz gerekiyor.</span><span class="sxs-lookup"><span data-stu-id="4875b-276">To provide these services to the add-in, you need to update the pipeline.</span></span>  
  
-   <span data-ttu-id="4875b-277">Eklentinin kullanıcı Arabirimi döndürülemez, ölçeği, dengesiz veya aksi halde bir dönüştürme tarafından etkilenen (bkz [dönüştüren genel bakış](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="4875b-277">An add-in UI cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span></span>  
  
-   <span data-ttu-id="4875b-278">İçerik işlemlerinden çizerek işlenen eklenti kullanıcı arabirimi içinde <xref:System.Drawing> ad alanı, alfa karıştırma içerebilir.</span><span class="sxs-lookup"><span data-stu-id="4875b-278">Content inside add-in user interfaces that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="4875b-279">Ancak, hem eklenti kullanıcı Arabirimi hem de ana bilgisayar uygulaması içerdiği UI % 100 donuk olmalıdır; diğer bir deyişle, `Opacity` hem de özelliği 1 olarak ayarlanması gerekir.</span><span class="sxs-lookup"><span data-stu-id="4875b-279">However, both an add-in UI and the host application UI that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>  
  
-   <span data-ttu-id="4875b-280">Varsa <xref:System.Windows.Window.AllowsTransparency%2A> özelliği eklenti kullanıcı Arabirimi içeren konak uygulama pencerenin `true`, eklentiyi görünmezdir.</span><span class="sxs-lookup"><span data-stu-id="4875b-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in UI is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="4875b-281">Eklentinin kullanıcı Arabirimi % 100 donuk olsa bile bu geçerlidir (yani `Opacity` özelliği 1 değerine sahip).</span><span class="sxs-lookup"><span data-stu-id="4875b-281">This is true even if the add-in UI is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>  
  
-   <span data-ttu-id="4875b-282">Eklentinin kullanıcı Arabirimi, aynı üst düzey penceresinde diğer WPF öğeleri üzerinde yer almalıdır.</span><span class="sxs-lookup"><span data-stu-id="4875b-282">An add-in UI must appear on top of other WPF elements in the same top-level window.</span></span>  
  
-   <span data-ttu-id="4875b-283">Hiçbir kısmı bir eklentinin kullanıcı Arabirimi kullanarak işlenebilecek bir <xref:System.Windows.Media.VisualBrush>.</span><span class="sxs-lookup"><span data-stu-id="4875b-283">No portion of an add-in's UI can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="4875b-284">Bunun yerine, eklenti anlaşmada tanımlanan yöntemleri kullanarak konak uygulamaya geçirilen bir bit eşlem oluşturmak için oluşturulan kullanıcı arabirimini anlık görüntüsünü alabilir.</span><span class="sxs-lookup"><span data-stu-id="4875b-284">Instead, the add-in may take a snapshot of the generated UI to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>  
  
-   <span data-ttu-id="4875b-285">Medya dosyaları, gelen yürütülemez bir <xref:System.Windows.Controls.MediaElement> eklenti kullanıcı arabiriminde.</span><span class="sxs-lookup"><span data-stu-id="4875b-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in UI.</span></span>  
  
-   <span data-ttu-id="4875b-286">Fare olayları için eklenti kullanıcı Arabirimi tarafından üretilen almaz veya konak uygulama tarafından oluşturulan ve `IsMouseOver` konak uygulama kullanıcı Arabirimi için özellik değerine sahip `false`.</span><span class="sxs-lookup"><span data-stu-id="4875b-286">Mouse events generated for the add-in UI are neither received nor raised by the host application, and the `IsMouseOver` property for host application UI has a value of `false`.</span></span>  
  
-   <span data-ttu-id="4875b-287">Odak bir eklenti UI denetimleri arasındaki geçtiğinde `GotFocus` ve `LostFocus` olayları almaz veya konak uygulama tarafından oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="4875b-287">When focus shifts between controls in an add-in UI, the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>  
  
-   <span data-ttu-id="4875b-288">Eklentinin kullanıcı Arabirimi içeren bir ana bilgisayar uygulaması bölümünü yazdırıldığında beyaz görünür.</span><span class="sxs-lookup"><span data-stu-id="4875b-288">The portion of a host application that contains an add-in UI appears white when printed.</span></span>  
  
-   <span data-ttu-id="4875b-289">Tüm dağıtıcıları (bkz <xref:System.Windows.Threading.Dispatcher>) tarafından oluşturulan kullanıcı Arabirimi kapatılması gerekiyor el ile ana bilgisayar uygulaması yürütme devam ederse sahibi Eklenti kaldırılmadan önce.</span><span class="sxs-lookup"><span data-stu-id="4875b-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in UI must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="4875b-290">Sözleşme, eklenti, böylece kendi Dispatcher eklenti UI kaldırılmadan önce eklentiyi göstermek konak uygulama izin yöntemleri uygulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4875b-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in UI to shut down its dispatchers.</span></span>  
  
-   <span data-ttu-id="4875b-291">Eklentinin kullanıcı Arabirimi ise bir <xref:System.Windows.Controls.InkCanvas> ya da içeren bir <xref:System.Windows.Controls.InkCanvas>, eklentiyi kaldıramıyor.</span><span class="sxs-lookup"><span data-stu-id="4875b-291">If an add-in UI is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>  
  
<a name="PerformanceOptimization"></a>   
## <a name="performance-optimization"></a><span data-ttu-id="4875b-292">Performansı iyileştirme</span><span class="sxs-lookup"><span data-stu-id="4875b-292">Performance Optimization</span></span>  
 <span data-ttu-id="4875b-293">Birden çok uygulama etki alanı kullanıldığında, varsayılan olarak, her uygulama için gereken çeşitli .NET Framework derlemeleri tüm uygulamanın etki alanına yüklenir.</span><span class="sxs-lookup"><span data-stu-id="4875b-293">By default, when multiple application domains are used, the various .NET Framework assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="4875b-294">Sonuç olarak, yeni uygulama etki alanları oluşturma ve uygulamalar bunları başlatmak için gereken süreyi performansını etkileyebilir.</span><span class="sxs-lookup"><span data-stu-id="4875b-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="4875b-295">Ancak, .NET Framework uygulamaları zaten yüklü olduğundan, derlemeleri uygulama etki alanları arasında paylaşmak için yönlendirerek başlangıç zamanı azaltmak bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="4875b-295">However, the .NET Framework provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="4875b-296">Kullanarak bunu <xref:System.LoaderOptimizationAttribute> giriş noktası yöntemi için uygulanması gereken özniteliği (`Main`).</span><span class="sxs-lookup"><span data-stu-id="4875b-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="4875b-297">Bu durumda, uygulama tanımınız uygulamak için yalnızca kod kullanmanız gerekir (bkz [uygulama yönetimine genel bakış](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="4875b-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4875b-298">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="4875b-298">See also</span></span>
- <xref:System.LoaderOptimizationAttribute>
- <span data-ttu-id="4875b-299">[Eklentiler ve Genişletilebilirlik](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100))</span><span class="sxs-lookup"><span data-stu-id="4875b-299">[Add-ins and Extensibility](/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100))</span></span>
- [<span data-ttu-id="4875b-300">Uygulama Etki Alanları</span><span class="sxs-lookup"><span data-stu-id="4875b-300">Application Domains</span></span>](../../../../docs/framework/app-domains/application-domains.md)
- [<span data-ttu-id="4875b-301">.NET framework uzaktan iletişimi genel bakış</span><span class="sxs-lookup"><span data-stu-id="4875b-301">.NET Framework Remoting Overview</span></span>](https://msdn.microsoft.com/library/eccb1d31-0a22-417a-97fd-f4f1f3aa4462)
- [<span data-ttu-id="4875b-302">Nesneleri Uzaktan erişilebilir hale getirme</span><span class="sxs-lookup"><span data-stu-id="4875b-302">Making Objects Remotable</span></span>](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a)
- [<span data-ttu-id="4875b-303">Nasıl Yapılır Konuları</span><span class="sxs-lookup"><span data-stu-id="4875b-303">How-to Topics</span></span>](../../../../docs/framework/wpf/app-development/how-to-topics.md)
