---
title: Birlikte Çalışma Hazırlama
ms.date: 03/30/2017
helpviewer_keywords:
- marshaling, COM interop
- interop marshaling
- interop marshaling, about interop marshaling
ms.assetid: 115f7a2f-d422-4605-ab36-13a8dd28142a
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 21eea2ccdff88a11e9708fef317011dc547cafda
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/23/2019
ms.locfileid: "61873242"
---
# <a name="interop-marshaling"></a><span data-ttu-id="2a960-102">Birlikte Çalışma Hazırlama</span><span class="sxs-lookup"><span data-stu-id="2a960-102">Interop Marshaling</span></span>
<a name="top"></a> <span data-ttu-id="2a960-103">Birlikte çalışma hazırlama veri çağrıları sırasında yönetilen ve yönetilmeyen bellek arasında yöntem bağımsız değişkenleri ve dönüş değerleri nasıl geçirilir yönetir.</span><span class="sxs-lookup"><span data-stu-id="2a960-103">Interop marshaling governs how data is passed in method arguments and return values between managed and unmanaged memory during calls.</span></span> <span data-ttu-id="2a960-104">Birlikte çalışma hazırlama ortak dil çalışma zamanının sıralama hizmeti tarafından gerçekleştirilen bir çalışma zamanı etkinliğidir.</span><span class="sxs-lookup"><span data-stu-id="2a960-104">Interop marshaling is a run-time activity performed by the common language runtime's marshaling service.</span></span>  
  
 <span data-ttu-id="2a960-105">Çoğu veri türleri, hem yönetilen hem de yönetilmeyen bellekte ortak temsilleri olabilir.</span><span class="sxs-lookup"><span data-stu-id="2a960-105">Most data types have common representations in both managed and unmanaged memory.</span></span> <span data-ttu-id="2a960-106">Birlikte çalışma sıralayıcısı, bu tür sizin yerinize çözer.</span><span class="sxs-lookup"><span data-stu-id="2a960-106">The interop marshaler handles these types for you.</span></span> <span data-ttu-id="2a960-107">Diğer türler, belirsiz veya yönetilen bellek içinde gösterilen olabilir.</span><span class="sxs-lookup"><span data-stu-id="2a960-107">Other types can be ambiguous or not represented at all in managed memory.</span></span>  
  
 <span data-ttu-id="2a960-108">Eşleme için tek bir yönetilen türü birden fazla yönetilmeyen gösterimleri ya da eksik tür bilgisi, bir dizinin boyutu gibi belirsiz bir tür olabilir.</span><span class="sxs-lookup"><span data-stu-id="2a960-108">An ambiguous type can have either multiple unmanaged representations that map to a single managed type, or missing type information, such as the size of an array.</span></span> <span data-ttu-id="2a960-109">Belirsiz türler için sıralayıcı, varsayılan gösterim ve birden çok temsile bulunduğu diğer gösterimler sağlar.</span><span class="sxs-lookup"><span data-stu-id="2a960-109">For ambiguous types, the marshaler provides a default representation and alternative representations where multiple representations exist.</span></span> <span data-ttu-id="2a960-110">Sıralayıcı nasıl hazırlanacağını belirsiz bir tür olduğu için açık yönergeler sağlayabilir.</span><span class="sxs-lookup"><span data-stu-id="2a960-110">You can supply explicit instructions to the marshaler on how it is to marshal an ambiguous type.</span></span>  
  
 <span data-ttu-id="2a960-111">Bu genel bakış aşağıdaki bölümleri içerir:</span><span class="sxs-lookup"><span data-stu-id="2a960-111">This overview contains the following sections:</span></span>  
  
- [<span data-ttu-id="2a960-112">Platform çağırma ve COM birlikte çalışma modelleri</span><span class="sxs-lookup"><span data-stu-id="2a960-112">Platform Invoke and COM Interop Models</span></span>](#platform_invoke_and_com_interop_models)  
  
- [<span data-ttu-id="2a960-113">Marshaling ve COM apartmanlar</span><span class="sxs-lookup"><span data-stu-id="2a960-113">Marshaling and COM Apartments</span></span>](#marshaling_and_com_apartments)  
  
- [<span data-ttu-id="2a960-114">Uzak çağrılar hazırlama</span><span class="sxs-lookup"><span data-stu-id="2a960-114">Marshaling Remote Calls</span></span>](#marshaling_remote_calls)  
  
- [<span data-ttu-id="2a960-115">İlgili Konular</span><span class="sxs-lookup"><span data-stu-id="2a960-115">Related Topics</span></span>](#related_topics)  
  
- [<span data-ttu-id="2a960-116">Başvuru</span><span class="sxs-lookup"><span data-stu-id="2a960-116">Reference</span></span>](#reference)  
  
<a name="platform_invoke_and_com_interop_models"></a>   
## <a name="platform-invoke-and-com-interop-models"></a><span data-ttu-id="2a960-117">Platform çağırma ve COM birlikte çalışma modelleri</span><span class="sxs-lookup"><span data-stu-id="2a960-117">Platform Invoke and COM Interop Models</span></span>  
 <span data-ttu-id="2a960-118">Ortak dil çalışma zamanı yönetilmeyen kod ile birlikte çalışma için iki mekanizma sağlar:</span><span class="sxs-lookup"><span data-stu-id="2a960-118">The common language runtime provides two mechanisms for interoperating with unmanaged code:</span></span>  
  
- <span data-ttu-id="2a960-119">Platform çağırma, yönetilmeyen bir kitaplığından dışa aktarılan işlevleri çağırmak yönetilen kod sağlar.</span><span class="sxs-lookup"><span data-stu-id="2a960-119">Platform invoke, which enables managed code to call functions exported from an unmanaged library.</span></span>  
  
- <span data-ttu-id="2a960-120">Yönetilen kodun Bileşen Nesne Modeli (COM) nesneleri, arabirimler aracılığıyla etkileşim sağlar COM birlikte çalışma.</span><span class="sxs-lookup"><span data-stu-id="2a960-120">COM interop, which enables managed code to interact with Component Object Model (COM) objects through interfaces.</span></span>  
  
 <span data-ttu-id="2a960-121">Her iki platform çağırma ve COM birlikte çalışma kullanım birlikte çalışma doğru yöntem bağımsız çağıran ve çağrılan ve geri arasında taşımak için hazırlama gerekli.</span><span class="sxs-lookup"><span data-stu-id="2a960-121">Both platform invoke and COM interop use interop marshaling to accurately move method arguments between caller and callee and back, if required.</span></span> <span data-ttu-id="2a960-122">Aşağıdaki çizimde gösterildiği gibi bir platform çağırma yöntemi çağrısı akışlar yönetilmeyen kod ve hiçbir zaman zaman dışında başka şekilde yönetilen [geri çağırma işlevleri](callback-functions.md) kullanılır.</span><span class="sxs-lookup"><span data-stu-id="2a960-122">As the following illustration shows, a platform invoke method call flows from managed to unmanaged code and never the other way, except when [callback functions](callback-functions.md) are involved.</span></span> <span data-ttu-id="2a960-123">Platform çağırma olsa bile çağrıları yalnızca yönetilmeyen kod için yönetilen akış, giriş veya çıkış parametreleri olarak her iki yönde veri akabilir.</span><span class="sxs-lookup"><span data-stu-id="2a960-123">Even though platform invoke calls can flow only from managed to unmanaged code, data can flow in both directions as input or output parameters.</span></span> <span data-ttu-id="2a960-124">COM birlikte çalışma yöntemi çağrıları, herhangi bir yönde akabilir.</span><span class="sxs-lookup"><span data-stu-id="2a960-124">COM interop method calls can flow in either direction.</span></span>  
  
 <span data-ttu-id="2a960-125">![Platform Çağırma](./media/interop-marshaling/interop-marshaling-invoke-and-com.png "Platform çağırma ve akış COM birlikte çalışabilirlik çağrısı")</span><span class="sxs-lookup"><span data-stu-id="2a960-125">![Platform invoke](./media/interop-marshaling/interop-marshaling-invoke-and-com.png "Platform invoke and COM interop call flow")</span></span>  
  
 <span data-ttu-id="2a960-126">En düşük düzeyde aynı birlikte çalışma hazırlama hizmeti iki mekanizmalarını kullanır; Ancak, yalnızca COM birlikte çalışma tarafından desteklenen belirli veri türleri veya platform çağırma.</span><span class="sxs-lookup"><span data-stu-id="2a960-126">At the lowest level, both mechanisms use the same interop marshaling service; however, certain data types are supported exclusively by COM interop or platform invoke.</span></span> <span data-ttu-id="2a960-127">Ayrıntılar için bkz [varsayılan hazırlama davranışı](default-marshaling-behavior.md).</span><span class="sxs-lookup"><span data-stu-id="2a960-127">For details, see [Default Marshaling Behavior](default-marshaling-behavior.md).</span></span>  
  
 [<span data-ttu-id="2a960-128">Başa dön</span><span class="sxs-lookup"><span data-stu-id="2a960-128">Back to top</span></span>](#top)  
  
<a name="marshaling_and_com_apartments"></a>   
## <a name="marshaling-and-com-apartments"></a><span data-ttu-id="2a960-129">Marshaling ve COM apartmanlar</span><span class="sxs-lookup"><span data-stu-id="2a960-129">Marshaling and COM Apartments</span></span>  
 <span data-ttu-id="2a960-130">Birlikte çalışma sıralayıcısı, ortak dil çalışma zamanı yığınına yönetilmeyen yığından arasında verileri sürekliliğe devreder.</span><span class="sxs-lookup"><span data-stu-id="2a960-130">The interop marshaler marshals data between the common language runtime heap and the unmanaged heap.</span></span> <span data-ttu-id="2a960-131">Çağıran ve çağrılan aynı veri örneği üzerinde çalışamaz her hazırlama gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="2a960-131">Marshaling occurs whenever the caller and callee cannot operate on the same instance of data.</span></span> <span data-ttu-id="2a960-132">Birlikte çalışma sıralayıcısı, çağıran ve çağrılan kendi veri kopyasını olsa bile aynı veriler üzerinde çalışıyor olabilir görünmesine mümkün kılar.</span><span class="sxs-lookup"><span data-stu-id="2a960-132">The interop marshaler makes it possible for the caller and callee to appear to be operating on the same data even if they have their own copy of the data.</span></span>  
  
 <span data-ttu-id="2a960-133">COM COM apartmanlar veya farklı bir COM işlemler arasında veri sürekliliğe devreder bir Sıralayıcı de vardır.</span><span class="sxs-lookup"><span data-stu-id="2a960-133">COM also has a marshaler that marshals data between COM apartments or different COM processes.</span></span> <span data-ttu-id="2a960-134">Aynı COM grup içinde yönetilen ve yönetilmeyen kod arasında arama, birlikte çalışma sıralayıcısı yalnızca Sıralayıcı dahil değildir.</span><span class="sxs-lookup"><span data-stu-id="2a960-134">When calling between managed and unmanaged code within the same COM apartment, the interop marshaler is the only marshaler involved.</span></span> <span data-ttu-id="2a960-135">Yönetilen kod ve yönetimsiz kod içinde farklı bir COM grubu veya başka bir işlem arasında çağrılırken, birlikte çalışma sıralayıcısı hem COM Sıralayıcı faydalanırsınız.</span><span class="sxs-lookup"><span data-stu-id="2a960-135">When calling between managed code and unmanaged code in a different COM apartment or a different process, both the interop marshaler and the COM marshaler are involved.</span></span>  
  
### <a name="com-clients-and-managed-servers"></a><span data-ttu-id="2a960-136">COM istemcilerinde ve yönetilen sunucular</span><span class="sxs-lookup"><span data-stu-id="2a960-136">COM Clients and Managed Servers</span></span>  
 <span data-ttu-id="2a960-137">Kayıtlı bir tür kitaplığı ile verilecek bir yönetilen sunucu tarafından [Regasm.exe (derleme kayıt aracı)](../tools/regasm-exe-assembly-registration-tool.md) sahip bir `ThreadingModel` ayarlamak kayıt defteri girdisini `Both`.</span><span class="sxs-lookup"><span data-stu-id="2a960-137">An exported managed server with a type library registered by the [Regasm.exe (Assembly Registration Tool)](../tools/regasm-exe-assembly-registration-tool.md) has a `ThreadingModel` registry entry set to `Both`.</span></span> <span data-ttu-id="2a960-138">Bu değer, bir tek iş parçacıklı grup (STA) veya bir çok iş parçacıklı grubun (MTA) sunucu etkinleştirilebilir gösterir.</span><span class="sxs-lookup"><span data-stu-id="2a960-138">This value indicates that the server can be activated in a single-threaded apartment (STA) or a multithreaded apartment (MTA).</span></span> <span data-ttu-id="2a960-139">Sunucu nesnesi aşağıdaki tabloda gösterildiği gibi onu çağıran olarak aynı grup içinde oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="2a960-139">The server object is created in the same apartment as its caller, as shown in the following table.</span></span>  
  
|<span data-ttu-id="2a960-140">COM istemcisi</span><span class="sxs-lookup"><span data-stu-id="2a960-140">COM client</span></span>|<span data-ttu-id="2a960-141">.NET sunucu</span><span class="sxs-lookup"><span data-stu-id="2a960-141">.NET server</span></span>|<span data-ttu-id="2a960-142">Hazırlama gereksinimleri</span><span class="sxs-lookup"><span data-stu-id="2a960-142">Marshaling requirements</span></span>|  
|----------------|-----------------|-----------------------------|  
|<span data-ttu-id="2a960-143">STA</span><span class="sxs-lookup"><span data-stu-id="2a960-143">STA</span></span>|<span data-ttu-id="2a960-144">`Both` STA olur</span><span class="sxs-lookup"><span data-stu-id="2a960-144">`Both` becomes STA.</span></span>|<span data-ttu-id="2a960-145">Grup aynı hazırlama.</span><span class="sxs-lookup"><span data-stu-id="2a960-145">Same-apartment marshaling.</span></span>|  
|<span data-ttu-id="2a960-146">MTA</span><span class="sxs-lookup"><span data-stu-id="2a960-146">MTA</span></span>|<span data-ttu-id="2a960-147">`Both` MTA haline gelir.</span><span class="sxs-lookup"><span data-stu-id="2a960-147">`Both` becomes MTA.</span></span>|<span data-ttu-id="2a960-148">Grup aynı hazırlama.</span><span class="sxs-lookup"><span data-stu-id="2a960-148">Same-apartment marshaling.</span></span>|  
  
 <span data-ttu-id="2a960-149">İstemci ve sunucu aynı grupta olduğundan, hizmeti otomatik olarak hazırlama birlikte çalışma hazırlama tüm verileri işler.</span><span class="sxs-lookup"><span data-stu-id="2a960-149">Because the client and server are in the same apartment, the interop marshaling service automatically handles all data marshaling.</span></span> <span data-ttu-id="2a960-150">Aşağıdaki çizimde, yönetilen ve yönetilmeyen yığınlar aynı COM Stili grup içinde arasında işletim birlikte çalışma hazırlama hizmet gösterir.</span><span class="sxs-lookup"><span data-stu-id="2a960-150">The following illustration shows the interop marshaling service operating between managed and unmanaged heaps within the same COM-style apartment.</span></span>  
  
 <span data-ttu-id="2a960-151">![Yönetilen ve yönetilmeyen yığınlar arasında birlikte çalışma hazırlama](./media/interop-marshaling/interop-heaps-managed-and-unmanaged.gif "aynı gruba işlem hazırlama")</span><span class="sxs-lookup"><span data-stu-id="2a960-151">![Interop marshaling between managed and unmanaged heaps](./media/interop-marshaling/interop-heaps-managed-and-unmanaged.gif "Same-apartment marshaling process")</span></span>  
  
 <span data-ttu-id="2a960-152">Yönetilen sunucu dışa aktarmayı planlıyorsanız, COM istemcisi sunucusunun Grup belirlediğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="2a960-152">If you plan to export a managed server, be aware that the COM client determines the apartment of the server.</span></span> <span data-ttu-id="2a960-153">MTA içinde başlatılan bir COM istemcisi tarafından yönetilen bir sunucu, iş parçacığı güvenliği emin olmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="2a960-153">A managed server called by a COM client initialized in an MTA must ensure thread safety.</span></span>  
  
### <a name="managed-clients-and-com-servers"></a><span data-ttu-id="2a960-154">Yönetilen istemcilerin ve COM sunucuları</span><span class="sxs-lookup"><span data-stu-id="2a960-154">Managed Clients and COM Servers</span></span>  
 <span data-ttu-id="2a960-155">MTA yönetilen istemci apartmanlar için varsayılan ayardır; Ancak, .NET istemci uygulama türü, varsayılan ayarı değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2a960-155">The default setting for managed client apartments is MTA; however, the application type of the .NET client can change the default setting.</span></span> <span data-ttu-id="2a960-156">Örneğin, bir [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)] istemci grup ayardır STA.</span><span class="sxs-lookup"><span data-stu-id="2a960-156">For example, a [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)] client apartment setting is STA.</span></span> <span data-ttu-id="2a960-157">Kullanabileceğiniz <xref:System.STAThreadAttribute?displayProperty=nameWithType>, <xref:System.MTAThreadAttribute?displayProperty=nameWithType>, <xref:System.Threading.Thread.ApartmentState%2A?displayProperty=nameWithType> özelliği veya <xref:System.Web.UI.Page.AspCompatMode%2A?displayProperty=nameWithType> incelemek ve yönetilen bir istemci grubu ayarını değiştirmek için özellik.</span><span class="sxs-lookup"><span data-stu-id="2a960-157">You can use the <xref:System.STAThreadAttribute?displayProperty=nameWithType>, the <xref:System.MTAThreadAttribute?displayProperty=nameWithType>, the <xref:System.Threading.Thread.ApartmentState%2A?displayProperty=nameWithType> property, or the <xref:System.Web.UI.Page.AspCompatMode%2A?displayProperty=nameWithType> property to examine and change the apartment setting of a managed client.</span></span>  
  
 <span data-ttu-id="2a960-158">Bileşen yazarı, bir COM sunucusunun iş parçacığı benzeşimini ayarlar.</span><span class="sxs-lookup"><span data-stu-id="2a960-158">The author of the component sets the thread affinity of a COM server.</span></span> <span data-ttu-id="2a960-159">Aşağıdaki tablo, .NET istemcileri ve COM sunucuları için Grup ayarları birleşimleri gösterir.</span><span class="sxs-lookup"><span data-stu-id="2a960-159">The following table shows the combinations of apartment settings for .NET clients and COM servers.</span></span> <span data-ttu-id="2a960-160">Ayrıca, birleşimler için gereksinimleri hazırlama ortaya çıkan gösterir.</span><span class="sxs-lookup"><span data-stu-id="2a960-160">It also shows the resulting marshaling requirements for the combinations.</span></span>  
  
|<span data-ttu-id="2a960-161">.NET istemcisi</span><span class="sxs-lookup"><span data-stu-id="2a960-161">.NET client</span></span>|<span data-ttu-id="2a960-162">COM sunucusu</span><span class="sxs-lookup"><span data-stu-id="2a960-162">COM server</span></span>|<span data-ttu-id="2a960-163">Hazırlama gereksinimleri</span><span class="sxs-lookup"><span data-stu-id="2a960-163">Marshaling requirements</span></span>|  
|-----------------|----------------|-----------------------------|  
|<span data-ttu-id="2a960-164">MTA (varsayılan)</span><span class="sxs-lookup"><span data-stu-id="2a960-164">MTA (default)</span></span>|<span data-ttu-id="2a960-165">MTA</span><span class="sxs-lookup"><span data-stu-id="2a960-165">MTA</span></span><br /><br /> <span data-ttu-id="2a960-166">STA</span><span class="sxs-lookup"><span data-stu-id="2a960-166">STA</span></span>|<span data-ttu-id="2a960-167">Birlikte çalışma hazırlama.</span><span class="sxs-lookup"><span data-stu-id="2a960-167">Interop marshaling.</span></span><br /><br /> <span data-ttu-id="2a960-168">Birlikte çalışabilirlik ve COM hazırlama.</span><span class="sxs-lookup"><span data-stu-id="2a960-168">Interop and COM marshaling.</span></span>|  
|<span data-ttu-id="2a960-169">STA</span><span class="sxs-lookup"><span data-stu-id="2a960-169">STA</span></span>|<span data-ttu-id="2a960-170">MTA</span><span class="sxs-lookup"><span data-stu-id="2a960-170">MTA</span></span><br /><br /> <span data-ttu-id="2a960-171">STA</span><span class="sxs-lookup"><span data-stu-id="2a960-171">STA</span></span>|<span data-ttu-id="2a960-172">Birlikte çalışabilirlik ve COM hazırlama.</span><span class="sxs-lookup"><span data-stu-id="2a960-172">Interop and COM marshaling.</span></span><br /><br /> <span data-ttu-id="2a960-173">Birlikte çalışma hazırlama.</span><span class="sxs-lookup"><span data-stu-id="2a960-173">Interop marshaling.</span></span>|  
  
 <span data-ttu-id="2a960-174">Yönetilen istemci ve yönetilmeyen sunucu aynı grupta olduğunda, tüm veri hazırlama hazırlama hizmet birlikte çalışabilirliği işler.</span><span class="sxs-lookup"><span data-stu-id="2a960-174">When a managed client and unmanaged server are in the same apartment, the interop marshaling service handles all data marshaling.</span></span> <span data-ttu-id="2a960-175">İstemci ve sunucu içinde farklı apartmanlar başlatılır, ancak, COM hazırlama de gereklidir.</span><span class="sxs-lookup"><span data-stu-id="2a960-175">However, when client and server are initialized in different apartments, COM marshaling is also required.</span></span> <span data-ttu-id="2a960-176">Aşağıdaki çizimde bir çapraz-grup çağrısının öğeleri gösterir.</span><span class="sxs-lookup"><span data-stu-id="2a960-176">The following illustration shows the elements of a cross-apartment call.</span></span>  
  
 <span data-ttu-id="2a960-177">![COM hazırlama](./media/interop-marshaling/single-process-across-multi-apartment.gif ".NET istemcisi ve COM nesnesi arasında çapraz-grup araması")</span><span class="sxs-lookup"><span data-stu-id="2a960-177">![COM marshaling](./media/interop-marshaling/single-process-across-multi-apartment.gif "Cross-apartment call between a .NET client and COM object")</span></span>  
  
 <span data-ttu-id="2a960-178">Çapraz-Grup sıralama için aşağıdakileri yapabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="2a960-178">For cross-apartment marshaling, you can do the following:</span></span>  
  
- <span data-ttu-id="2a960-179">Sınırının ötesinde birçok çağrıları olduğunda, fark edilebilir çapraz-grup sıralama yükü kabul edin.</span><span class="sxs-lookup"><span data-stu-id="2a960-179">Accept the overhead of the cross-apartment marshaling, which is noticeable only when there are many calls across the boundary.</span></span> <span data-ttu-id="2a960-180">COM bileşeni başarıyla apartman sınırını aşan çağrı için tür kitaplığı kaydetmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="2a960-180">You must register the type library of the COM component for calls to successfully cross the apartment boundary.</span></span>  
  
- <span data-ttu-id="2a960-181">Ana iş parçacığı STA ya da MTA istemci iş parçacığı ayarlayarak değiştirir.</span><span class="sxs-lookup"><span data-stu-id="2a960-181">Alter the main thread by setting the client thread to STA or MTA.</span></span> <span data-ttu-id="2a960-182">Örneğin, varsa, C# istemci çağrıları birçok STA COM bileşenlerini, ana iş parçacığı için STA ayarlayarak çapraz-grup sıralama önleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2a960-182">For example, if your C# client calls many STA COM components, you can avoid cross-apartment marshaling by setting the main thread to STA.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="2a960-183">Sonra iş parçacığı bir C# istemci için STA ayarlandığında, çapraz-grup sıralama MTA COM bileşenleri çağrıları gerekir.</span><span class="sxs-lookup"><span data-stu-id="2a960-183">Once the thread of a C# client is set to STA, calls to MTA COM components will require cross-apartment marshaling.</span></span>  
  
 <span data-ttu-id="2a960-184">Açıkça bir apartman modeli seçme ile ilgili yönergeler için bkz: [yönetilen ve yönetilmeyen iş parçacığı](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/5s8ee185(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="2a960-184">For instructions on explicitly selecting an apartment model, see [Managed and Unmanaged Threading](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/5s8ee185(v=vs.100)).</span></span>  
  
 [<span data-ttu-id="2a960-185">Başa dön</span><span class="sxs-lookup"><span data-stu-id="2a960-185">Back to top</span></span>](#top)  
  
<a name="marshaling_remote_calls"></a>   
## <a name="marshaling-remote-calls"></a><span data-ttu-id="2a960-186">Uzak çağrılar hazırlama</span><span class="sxs-lookup"><span data-stu-id="2a960-186">Marshaling Remote Calls</span></span>  
 <span data-ttu-id="2a960-187">Çapraz-Grup hazırlama gibi ile hazırlama COM nesneleri ayrı işlemlerde bulunan her yönetilen ve yönetilmeyen kod arasındaki her çağrıda dahil.</span><span class="sxs-lookup"><span data-stu-id="2a960-187">As with cross-apartment marshaling, COM marshaling is involved in each call between managed and unmanaged code whenever the objects reside in separate processes.</span></span> <span data-ttu-id="2a960-188">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="2a960-188">For example:</span></span>  
  
- <span data-ttu-id="2a960-189">Uzak bir ana bilgisayarın yönetilen bir sunucuda çağıran bir COM istemcisi Dağıtılmış COM (DCOM) kullanır.</span><span class="sxs-lookup"><span data-stu-id="2a960-189">A COM client that invokes a managed server on a remote host uses distributed COM (DCOM).</span></span>  
  
- <span data-ttu-id="2a960-190">Çağıran uzak ana bilgisayarda bir COM sunucusu yönetilen istemci DCOM kullanır.</span><span class="sxs-lookup"><span data-stu-id="2a960-190">A managed client that invokes a COM server on a remote host uses DCOM.</span></span>  
  
 <span data-ttu-id="2a960-191">COM hazırlama, işlem ve konak sınırları içinde iletişim kanalları sağlamak ve nasıl birlikte çalışma hazırlama aşağıdaki çizimde gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="2a960-191">The following illustration shows how interop marshaling and COM marshaling provide communications channels across process and host boundaries.</span></span>  
  
 <span data-ttu-id="2a960-192">![COM hazırlama](./media/interop-marshaling/interop-and-com-marshaling.gif "çapraz işlem hazırlama")</span><span class="sxs-lookup"><span data-stu-id="2a960-192">![COM marshaling](./media/interop-marshaling/interop-and-com-marshaling.gif "Cross-process marshaling")</span></span>  
  
### <a name="preserving-identity"></a><span data-ttu-id="2a960-193">Kimliği koruma</span><span class="sxs-lookup"><span data-stu-id="2a960-193">Preserving Identity</span></span>  
 <span data-ttu-id="2a960-194">Ortak dil çalışma zamanı, yönetilen ve yönetilmeyen başvuruları kimliğini korur.</span><span class="sxs-lookup"><span data-stu-id="2a960-194">The common language runtime preserves the identity of managed and unmanaged references.</span></span> <span data-ttu-id="2a960-195">Aşağıdaki çizimde, işlem ve konak sınırları içinde doğrudan yönetilmeyen başvuruları (üst satırı) ve doğrudan yönetilen başvuruları (alttaki) akışı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="2a960-195">The following illustration shows the flow of direct unmanaged references (top row) and direct managed references (bottom row) across process and host boundaries.</span></span>  
  
 <span data-ttu-id="2a960-196">![COM çağrılabilir sarmalayıcısı ve çalışma zamanı çağrılabilir sarmalayıcı](./media/interop-marshaling/interop-direct-ref-across-process.gif "işlemi ve konak sınırlarından geçirirken başvurusu")</span><span class="sxs-lookup"><span data-stu-id="2a960-196">![COM callable wrapper and runtime callable wrapper](./media/interop-marshaling/interop-direct-ref-across-process.gif "Reference passing across process and host boundaries")</span></span>  
  
 <span data-ttu-id="2a960-197">Bu çizimde:</span><span class="sxs-lookup"><span data-stu-id="2a960-197">In this illustration:</span></span>  
  
- <span data-ttu-id="2a960-198">Yönetilmeyen bir istemci bir COM nesnesi için uzak bir ana bilgisayardan bu başvuru alır ve yönetilen bir nesneye başvuru alır.</span><span class="sxs-lookup"><span data-stu-id="2a960-198">An unmanaged client gets a reference to a COM object from a managed object that gets this reference from a remote host.</span></span> <span data-ttu-id="2a960-199">DCOM Uzaktan iletişim mekanizmasıdır.</span><span class="sxs-lookup"><span data-stu-id="2a960-199">The remoting mechanism is DCOM.</span></span>  
  
- <span data-ttu-id="2a960-200">Yönetilen istemci uzak bir ana bilgisayardan bu başvuruyu alır bir COM nesnesi yönetilen bir nesneye bir başvuru alır.</span><span class="sxs-lookup"><span data-stu-id="2a960-200">A managed client gets a reference to a managed object from a COM object that gets this reference from a remote host.</span></span> <span data-ttu-id="2a960-201">DCOM Uzaktan iletişim mekanizmasıdır.</span><span class="sxs-lookup"><span data-stu-id="2a960-201">The remoting mechanism is DCOM.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="2a960-202">Dışarı aktarılan tür kitaplığı yönetilen sunucunun kayıtlı olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="2a960-202">The exported type library of the managed server must be registered.</span></span>  
  
 <span data-ttu-id="2a960-203">Çağıran ve çağrılan arasında işlem sınırları ilgisiz sayısıdır; aynı doğrudan başvuru işlem içi ve dışı işlem çağrıları için gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="2a960-203">The number of process boundaries between caller and callee is irrelevant; the same direct referencing occurs for in-process and out-of-process calls.</span></span>  
  
### <a name="managed-remoting"></a><span data-ttu-id="2a960-204">Yönetilen uzaktan iletişim</span><span class="sxs-lookup"><span data-stu-id="2a960-204">Managed Remoting</span></span>  
 <span data-ttu-id="2a960-205">Çalışma zamanı Ayrıca, işlem ve konak sınırları yönetilen nesneler arasında bir iletişim kanalı kurmak için kullanabileceğiniz yönetilen uzaktan iletişim sağlar.</span><span class="sxs-lookup"><span data-stu-id="2a960-205">The runtime also provides managed remoting, which you can use to establish a communications channel between managed objects across process and host boundaries.</span></span> <span data-ttu-id="2a960-206">Yönetilen uzaktan iletişim, aşağıdaki çizimde gösterildiği gibi iletişim kuran bileşenler arasında bir güvenlik duvarı barındırabilir.</span><span class="sxs-lookup"><span data-stu-id="2a960-206">Managed remoting can accommodate a firewall between the communicating components, as the following illustration shows.</span></span>  
  
 <span data-ttu-id="2a960-207">![SOAP veya TcpChannel](./media/interop-marshaling/interop-remote-soap-or-tcp.gif "SOAP veya TcpChannel sınıfı kullanarak güvenlik duvarları üzerinden uzaktan çağırır")</span><span class="sxs-lookup"><span data-stu-id="2a960-207">![SOAP or TcpChannel](./media/interop-marshaling/interop-remote-soap-or-tcp.gif "Remote calls across firewalls using SOAP or the TcpChannel class")</span></span>  
<span data-ttu-id="2a960-208">Güvenlik duvarları SOAP veya TcpChannel sınıfı kullanarak uzak çağrılar</span><span class="sxs-lookup"><span data-stu-id="2a960-208">Remote calls across firewalls using SOAP or the TcpChannel class</span></span>  
  
 <span data-ttu-id="2a960-209">Yönetilmeyen bazı çağrılar SOAP, com ile hizmet verilen bileşenleri arasındaki çağrıları gibi channeled</span><span class="sxs-lookup"><span data-stu-id="2a960-209">Some unmanaged calls can be channeled through SOAP, such as the calls between serviced components and COM.</span></span>  
  
 [<span data-ttu-id="2a960-210">Başa dön</span><span class="sxs-lookup"><span data-stu-id="2a960-210">Back to top</span></span>](#top)  
  
<a name="related_topics"></a>   
## <a name="related-topics"></a><span data-ttu-id="2a960-211">İlgili Konular</span><span class="sxs-lookup"><span data-stu-id="2a960-211">Related Topics</span></span>  
  
|<span data-ttu-id="2a960-212">Başlık</span><span class="sxs-lookup"><span data-stu-id="2a960-212">Title</span></span>|<span data-ttu-id="2a960-213">Açıklama</span><span class="sxs-lookup"><span data-stu-id="2a960-213">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="2a960-214">Varsayılan Hazırlama Davranışı</span><span class="sxs-lookup"><span data-stu-id="2a960-214">Default Marshaling Behavior</span></span>](default-marshaling-behavior.md)|<span data-ttu-id="2a960-215">Veri hazırlama için birlikte çalışma hazırlama hizmeti kullanan kurallar açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="2a960-215">Describes the rules that the interop marshaling service uses to marshal data.</span></span>|  
|[<span data-ttu-id="2a960-216">Platform Çağırma ile Veri Hazırlama</span><span class="sxs-lookup"><span data-stu-id="2a960-216">Marshaling Data with Platform Invoke</span></span>](marshaling-data-with-platform-invoke.md)|<span data-ttu-id="2a960-217">Yöntem parametreleri bildirmek ve yönetilmeyen kitaplıkları tarafından dışarı aktarılan işlevler için bağımsız değişkenler geçirmek açıklar.</span><span class="sxs-lookup"><span data-stu-id="2a960-217">Describes how to declare method parameters and pass arguments to functions exported by unmanaged libraries.</span></span>|  
|[<span data-ttu-id="2a960-218">COM Birlikte Çalışma ile Verileri Hazırlama</span><span class="sxs-lookup"><span data-stu-id="2a960-218">Marshaling Data with COM Interop</span></span>](marshaling-data-with-com-interop.md)|<span data-ttu-id="2a960-219">Hazırlama davranışı değiştirmek için COM sarmalayıcıları özelleştirmeyi açıklar.</span><span class="sxs-lookup"><span data-stu-id="2a960-219">Describes how to customize COM wrappers to alter marshaling behavior.</span></span>|  
|[<span data-ttu-id="2a960-220">Nasıl yapılır: Yönetilen kodu DCOM'dan WCF'ye geçirme</span><span class="sxs-lookup"><span data-stu-id="2a960-220">How to: Migrate Managed-Code DCOM to WCF</span></span>](how-to-migrate-managed-code-dcom-to-wcf.md)|<span data-ttu-id="2a960-221">DCOM'dan WCF'ye geçirme işlemini açıklamaktadır.</span><span class="sxs-lookup"><span data-stu-id="2a960-221">Describes how to migrate from DCOM to WCF.</span></span>|  
|[<span data-ttu-id="2a960-222">Nasıl yapılır: Harita HRESULTs ve özel durumları</span><span class="sxs-lookup"><span data-stu-id="2a960-222">How to: Map HRESULTs and Exceptions</span></span>](how-to-map-hresults-and-exceptions.md)|<span data-ttu-id="2a960-223">HRESULT'ları için özel durumları eşleme açıklar ve .NET Framework'teki kendi karşılaştırılabilir özel durum sınıfı için her HRESULT tam eşleme sağlar.</span><span class="sxs-lookup"><span data-stu-id="2a960-223">Describes how to map custom exceptions to HRESULTs and provides the complete mapping from each HRESULT to its comparable exception class in the .NET Framework.</span></span>|  
|<span data-ttu-id="2a960-224">[Genel türleri kullanarak birlikte çalışma](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms229590(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="2a960-224">[Interoperating Using Generic Types](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms229590(v=vs.100))</span></span>|<span data-ttu-id="2a960-225">Hangi eylemler genel türler COM birlikte çalışabilirlik için kullanılırken desteklenen açıklar.</span><span class="sxs-lookup"><span data-stu-id="2a960-225">Describes which actions are supported when using generic types for COM interoperability.</span></span>|  
|[<span data-ttu-id="2a960-226">Yönetilmeyen Kod ile Birlikte Çalışma</span><span class="sxs-lookup"><span data-stu-id="2a960-226">Interoperating with Unmanaged Code</span></span>](index.md)|<span data-ttu-id="2a960-227">Ortak dil çalışma zamanı tarafından sağlanan birlikte çalışabilirlik hizmetlerini açıklar.</span><span class="sxs-lookup"><span data-stu-id="2a960-227">Describes interoperability services provided by the common language runtime.</span></span>|  
|<span data-ttu-id="2a960-228">[Gelişmiş COM birlikte çalışabilirliği](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bd9cdfyx(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="2a960-228">[Advanced COM Interoperability](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bd9cdfyx(v=vs.100))</span></span>|<span data-ttu-id="2a960-229">COM bileşenlerini .NET Framework'te uygulamanıza ekleme hakkında daha fazla bilgi için bağlantılar sağlar.</span><span class="sxs-lookup"><span data-stu-id="2a960-229">Provides links to more information about incorporating COM components into your .NET Framework application.</span></span>|  
|<span data-ttu-id="2a960-230">[Birlikte çalışma için tasarım konuları](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/61aax4kh(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="2a960-230">[Design Considerations for Interoperation](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/61aax4kh(v=vs.100))</span></span>|<span data-ttu-id="2a960-231">Tümleşik COM bileşenlerini yazmak için ipuçları sağlar.</span><span class="sxs-lookup"><span data-stu-id="2a960-231">Provides tips for writing integrated COM components.</span></span>|  
  
 [<span data-ttu-id="2a960-232">Başa dön</span><span class="sxs-lookup"><span data-stu-id="2a960-232">Back to top</span></span>](#top)  
  
<a name="reference"></a>   
## <a name="reference"></a><span data-ttu-id="2a960-233">Başvuru</span><span class="sxs-lookup"><span data-stu-id="2a960-233">Reference</span></span>  
 <xref:System.Runtime.InteropServices?displayProperty=nameWithType>  
  
 [<span data-ttu-id="2a960-234">Başa dön</span><span class="sxs-lookup"><span data-stu-id="2a960-234">Back to top</span></span>](#top)
