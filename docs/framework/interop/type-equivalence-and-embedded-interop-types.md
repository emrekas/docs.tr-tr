---
title: Tür eşdeğerliği ve katıştırılmış birlikte çalışma türleri
ms.date: 03/30/2017
helpviewer_keywords:
- type equivalence
- embedded interop types
- primary interop assemblies,not necessary in CLR version 4
- NoPIA
ms.assetid: 78892eba-2a58-4165-b4b1-0250ee2f41dc
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: b9ec21a21ce3c81c2d29d2edf353a098489c9026
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 04/23/2019
ms.locfileid: "62032896"
---
# <a name="type-equivalence-and-embedded-interop-types"></a><span data-ttu-id="b5071-102">Tür eşdeğerliği ve katıştırılmış birlikte çalışma türleri</span><span class="sxs-lookup"><span data-stu-id="b5071-102">Type equivalence and embedded interop types</span></span>

<span data-ttu-id="b5071-103">İle başlayarak [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], birlikte çalışma derlemeleri COM türleri için tür bilgisi almak Yönetilen derlemeler göstermek zorunda kalmadan doğrudan Yönetilen derlemeler, COM türleri için tür bilgilerini katıştırma ortak dil çalışma zamanı destekler.</span><span class="sxs-lookup"><span data-stu-id="b5071-103">Beginning with the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], the common language runtime supports embedding type information for COM types directly into managed assemblies, instead of requiring the managed assemblies to obtain type information for COM types from interop assemblies.</span></span> <span data-ttu-id="b5071-104">Gömülü tür bilgileri yalnızca türler ve gerçekten yönetilen bir derleme tarafından kullanılan üyeler içerdiğinden, iki Yönetilen derlemeler çok farklı görünümleri aynı COM tür olabilir.</span><span class="sxs-lookup"><span data-stu-id="b5071-104">Because the embedded type information includes only the types and members that are actually used by a managed assembly, two managed assemblies might have very different views of the same COM type.</span></span> <span data-ttu-id="b5071-105">Yönetilen her derlemenin farklı bir sahip <xref:System.Type> COM türü onun görünümünü temsil eden nesne.</span><span class="sxs-lookup"><span data-stu-id="b5071-105">Each managed assembly has a different <xref:System.Type> object to represent its view of the COM type.</span></span> <span data-ttu-id="b5071-106">Ortak dil çalışma zamanı tür denklik arabirimleri, yapılar, sabit listeleri ve temsilciler için bu farklı görünümleri arasında destekler.</span><span class="sxs-lookup"><span data-stu-id="b5071-106">The common language runtime supports type equivalence between these different views for interfaces, structures, enumerations, and delegates.</span></span>

<span data-ttu-id="b5071-107">Tür eşdeğerliği birinden diğerine yönetilen bütünleştirilmiş kod uygun olarak atanabilir geçirilen bir COM nesnesi türü alma derlemedeki yönetilen anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="b5071-107">Type equivalence means that a COM object that is passed from one managed assembly to another can be cast to the appropriate managed type in the receiving assembly.</span></span>

> [!NOTE]
> <span data-ttu-id="b5071-108">Birlikte çalışma derlemeleriyle uygulamaları dağıtmak gerekli olmadığından tür eşdeğerliği ve katıştırılmış birlikte çalışma türleri, uygulamaların dağıtımını ve COM bileşenlerini kullanmak eklentileri basitleştirin.</span><span class="sxs-lookup"><span data-stu-id="b5071-108">Type equivalence and embedded interop types simplify the deployment of applications and add-ins that use COM components, because it is not necessary to deploy interop assemblies with the applications.</span></span> <span data-ttu-id="b5071-109">Geliştiricilerin paylaşılan COM bileşenlerinin, yine de .NET Framework'ün önceki sürümleri tarafından kullanılan bileşenleri istediğinde birincil birlikte çalışma derlemeleri (PIA) oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="b5071-109">Developers of shared COM components still have to create primary interop assemblies (PIAs) if they want their components to be used by earlier versions of the .NET Framework.</span></span>

## <a name="type-equivalence"></a><span data-ttu-id="b5071-110">Tür denkliği</span><span class="sxs-lookup"><span data-stu-id="b5071-110">Type equivalence</span></span>

 <span data-ttu-id="b5071-111">COM tür denklik arabirimleri, yapılar, sabit listeleri ve temsilciler için desteklenir.</span><span class="sxs-lookup"><span data-stu-id="b5071-111">Equivalence of COM types is supported for interfaces, structures, enumerations, and delegates.</span></span> <span data-ttu-id="b5071-112">COM türleri, aşağıdakilerin tümü doğru olduğunda denk olarak uygun:</span><span class="sxs-lookup"><span data-stu-id="b5071-112">COM types qualify as equivalent if all of the following are true:</span></span>

- <span data-ttu-id="b5071-113">, Hem arabirimleri veya hem yapıları veya hem sabit listeleri veya her iki temsilci türleridir.</span><span class="sxs-lookup"><span data-stu-id="b5071-113">The types are both interfaces, or both structures, or both enumerations, or both delegates.</span></span>

- <span data-ttu-id="b5071-114">Sonraki bölümde açıklandığı gibi türleri aynı kimliğe sahip.</span><span class="sxs-lookup"><span data-stu-id="b5071-114">The types have the same identity, as described in the next section.</span></span>

- <span data-ttu-id="b5071-115">Her iki türü de açıklandığı gibi tür denklik için uygun olan [işaretleme COM türleri tür eşdeğerliğine için](#marking-com-types-for-type-equivalence) bölümü.</span><span class="sxs-lookup"><span data-stu-id="b5071-115">Both types are eligible for type equivalence, as described in the [Marking COM types for type equivalence](#marking-com-types-for-type-equivalence) section.</span></span>

### <a name="type-identity"></a><span data-ttu-id="b5071-116">Tür kimliği</span><span class="sxs-lookup"><span data-stu-id="b5071-116">Type identity</span></span>

<span data-ttu-id="b5071-117">İki tür, kapsamları ve kimlikler, diğer bir deyişle, eşleştiğinde her varsa aynı kimliğe sahip belirlenir <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> özniteliği ve iki öznitelik sahip eşleşen <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> ve <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> özellikleri.</span><span class="sxs-lookup"><span data-stu-id="b5071-117">Two types are determined to have the same identity when their scopes and identities match, in other words, if they each have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, and the two attributes have matching <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> and <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> properties.</span></span> <span data-ttu-id="b5071-118">Karşılaştırma için <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> büyük küçük harfe duyarlıdır.</span><span class="sxs-lookup"><span data-stu-id="b5071-118">The comparison for <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> is case-insensitive.</span></span>

<span data-ttu-id="b5071-119">Bir tür yoksa <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> özniteliği veya varsa bir <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> belirtmiyor kapsamı ve tanımlayıcı, türü özniteliği hala olarak kabul edilir denklik için şu şekilde:</span><span class="sxs-lookup"><span data-stu-id="b5071-119">If a type does not have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, or if it has a <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute that does not specify scope and identifier, the type can still be considered for equivalence as follows:</span></span>

- <span data-ttu-id="b5071-120">Arabirimlerin, değerini <xref:System.Runtime.InteropServices.GuidAttribute> yerine kullanılan <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> özelliği ve <xref:System.Type.FullName%2A?displayProperty=nameWithType> özelliği (ad alanı dahil diğer bir deyişle, tür adını) yerine kullanılır <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType> özelliği.</span><span class="sxs-lookup"><span data-stu-id="b5071-120">For interfaces, the value of the <xref:System.Runtime.InteropServices.GuidAttribute> is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property (that is, the type name, including the namespace) is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="b5071-121">Yapılar, sabit listeleri ve Temsilciler <xref:System.Runtime.InteropServices.GuidAttribute> içeren derlemenin yerine kullanılır <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> özelliği ve <xref:System.Type.FullName%2A?displayProperty=nameWithType> özelliğinin yerine kullanılır <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> özelliği.</span><span class="sxs-lookup"><span data-stu-id="b5071-121">For structures, enumerations, and delegates, the <xref:System.Runtime.InteropServices.GuidAttribute> of the containing assembly is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> property.</span></span>

### <a name="marking-com-types-for-type-equivalence"></a><span data-ttu-id="b5071-122">COM türleri tür eşdeğerliğine için işaretleme</span><span class="sxs-lookup"><span data-stu-id="b5071-122">Marking COM types for type equivalence</span></span>

 <span data-ttu-id="b5071-123">Bir tür için iki yolla türü eşdeğerlik uygun olarak işaretleyebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="b5071-123">You can mark a type as eligible for type equivalence in two ways:</span></span>

- <span data-ttu-id="b5071-124">Uygulama <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> öznitelik türü için.</span><span class="sxs-lookup"><span data-stu-id="b5071-124">Apply the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute to the type.</span></span>

- <span data-ttu-id="b5071-125">Türünün bir COM içeri aktarma türü olmasını sağlayın.</span><span class="sxs-lookup"><span data-stu-id="b5071-125">Make the type a COM import type.</span></span> <span data-ttu-id="b5071-126">Bu arabirim bir COM içeri aktarma türü ise <xref:System.Runtime.InteropServices.ComImportAttribute> özniteliği.</span><span class="sxs-lookup"><span data-stu-id="b5071-126">An interface is a COM import type if it has the <xref:System.Runtime.InteropServices.ComImportAttribute> attribute.</span></span> <span data-ttu-id="b5071-127">Derleme içinde tanımlanmış olduğu bir arabirim, yapı, sabit listesi veya temsilci bir COM içeri aktarma türü ise <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute> özniteliği.</span><span class="sxs-lookup"><span data-stu-id="b5071-127">An interface, structure, enumeration, or delegate is a COM import type if the assembly in which it is defined has the <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute> attribute.</span></span>

## <a name="see-also"></a><span data-ttu-id="b5071-128">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="b5071-128">See also</span></span>

- <xref:System.Type.IsEquivalentTo%2A>
- <span data-ttu-id="b5071-129">[Yönetilen kodda COM türlerini kullanma](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="b5071-129">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="b5071-130">Tür Kitaplığını Bütünleştirilmiş Kod Olarak İçeri Aktarma</span><span class="sxs-lookup"><span data-stu-id="b5071-130">Importing a Type Library as an Assembly</span></span>](importing-a-type-library-as-an-assembly.md)
