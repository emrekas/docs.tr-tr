---
title: Tür Kitaplığını Derleme Olarak İçeri Aktarma
ms.date: 03/30/2017
helpviewer_keywords:
- importing type library
- type metadata
- custom wrappers
- metadata
- exposing COM components to .NET Framework
- Type Library Importer
- interoperation with unmanaged code, importing type library
- interoperation with unmanaged code, exposing COM components
- type libraries
- TypeLibConverter class, importing type library as assembly
- COM interop, importing type library
- COM interop, exposing COM components
ms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 5388c67b4cc7b493e6662f421ae13ae878c858ec
ms.sourcegitcommit: 155012a8a826ee8ab6aa49b1b3a3b532e7b7d9bd
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 06/04/2019
ms.locfileid: "66490020"
---
# <a name="importing-a-type-library-as-an-assembly"></a><span data-ttu-id="37211-102">Tür Kitaplığını Derleme Olarak İçeri Aktarma</span><span class="sxs-lookup"><span data-stu-id="37211-102">Importing a Type Library as an Assembly</span></span>
<span data-ttu-id="37211-103">COM tür tanımları, genellikle bir tür kitaplığı içinde yer alır.</span><span class="sxs-lookup"><span data-stu-id="37211-103">COM type definitions usually reside in a type library.</span></span> <span data-ttu-id="37211-104">Buna karşılık, CLS uyumlu derleyiciler türü meta verileri bir derleme oluşturur.</span><span class="sxs-lookup"><span data-stu-id="37211-104">In contrast, CLS-compliant compilers produce type metadata in an assembly.</span></span> <span data-ttu-id="37211-105">İki tür bilgi kaynakları oldukça farklıdır.</span><span class="sxs-lookup"><span data-stu-id="37211-105">The two sources of type information are quite different.</span></span> <span data-ttu-id="37211-106">Bu konu, bir tür kitaplığından meta verileri oluşturma teknikleri açıklar.</span><span class="sxs-lookup"><span data-stu-id="37211-106">This topic describes techniques for generating metadata from a type library.</span></span> <span data-ttu-id="37211-107">Elde edilen derlemeyi birlikte çalışma derlemesi adı verilir ve içerdiği tür bilgilerini COM türlerini kullanmak .NET Framework uygulamaları etkinleştirir.</span><span class="sxs-lookup"><span data-stu-id="37211-107">The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.</span></span>  
  
 <span data-ttu-id="37211-108">Bu tür bilgiler, uygulamanızın kullanılabilir hale getirmek için iki yolu vardır:</span><span class="sxs-lookup"><span data-stu-id="37211-108">There are two ways to make this type information available to your application:</span></span>  
  
- <span data-ttu-id="37211-109">Tasarım-zamanı-yalnızca birlikte çalışma derlemelerini kullanarak: .NET Framework 4 ile başlayarak, derleyicinin tür bilgilerini birlikte çalışma bütünleştirilmiş kod yürütülebilir dosyanın içine gömmek için bildirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37211-109">Using design-time-only interop assemblies: Beginning with the .NET Framework 4, you can instruct the compiler to embed type information from the interop assembly into your executable.</span></span> <span data-ttu-id="37211-110">Derleyici, uygulamanızın kullandığı tür bilgilerini katıştırır.</span><span class="sxs-lookup"><span data-stu-id="37211-110">The compiler embeds only the type information that your application uses.</span></span> <span data-ttu-id="37211-111">Uygulamanızla birlikte çalışma derlemesi dağıtmak gerekmez.</span><span class="sxs-lookup"><span data-stu-id="37211-111">You do not have to deploy the interop assembly with your application.</span></span> <span data-ttu-id="37211-112">Önerilen yöntem budur.</span><span class="sxs-lookup"><span data-stu-id="37211-112">This is the recommended technique.</span></span>  
  
- <span data-ttu-id="37211-113">Birlikte çalışma derlemelerini dağıtma: Standart bir birlikte çalışma derlemesine başvuru oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37211-113">Deploying interop assemblies: You can create a standard reference to the interop assembly.</span></span> <span data-ttu-id="37211-114">Bu durumda, birlikte çalışma derlemesi uygulamanızla dağıtılması gerekir.</span><span class="sxs-lookup"><span data-stu-id="37211-114">In this case, the interop assembly must be deployed with your application.</span></span> <span data-ttu-id="37211-115">Bu tekniği kullanır ve özel bir COM bileşeni kullanmıyorsanız, her zaman, yönetilen kodda birleştirmek istiyorsanız COM bileşeninin yazarı tarafından yayımlanan birincil birlikte çalışma derlemesi (PIA) başvuru.</span><span class="sxs-lookup"><span data-stu-id="37211-115">If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.</span></span> <span data-ttu-id="37211-116">Üretme ve birincil birlikte çalışma derlemeleri kullanma hakkında daha fazla bilgi için bkz. [birincil birlikte çalışma derlemelerini](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="37211-116">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span></span>  
  
 <span data-ttu-id="37211-117">Tasarım-zamanı-yalnızca birlikte çalışma derlemelerini kullandığınızda, tür bilgilerini COM bileşeninin yazarı tarafından yayımlanan birincil birlikte çalışma derlemesine gömebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="37211-117">When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component.</span></span> <span data-ttu-id="37211-118">Ancak, birincil birlikte çalışma derlemesi uygulamanızla birlikte dağıtmak gerekmez.</span><span class="sxs-lookup"><span data-stu-id="37211-118">However, you do not have to deploy the primary interop assembly with your application.</span></span>  
  
 <span data-ttu-id="37211-119">Çoğu uygulama, bir COM bileşeni'nin tüm özelliklerini kullanmayın çünkü tasarım-zamanı-yalnızca birlikte çalışma bütünleştirilmiş kodlarını kullanarak, uygulamanızın boyutunu azaltır.</span><span class="sxs-lookup"><span data-stu-id="37211-119">Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component.</span></span> <span data-ttu-id="37211-120">Tür bilgilerini katıştırır, derleyici çok verimli olmasıdır; Uygulamanızı yalnızca birkaç yöntemi bir COM arabirimi üzerinde kullanıyorsa, derleyici kullanılmayan metotlar katıştırmak değil.</span><span class="sxs-lookup"><span data-stu-id="37211-120">The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods.</span></span> <span data-ttu-id="37211-121">Gömülü tür bilgileri içeren bir uygulama gibi başka bir uygulamayla etkileşimiyle ya da bir birincil birlikte çalışma derlemesi kullanan bir uygulama ile etkileşim kurar, ortak dil çalışma zamanı kullanan iki ile türleri olup olmadığını belirlemek için denklik kuralları yazın. aynı adı aynı COM türü temsil eder.</span><span class="sxs-lookup"><span data-stu-id="37211-121">When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type.</span></span> <span data-ttu-id="37211-122">Bu kurallar, COM nesnelerini kullanmak için bilmeniz gerekmez.</span><span class="sxs-lookup"><span data-stu-id="37211-122">You do not have to know these rules to use COM objects.</span></span> <span data-ttu-id="37211-123">Ancak, kurallarda ilgileniyorsanız bkz [tür Eşdeğerliği ve katıştırılmış birlikte çalışma türleri](../../../docs/framework/interop/type-equivalence-and-embedded-interop-types.md).</span><span class="sxs-lookup"><span data-stu-id="37211-123">However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](../../../docs/framework/interop/type-equivalence-and-embedded-interop-types.md).</span></span>  
  
## <a name="generating-metadata"></a><span data-ttu-id="37211-124">Meta verileri oluşturuluyor</span><span class="sxs-lookup"><span data-stu-id="37211-124">Generating Metadata</span></span>  
 <span data-ttu-id="37211-125">COM tür kitaplıkları Loanlib.tlb gibi .tlb uzantılı sahip tek başına dosyalar olabilir.</span><span class="sxs-lookup"><span data-stu-id="37211-125">COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb.</span></span> <span data-ttu-id="37211-126">Bazı tür kitaplıklarının bir .dll veya .exe dosyasının kaynak bölümüne katıştırılır.</span><span class="sxs-lookup"><span data-stu-id="37211-126">Some type libraries are embedded in the resource section of a .dll or .exe file.</span></span> <span data-ttu-id="37211-127">Tür kitaplığı bilgisi diğer kaynakları .olb ve .ocx dosyalarıdır.</span><span class="sxs-lookup"><span data-stu-id="37211-127">Other sources of type library information are .olb and .ocx files.</span></span>  
  
 <span data-ttu-id="37211-128">COM türü hedef uyarlamasını içeren tür kitaplığını bulduktan sonra türü meta verileri içeren bir birlikte çalışma derlemesi oluşturmak için aşağıdaki seçenekleriniz vardır:</span><span class="sxs-lookup"><span data-stu-id="37211-128">After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:</span></span>  
  
- <span data-ttu-id="37211-129">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="37211-129">Visual Studio</span></span>  
  
     <span data-ttu-id="37211-130">Visual Studio COM türleri bir tür kitaplığındaki bir derleme meta verileri otomatik olarak dönüştürür.</span><span class="sxs-lookup"><span data-stu-id="37211-130">Visual Studio automatically converts COM types in a type library to metadata in an assembly.</span></span> <span data-ttu-id="37211-131">Yönergeler için [nasıl yapılır: Tür kitaplıklarına başvurular ekleme](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="37211-131">For instructions, see [How to: Add References to Type Libraries](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md).</span></span>  
  
- [<span data-ttu-id="37211-132">Tür kitaplığı alma programı (Tlbimp.exe)</span><span class="sxs-lookup"><span data-stu-id="37211-132">Type Library Importer (Tlbimp.exe)</span></span>](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)  
  
     <span data-ttu-id="37211-133">Tür kitaplığı içeri Aktarıcı meta verileri elde edilen birlikte çalışma dosyasındaki ayarlamak için komut satırı seçenekleri sağlar, türleri, varolan bir tür kitaplığından içeri aktarır ve birlikte çalışma derlemesi ve bir ad alanı oluşturur.</span><span class="sxs-lookup"><span data-stu-id="37211-133">The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace.</span></span> <span data-ttu-id="37211-134">Yönergeler için [nasıl yapılır: Tür kitaplıklarından birlikte çalışma derlemeleri oluşturma](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="37211-134">For instructions, see [How to: Generate Interop Assemblies from Type Libraries](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md).</span></span>  
  
- <span data-ttu-id="37211-135"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> Sınıfı</span><span class="sxs-lookup"><span data-stu-id="37211-135"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class</span></span>  
  
     <span data-ttu-id="37211-136">Bu sınıfı coclass'ları ve arabirimler tür kitaplığında bir derleme içindeki meta verileri dönüştürmek için yöntemler sağlar.</span><span class="sxs-lookup"><span data-stu-id="37211-136">This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly.</span></span> <span data-ttu-id="37211-137">Bu, Tlbimp.exe aynı meta veri çıkışı üretir.</span><span class="sxs-lookup"><span data-stu-id="37211-137">It produces the same metadata output as Tlbimp.exe.</span></span> <span data-ttu-id="37211-138">Ancak, Tlbimp.exe, aksine <xref:System.Runtime.InteropServices.TypeLibConverter> sınıfı bir bellek içi tür kitaplığı için meta verileri dönüştürebilir.</span><span class="sxs-lookup"><span data-stu-id="37211-138">However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata.</span></span>  
  
- <span data-ttu-id="37211-139">Özel sarmalayıcılar</span><span class="sxs-lookup"><span data-stu-id="37211-139">Custom wrappers</span></span>  
  
     <span data-ttu-id="37211-140">Bir tür kitaplığı yok veya yanlış olduğunda, bir seçenek sınıfı veya arabirim tanımı yinelenen yönetilen kaynak kodunda oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="37211-140">When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code.</span></span> <span data-ttu-id="37211-141">Ardından kaynak kodunu bir derleme meta verileri oluşturmak için çalışma zamanını hedefleyen bir derleyici ile derleme.</span><span class="sxs-lookup"><span data-stu-id="37211-141">You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.</span></span>  
  
     <span data-ttu-id="37211-142">COM türleri manuel olarak tanımlamak için aşağıdaki öğeler erişiminiz olmalıdır:</span><span class="sxs-lookup"><span data-stu-id="37211-142">To define COM types manually, you must have access to the following items:</span></span>  
  
    - <span data-ttu-id="37211-143">Tanımlanan arabirimleri ve coclass'ları kesin açıklamaları.</span><span class="sxs-lookup"><span data-stu-id="37211-143">Precise descriptions of the coclasses and interfaces being defined.</span></span>  
  
    - <span data-ttu-id="37211-144">Bir derleyici gibi C# uygun .NET Framework sınıf tanımları oluşturabilen derleyici.</span><span class="sxs-lookup"><span data-stu-id="37211-144">A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.</span></span>  
  
    - <span data-ttu-id="37211-145">Tür kitaplığını derlemeye dönüştürme kurallarını bilgi.</span><span class="sxs-lookup"><span data-stu-id="37211-145">Knowledge of the type library-to-assembly conversion rules.</span></span>  
  
     <span data-ttu-id="37211-146">Özel bir sarmalayıcı yazma Gelişmiş bir tekniktir.</span><span class="sxs-lookup"><span data-stu-id="37211-146">Writing a custom wrapper is an advanced technique.</span></span> <span data-ttu-id="37211-147">Özel bir sarmalayıcı oluşturmak hakkında ek bilgi için bkz. [standart sarmalayıcıları özelleştirme](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="37211-147">For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span></span>  
  
 <span data-ttu-id="37211-148">COM birlikte çalışma içeri aktarma işlemi hakkında daha fazla bilgi için bkz: [tür kitaplığını derlemeye dönüştürme özeti](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="37211-148">For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="37211-149">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="37211-149">See also</span></span>

- <xref:System.Runtime.InteropServices.TypeLibConverter>
- [<span data-ttu-id="37211-150">COM Bileşenlerini .NET Framework'te Gösterme</span><span class="sxs-lookup"><span data-stu-id="37211-150">Exposing COM Components to the .NET Framework</span></span>](../../../docs/framework/interop/exposing-com-components.md)
- <span data-ttu-id="37211-151">[Tür kitaplığını derlemeye dönüştürme özeti](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="37211-151">[Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span></span>
- [<span data-ttu-id="37211-152">Tlbimp.exe (Tür Kitaplığı İçeri Aktarıcı)</span><span class="sxs-lookup"><span data-stu-id="37211-152">Tlbimp.exe (Type Library Importer)</span></span>](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)
- <span data-ttu-id="37211-153">[Standart sarmalayıcıları özelleştirme](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="37211-153">[Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span></span>
- <span data-ttu-id="37211-154">[Yönetilen kodda COM türlerini kullanma](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="37211-154">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="37211-155">Birlikte Çalışma Projesi Derleme</span><span class="sxs-lookup"><span data-stu-id="37211-155">Compiling an Interop Project</span></span>](../../../docs/framework/interop/compiling-an-interop-project.md)
- [<span data-ttu-id="37211-156">Birlikte Çalışma Uygulamasını Dağıtma</span><span class="sxs-lookup"><span data-stu-id="37211-156">Deploying an Interop Application</span></span>](../../../docs/framework/interop/deploying-an-interop-application.md)
- [<span data-ttu-id="37211-157">Nasıl yapılır: Tür kitaplıklarına başvurular ekleme</span><span class="sxs-lookup"><span data-stu-id="37211-157">How to: Add References to Type Libraries</span></span>](../../../docs/framework/interop/how-to-add-references-to-type-libraries.md)
- [<span data-ttu-id="37211-158">Nasıl yapılır: Tür kitaplıklarından birlikte çalışma derlemeleri oluşturma</span><span class="sxs-lookup"><span data-stu-id="37211-158">How to: Generate Interop Assemblies from Type Libraries</span></span>](../../../docs/framework/interop/how-to-generate-interop-assemblies-from-type-libraries.md)
