---
title: C# zaman uyumsuz programlama
description: Genel bir bakış C# await, görev ve görev kullanarak zaman uyumsuz, zaman uyumsuz programlama için dil desteği<T>
ms.date: 03/18/2019
ms.openlocfilehash: a306ff75357f9f61ec9b086485472d99de5ad083
ms.sourcegitcommit: a970268118ea61ce14207e0916e17243546a491f
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 06/21/2019
ms.locfileid: "67307134"
---
# <a name="the-task-asynchronous-programming-model-in-c"></a><span data-ttu-id="26b56-103">Görev zaman uyumsuz programlama modeli C\#</span><span class="sxs-lookup"><span data-stu-id="26b56-103">The Task asynchronous programming model in C\#</span></span>

<span data-ttu-id="26b56-104">Görev zaman uyumsuz programlama modeli (TAP) zaman uyumsuz kod bir Özet sağlar.</span><span class="sxs-lookup"><span data-stu-id="26b56-104">The Task asynchronous programming model (TAP) provides an abstraction over asynchronous code.</span></span> <span data-ttu-id="26b56-105">Deyimler, olduğu gibi her zaman bir dizisi olarak kodunu yazın.</span><span class="sxs-lookup"><span data-stu-id="26b56-105">You write code as a sequence of statements, just like always.</span></span> <span data-ttu-id="26b56-106">Sonraki başlamadan önce her deyimi tamamlar ancak bu kodu okuyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-106">You can read that code as though each statement completes before the next begins.</span></span> <span data-ttu-id="26b56-107">Bu deyimleri bazıları iş Başlat ve dönüş çünkü derleyici bir dizi dönüşümleri gerçekleştirir bir <xref:System.Threading.Tasks.Task> , devam eden çalışmayı temsil eder.</span><span class="sxs-lookup"><span data-stu-id="26b56-107">The compiler performs a number of transformations because some of those statements may start work and return a <xref:System.Threading.Tasks.Task> that represents the ongoing work.</span></span>

<span data-ttu-id="26b56-108">Bu söz dizimi amacı olan: kod, bir dizi ifadeleri gibi okumaktadır, ancak dış kaynak tahsisine dayalı olarak çok daha karmaşık bir sırayla yürütür ve görevleri tamamlandığında etkinleştirin.</span><span class="sxs-lookup"><span data-stu-id="26b56-108">That's the goal of this syntax: enable code that reads like a sequence of statements, but executes in a much more complicated order based on external resource allocation and when tasks complete.</span></span> <span data-ttu-id="26b56-109">Kişilerin ne zaman uyumsuz görevler içeren işlemler için yönergeler vermek benzerdir.</span><span class="sxs-lookup"><span data-stu-id="26b56-109">It's analogous to how people give instructions for processes that include asynchronous tasks.</span></span> <span data-ttu-id="26b56-110">Bu makale boyunca yönergeleri örneği görmek için bir kahvaltı yapmak için kullanacağınız nasıl `async` ve `await` anahtar sözcükleri zaman uyumsuz yönergeler bir dizi içeren kod hakkında nedeni kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="26b56-110">Throughout this article, you'll use an example of instructions for making a breakfast to see how the `async` and `await` keywords make it easier to reason about code that includes a series of asynchronous instructions.</span></span> <span data-ttu-id="26b56-111">Aşağıdakine benzer bir kahvaltı yapma açıklamak için aşağıdaki listeyi yönergeleri yazmalısınız:</span><span class="sxs-lookup"><span data-stu-id="26b56-111">You'd write the instructions something like the following list to explain how to make a breakfast:</span></span>

1. <span data-ttu-id="26b56-112">Kahve dök.</span><span class="sxs-lookup"><span data-stu-id="26b56-112">Pour a cup of coffee.</span></span>
1. <span data-ttu-id="26b56-113">Bir kaydırma ısı ve ardından iki örneğin sucuklu fry.</span><span class="sxs-lookup"><span data-stu-id="26b56-113">Heat up a pan, then fry two eggs.</span></span>
1. <span data-ttu-id="26b56-114">Üç dilimleri bacon fry.</span><span class="sxs-lookup"><span data-stu-id="26b56-114">Fry three slices of bacon.</span></span>
1. <span data-ttu-id="26b56-115">Ekmekler iki parça kutlayın.</span><span class="sxs-lookup"><span data-stu-id="26b56-115">Toast two pieces of bread.</span></span>
1. <span data-ttu-id="26b56-116">Bildirim için ezmesi ve Başınızı ekleyin.</span><span class="sxs-lookup"><span data-stu-id="26b56-116">Add butter and jam to the toast.</span></span>
1. <span data-ttu-id="26b56-117">Bir cam Portakal suyu, dök.</span><span class="sxs-lookup"><span data-stu-id="26b56-117">Pour a glass of orange juice.</span></span>

<span data-ttu-id="26b56-118">Deneyimi Aşçılık ile varsa, bu yönergeleri yürütülür **zaman uyumsuz olarak**.</span><span class="sxs-lookup"><span data-stu-id="26b56-118">If you have experience with cooking, you'd execute those instructions **asynchronously**.</span></span> <span data-ttu-id="26b56-119">Örneğin sucuklu için kaydırma hazırlanıyor Başlat sonra bacon başlatın.</span><span class="sxs-lookup"><span data-stu-id="26b56-119">You'd start warming the pan for eggs, then start the bacon.</span></span> <span data-ttu-id="26b56-120">İçinde toaster ekmek put sonra Örneğin sucuklu başlatın.</span><span class="sxs-lookup"><span data-stu-id="26b56-120">You'd put the bread in the toaster, then start the eggs.</span></span> <span data-ttu-id="26b56-121">İşlemin her adımında bir görev başlatın ardından dikkatinizi dinlediğiniz için hazır olan görevleri açmak.</span><span class="sxs-lookup"><span data-stu-id="26b56-121">At each step of the process, you'd start a task, then turn your attention to tasks that are ready for your attention.</span></span>

<span data-ttu-id="26b56-122">Kahvaltı Aşçılık, paralel olmayan zaman uyumsuz iş iyi bir örnektir.</span><span class="sxs-lookup"><span data-stu-id="26b56-122">Cooking breakfast is a good example of asynchronous work that isn't parallel.</span></span> <span data-ttu-id="26b56-123">Bu görevleri tek bir kişi (veya iş parçacığı) işleyebilir.</span><span class="sxs-lookup"><span data-stu-id="26b56-123">One person (or thread) can handle all these tasks.</span></span> <span data-ttu-id="26b56-124">Kahvaltı benzerliği devam, tek bir kişi kahvaltı zaman uyumsuz olarak ilk tamamlanmadan önce sonraki görev başlatarak yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-124">Continuing the breakfast analogy, one person can make breakfast asynchronously by starting the next task before the first completes.</span></span> <span data-ttu-id="26b56-125">Birisi izliyor olup olmadığını Aşçılık ilerler.</span><span class="sxs-lookup"><span data-stu-id="26b56-125">The cooking progresses whether or not someone is watching it.</span></span> <span data-ttu-id="26b56-126">Örneğin sucuklu için kaydırma hazırlanıyor başlar başlamaz, bacon frying başlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-126">As soon as you start warming the pan for the eggs, you can begin frying the bacon.</span></span> <span data-ttu-id="26b56-127">Bir kez bacon başladığında, ekmek toaster koyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-127">Once the bacon starts, you can put the bread into the toaster.</span></span>

<span data-ttu-id="26b56-128">Bir paralel algoritma için birden çok aşçılarına (veya iş parçacığı) gerekir.</span><span class="sxs-lookup"><span data-stu-id="26b56-128">For a parallel algorithm, you'd need multiple cooks (or threads).</span></span> <span data-ttu-id="26b56-129">Örneğin sucuklu oluşturmak bir bacon ve benzeri.</span><span class="sxs-lookup"><span data-stu-id="26b56-129">One would make the eggs, one the bacon, and so on.</span></span> <span data-ttu-id="26b56-130">Her biri, bir görev için odaklanmış.</span><span class="sxs-lookup"><span data-stu-id="26b56-130">Each one would be focused on just that one task.</span></span> <span data-ttu-id="26b56-131">Her cook (veya iş parçacığı) zaman uyumlu olarak bacon ters çevirmek hazır olması ya da açılan için bildirim için bekleyen engellenebilir.</span><span class="sxs-lookup"><span data-stu-id="26b56-131">Each cook (or thread) would be blocked synchronously waiting for bacon to be ready to flip, or the toast to pop.</span></span> 

<span data-ttu-id="26b56-132">Şimdi, olarak yazılan bu yönergeleri göz önünde bulundurun C# ifadeleri:</span><span class="sxs-lookup"><span data-stu-id="26b56-132">Now, consider those same instructions written as C# statements:</span></span>

[!code-csharp[SynchronousBreakfast](~/samples/snippets/csharp/tour-of-async/AsyncBreakfast-starter/Program.cs#Main)]

<span data-ttu-id="26b56-133">Bilgisayarlar, aynı şekilde yaptığı bu yönergeleri yorumlar yok.</span><span class="sxs-lookup"><span data-stu-id="26b56-133">Computers don't interpret those instructions the same way people do.</span></span> <span data-ttu-id="26b56-134">Sonraki deyimi geçmeden önce iş tamamlanana kadar bilgisayar her deyim engeller.</span><span class="sxs-lookup"><span data-stu-id="26b56-134">The computer will block on each statement until the work is complete before moving on to the next statement.</span></span> <span data-ttu-id="26b56-135">Bir unsatisfying kahvaltı oluşturur.</span><span class="sxs-lookup"><span data-stu-id="26b56-135">That creates an unsatisfying breakfast.</span></span> <span data-ttu-id="26b56-136">Sonraki görevlerde, önceki görevlerden tamamlamadığı kadar çalışmaya mıydı.</span><span class="sxs-lookup"><span data-stu-id="26b56-136">The later tasks wouldn't be started until the earlier tasks had completed.</span></span> <span data-ttu-id="26b56-137">Kahvaltı oluşturmak için daha uzun sürer ve bazı öğeler hizmet önce soğuk edindiğiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-137">It would take much longer to create the breakfast, and some items would have gotten cold before being served.</span></span> 

<span data-ttu-id="26b56-138">Yukarıdaki yönergeleri zaman uyumsuz olarak yürütmek için bilgisayar istiyorsanız, zaman uyumsuz kod yazmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="26b56-138">If you want the computer to execute the above instructions asynchronously, you must write asynchronous code.</span></span>

<span data-ttu-id="26b56-139">Bu sorunlar, bugün yazma programları için önemlidir.</span><span class="sxs-lookup"><span data-stu-id="26b56-139">These concerns are important for the programs you write today.</span></span> <span data-ttu-id="26b56-140">İstemci programları yazdığınızda, kullanıcı girişine yanıt olarak UI istersiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-140">When you write client programs, you want the UI to be responsive to user input.</span></span> <span data-ttu-id="26b56-141">Uygulamanızı bir telefon Web'den veri yüklenirken dondurulmuş görünür hale olmamalıdır.</span><span class="sxs-lookup"><span data-stu-id="26b56-141">Your application shouldn't make a phone appear frozen while it's downloading data from the web.</span></span> <span data-ttu-id="26b56-142">Sunucu programlarından yazdığınızda, engellenen iş parçacıkları istemezsiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-142">When you write server programs, you don't want threads blocked.</span></span> <span data-ttu-id="26b56-143">Bu iş parçacıkları, diğer isteklerine hizmet.</span><span class="sxs-lookup"><span data-stu-id="26b56-143">Those threads could be serving other requests.</span></span> <span data-ttu-id="26b56-144">Zaman uyumsuz seçenekler varken zaman uyumlu bir kod kullanarak küçük expensively ölçeklendirme olanağı gelmez.</span><span class="sxs-lookup"><span data-stu-id="26b56-144">Using synchronous code when asynchronous alternatives exist hurts your ability to scale out less expensively.</span></span> <span data-ttu-id="26b56-145">Bu engellenen iş parçacıkları için ödeme yaparsınız.</span><span class="sxs-lookup"><span data-stu-id="26b56-145">You pay for those blocked threads.</span></span>

<span data-ttu-id="26b56-146">Başarılı modern uygulamalar, zaman uyumsuz kod gerektirir.</span><span class="sxs-lookup"><span data-stu-id="26b56-146">Successful modern applications require asynchronous code.</span></span> <span data-ttu-id="26b56-147">Dil desteği olmadan geri çağırmaları, tamamlama veya özgün kodun amacı engellediği başka bir yolla zaman uyumsuz kod yazma gereklidir.</span><span class="sxs-lookup"><span data-stu-id="26b56-147">Without language support, writing asynchronous code required callbacks, completion events, or other means that obscured the original intent of the code.</span></span> <span data-ttu-id="26b56-148">Zaman uyumlu bir kod avantajlarından anlaşılması kolay olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="26b56-148">The advantage of the synchronous code is that it's easy to understand.</span></span> <span data-ttu-id="26b56-149">Adım adım eylemleri tarama ve anlaşılmasını kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="26b56-149">The step-by-step actions make it easy to scan and understand.</span></span> <span data-ttu-id="26b56-150">Geleneksel zaman uyumsuz modeller, odağı zorla zaman uyumsuz kod yapısını, kodun temel eylemleri üzerinde değil.</span><span class="sxs-lookup"><span data-stu-id="26b56-150">Traditional asynchronous models forced you to focus on the asynchronous nature of the code, not on the fundamental actions of the code.</span></span>

## <a name="dont-block-await-instead"></a><span data-ttu-id="26b56-151">Engelleme, bunun yerine await yok</span><span class="sxs-lookup"><span data-stu-id="26b56-151">Don't block, await instead</span></span>

<span data-ttu-id="26b56-152">Yukarıdaki kod, hatalı bir uygulama gösterilmektedir: zaman uyumsuz işlemleri gerçekleştirmek için zaman uyumlu kod oluşturma.</span><span class="sxs-lookup"><span data-stu-id="26b56-152">The preceding code demonstrates a bad practice: constructing synchronous code to perform asynchronous operations.</span></span> <span data-ttu-id="26b56-153">Bu kod, yazıldığı gibi herhangi bir iş yapmasını yürütme iş parçacığını engeller.</span><span class="sxs-lookup"><span data-stu-id="26b56-153">As written, this code blocks the thread executing it from doing any other work.</span></span> <span data-ttu-id="26b56-154">Görevlerden herhangi birini devam ederken durdurulmayacaktır.</span><span class="sxs-lookup"><span data-stu-id="26b56-154">It won't be interrupted while any of the tasks are in progress.</span></span> <span data-ttu-id="26b56-155">Ekmekler koymaya sonra toaster stared gibi sorgulamanıza olacaktır.</span><span class="sxs-lookup"><span data-stu-id="26b56-155">It would be as though you stared at the toaster after putting the bread in.</span></span> <span data-ttu-id="26b56-156">Herkes bildirim POP kadar size Konuşmayı yoksay.</span><span class="sxs-lookup"><span data-stu-id="26b56-156">You'd ignore anyone talking to you until the toast popped.</span></span> 

<span data-ttu-id="26b56-157">Görevler çalışırken iş parçacığını engellemez, böylece bu kodu güncelleştirerek başlayalım.</span><span class="sxs-lookup"><span data-stu-id="26b56-157">Let's start by updating this code so that the thread doesn't block while tasks are running.</span></span> <span data-ttu-id="26b56-158">`await` Anahtar sözcüğü, bir görev başlatır ve ardından o görev tamamlandıktan sonra yürütmeye devam etmek için engelleyici olmayan bir yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="26b56-158">The `await` keyword provides a non-blocking way to start a task, then continue execution when that task completes.</span></span> <span data-ttu-id="26b56-159">Basit bir zaman uyumsuz yap sürümü kahvaltı kodu aşağıdaki kod parçacığı gibi görünür:</span><span class="sxs-lookup"><span data-stu-id="26b56-159">A simple asynchronous version of the make a breakfast code would look like the following snippet:</span></span>

[!code-csharp[SimpleAsyncBreakfast](~/samples/snippets/csharp/tour-of-async/AsyncBreakfast-V2/Program.cs#Main)]

<span data-ttu-id="26b56-160">Bu kod, örneğin sucuklu veya bacon Aşçılık sırada engellemez.</span><span class="sxs-lookup"><span data-stu-id="26b56-160">This code doesn't block while the eggs or the bacon are cooking.</span></span> <span data-ttu-id="26b56-161">Bu kod, ancak herhangi bir görevi başlatılmaz.</span><span class="sxs-lookup"><span data-stu-id="26b56-161">This code won't start any other tasks though.</span></span> <span data-ttu-id="26b56-162">Yine de bildirim içinde toaster yerleştirin ve onu POP kadar adresinden stare.</span><span class="sxs-lookup"><span data-stu-id="26b56-162">You'd still put the toast in the toaster and stare at it until it pops.</span></span> <span data-ttu-id="26b56-163">Ancak, en azından, ilgilenmenizi istediği herkes yanıtlamayı ister.</span><span class="sxs-lookup"><span data-stu-id="26b56-163">But at least, you'd respond to anyone that wanted your attention.</span></span> <span data-ttu-id="26b56-164">İlk tarifinizi sırada birden çok sipariş yerleştirildiği bir restoran başka bir kahvaltı cook başlatabilir.</span><span class="sxs-lookup"><span data-stu-id="26b56-164">In a restaurant where multiple orders are placed, the cook could start another breakfast while the first is cooking.</span></span>

<span data-ttu-id="26b56-165">Şimdi, kahvaltı üzerinde çalışan iş parçacığı henüz tamamlanmadı başlatılan tüm görev beklerken bloke değildir.</span><span class="sxs-lookup"><span data-stu-id="26b56-165">Now, the thread working on the breakfast isn't blocked while awaiting any started task that hasn't yet finished.</span></span> <span data-ttu-id="26b56-166">Bazı uygulamalar için bu değişiklik tüm gereken kullanılır.</span><span class="sxs-lookup"><span data-stu-id="26b56-166">For some applications, this change is all that's needed.</span></span> <span data-ttu-id="26b56-167">Bu değişikliği yalnızca kullanıcıya bir GUI uygulama hala yanıt verir.</span><span class="sxs-lookup"><span data-stu-id="26b56-167">A GUI application still responds to the user with just this change.</span></span> <span data-ttu-id="26b56-168">Ancak, bu senaryo için daha fazla istersiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-168">However, for this scenario, you want more.</span></span> <span data-ttu-id="26b56-169">Her bileşen görevleri sırayla yürütülen istemezsiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-169">You don't want each of the component tasks to be executed sequentially.</span></span> <span data-ttu-id="26b56-170">Bileşen görevlerin her biri önceki görevin tamamlanmasını bekleme önce başlatmak daha iyidir.</span><span class="sxs-lookup"><span data-stu-id="26b56-170">It's better to start each of the component tasks before awaiting the previous task's completion.</span></span>

## <a name="start-tasks-concurrently"></a><span data-ttu-id="26b56-171">Eşzamanlı olarak başlangıç görevleri</span><span class="sxs-lookup"><span data-stu-id="26b56-171">Start tasks concurrently</span></span>

<span data-ttu-id="26b56-172">Birçok senaryoda birkaç bağımsız görev hemen başlamak istiyorsanız.</span><span class="sxs-lookup"><span data-stu-id="26b56-172">In many scenarios, you want to start several independent tasks immediately.</span></span> <span data-ttu-id="26b56-173">Ardından, her görev bittikçe hazır olan başka bir iş devam edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-173">Then, as each task finishes, you can continue other work that's ready.</span></span> <span data-ttu-id="26b56-174">Kahvaltı benzerleme daha hızlı bir şekilde bitti kahvaltı nasıl ulaşabileceğinizi olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="26b56-174">In the breakfast analogy, that's how you get breakfast done more quickly.</span></span> <span data-ttu-id="26b56-175">Her şey bitti ayrıca Al aynı anda yakın.</span><span class="sxs-lookup"><span data-stu-id="26b56-175">You also get everything done close to the same time.</span></span> <span data-ttu-id="26b56-176">Sık erişimli kahvaltı elde edersiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-176">You'll get a hot breakfast.</span></span>

<span data-ttu-id="26b56-177"><xref:System.Threading.Tasks.Task?displayProperty=nameWithType> Ve ilişkili sınıflar nedeni, sürmekte olan görevler hakkında için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-177">The <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> and related types are classes you can use to reason about tasks that are in progress.</span></span> <span data-ttu-id="26b56-178">Aslında kahvaltı oluşturacak şekilde daha yakından benzeyen bir kod yazmanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="26b56-178">That enables you to write code that more closely resembles the way you'd actually create breakfast.</span></span> <span data-ttu-id="26b56-179">Örneğin sucuklu bacon ve bildirim aynı anda Aşçılık başlar.</span><span class="sxs-lookup"><span data-stu-id="26b56-179">You'd start cooking the eggs, bacon, and toast at the same time.</span></span> <span data-ttu-id="26b56-180">Her eylem gerektirdiğinden, dikkatinizi görev açın, sonraki eylemi ilgileniriz sonra başka bir şey ilgilenmenizi gerektiren await.</span><span class="sxs-lookup"><span data-stu-id="26b56-180">As each requires action, you'd turn your attention to that task, take care of the next action, then await for something else that requires your attention.</span></span>

<span data-ttu-id="26b56-181">Bir görevi başlatıp oturum tutun <xref:System.Threading.Tasks.Task> işi temsil eden nesne.</span><span class="sxs-lookup"><span data-stu-id="26b56-181">You start a task and hold on to the <xref:System.Threading.Tasks.Task> object that represents the work.</span></span> <span data-ttu-id="26b56-182">Artıracaksınız `await` her görev kendi sonucu ile çalışmaya başlamadan önce.</span><span class="sxs-lookup"><span data-stu-id="26b56-182">You'll `await` each task before working with its result.</span></span>

<span data-ttu-id="26b56-183">Bu değişiklikler kahvaltı koda olalım.</span><span class="sxs-lookup"><span data-stu-id="26b56-183">Let's make these changes to the breakfast code.</span></span> <span data-ttu-id="26b56-184">İlk adım, bunları bekleyen yerine bunların başlattığınızda işlemleri için görevleri depolamaktır:</span><span class="sxs-lookup"><span data-stu-id="26b56-184">The first step is to store the tasks for operations when they start, rather than awaiting them:</span></span>

```csharp
Coffee cup = PourCoffee();
Console.WriteLine("coffee is ready");
Task<Egg> eggTask = FryEggs(2);
Egg eggs = await eggTask;
Console.WriteLine("eggs are ready");
Task<Bacon> baconTask = FryBacon(3);
Bacon bacon = await baconTask;
Console.WriteLine("bacon is ready");
Task<Toast> toastTask = ToastBread(2);
Toast toast = await toastTask;
ApplyButter(toast);
ApplyJam(toast);
Console.WriteLine("toast is ready");
Juice oj = PourOJ();
Console.WriteLine("oj is ready");

Console.WriteLine("Breakfast is ready!");
```

<span data-ttu-id="26b56-185">Ardından, taşımak `await` kahvaltı tanıtıcısıyla önce deyimleri, yöntemin sonuna Yumurta ve bacon için:</span><span class="sxs-lookup"><span data-stu-id="26b56-185">Next, you can move the `await` statements for the bacon and eggs to the end of the method, before serving breakfast:</span></span>

```csharp
Coffee cup = PourCoffee();
Console.WriteLine("coffee is ready");
Task<Egg> eggTask = FryEggs(2);
Task<Bacon> baconTask = FryBacon(3);
Task<Toast> toastTask = ToastBread(2);
Toast toast = await toastTask;
ApplyButter(toast);
ApplyJam(toast);
Console.WriteLine("toast is ready");
Juice oj = PourOJ();
Console.WriteLine("oj is ready");

Egg eggs = await eggTask;
Console.WriteLine("eggs are ready");
Bacon bacon = await baconTask;
Console.WriteLine("bacon is ready");

Console.WriteLine("Breakfast is ready!");
```

<span data-ttu-id="26b56-186">Yukarıdaki kod daha iyi çalışır.</span><span class="sxs-lookup"><span data-stu-id="26b56-186">The preceding code works better.</span></span> <span data-ttu-id="26b56-187">Zaman uyumsuz görevlerin tümü aynı anda başlatın.</span><span class="sxs-lookup"><span data-stu-id="26b56-187">You start all the asynchronous tasks at once.</span></span> <span data-ttu-id="26b56-188">Sonuçları yalnızca ihtiyacınız olduğunda her görev bekler.</span><span class="sxs-lookup"><span data-stu-id="26b56-188">You await each task only when you need the results.</span></span> <span data-ttu-id="26b56-189">Yukarıdaki kod, farklı mikro isteği yapan ve ardından sonuçları birleştirir tek bir sayfada bir web uygulamasındaki kod benzer olabilir.</span><span class="sxs-lookup"><span data-stu-id="26b56-189">The preceding code may be similar to code in a web application that makes requests of different microservices, then combines the results into a single page.</span></span> <span data-ttu-id="26b56-190">Tüm istekleri hemen sonra yapacaksınız `await` olan tüm görevleri ve web sayfası oluşturun.</span><span class="sxs-lookup"><span data-stu-id="26b56-190">You'll make all the requests immediately, then `await` all those tasks and compose the web page.</span></span>

## <a name="composition-with-tasks"></a><span data-ttu-id="26b56-191">Görevler oluşturma</span><span class="sxs-lookup"><span data-stu-id="26b56-191">Composition with tasks</span></span>

 <span data-ttu-id="26b56-192">Bildirim dışında aynı anda kahvaltı hazır her şeye sahip.</span><span class="sxs-lookup"><span data-stu-id="26b56-192">You have everything ready for breakfast at the same time except the toast.</span></span> <span data-ttu-id="26b56-193">Bildirim zaman uyumsuz bir işlem (ekmek toasting) ve zaman uyumlu işlemler (ezmesi ve Başınızı ekleme) olarak sunuluyor.</span><span class="sxs-lookup"><span data-stu-id="26b56-193">Making the toast is the composition of an asynchronous operation (toasting the bread), and synchronous operations (adding the butter and the jam).</span></span> <span data-ttu-id="26b56-194">Bu kod güncelleştirme bir önemli kavramı gösterir:</span><span class="sxs-lookup"><span data-stu-id="26b56-194">Updating this code illustrates an important concept:</span></span>

> [!IMPORTANT]
> <span data-ttu-id="26b56-195">Zaman uyumlu iş tarafından izlenen zaman uyumsuz bir işlem olarak bir zaman uyumsuz bir işlemdir.</span><span class="sxs-lookup"><span data-stu-id="26b56-195">The composition of an asynchronous operation followed by synchronous work is an asynchronous operation.</span></span> <span data-ttu-id="26b56-196">Başka bir deyişle, belirtilen zaman uyumsuz bir işlemi herhangi bir kısmını ise, tüm zaman uyumsuz bir işlemdir.</span><span class="sxs-lookup"><span data-stu-id="26b56-196">Stated another way, if any portion of an operation is asynchronous, the entire operation is asynchronous.</span></span>

<span data-ttu-id="26b56-197">Yukarıdaki kod, kullanabileceğiniz gösterdi <xref:System.Threading.Tasks.Task> veya <xref:System.Threading.Tasks.Task%601> çalışmakta olan görevlerin tutacak nesne.</span><span class="sxs-lookup"><span data-stu-id="26b56-197">The preceding code showed you that you can use <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> objects to hold running tasks.</span></span> <span data-ttu-id="26b56-198">`await` Her görev kendi sonucu kullanmadan önce.</span><span class="sxs-lookup"><span data-stu-id="26b56-198">You `await` each task before using its result.</span></span> <span data-ttu-id="26b56-199">Sonraki adım, diğer iş bileşimini temsil eden yöntemleri oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="26b56-199">The next step is to create methods that represent the combination of other work.</span></span> <span data-ttu-id="26b56-200">Kahvaltı sunmadan önce ezmesi ve Başınızı eklemeden önce ekmek toasting temsil eden görev await istersiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-200">Before serving breakfast, you want to await the task that represents toasting the bread before adding butter and jam.</span></span> <span data-ttu-id="26b56-201">Aşağıdaki kod ile çalışan temsil edebilir:</span><span class="sxs-lookup"><span data-stu-id="26b56-201">You can represent that work with the following code:</span></span>

[!code-csharp[ComposeToastTask](~/samples/snippets/csharp/tour-of-async/AsyncBreakfast-V3/Program.cs#ComposeToastTask)]

<span data-ttu-id="26b56-202">Önceki yöntem sahip `async` imzası değiştiricisi.</span><span class="sxs-lookup"><span data-stu-id="26b56-202">The preceding method has the `async` modifier in its signature.</span></span> <span data-ttu-id="26b56-203">Bu sinyalleri için derleyici bu yöntemini içeren bir `await` deyimi; zaman uyumsuz işlemleri içerir.</span><span class="sxs-lookup"><span data-stu-id="26b56-203">That signals to the compiler that this method contains an `await` statement; it contains asynchronous operations.</span></span> <span data-ttu-id="26b56-204">Bu yöntem ekmek toasts sonra ezmesi ve Başınızı ekler görevi temsil eder.</span><span class="sxs-lookup"><span data-stu-id="26b56-204">This method represents the task that toasts the bread, then adds butter and jam.</span></span> <span data-ttu-id="26b56-205">Bu yöntem döndürür bir <xref:System.Threading.Tasks.Task%601> , bu üç işlemi olarak temsil eder.</span><span class="sxs-lookup"><span data-stu-id="26b56-205">This method returns a <xref:System.Threading.Tasks.Task%601> that represents the composition of those three operations.</span></span> <span data-ttu-id="26b56-206">Artık kod ana blok olur:</span><span class="sxs-lookup"><span data-stu-id="26b56-206">The main block of code now becomes:</span></span>

[!code-csharp[StartConcurrentTasks](~/samples/snippets/csharp/tour-of-async/AsyncBreakfast-V3/Program.cs#Main)]

<span data-ttu-id="26b56-207">Önceki değişiklik, zaman uyumsuz kod ile çalışmak için önemli bir teknik gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="26b56-207">The previous change illustrated an important technique for working with asynchronous code.</span></span> <span data-ttu-id="26b56-208">Görevler, bir görev döndüren yeni bir yöntem işlemlere ayrılarak oluşturun.</span><span class="sxs-lookup"><span data-stu-id="26b56-208">You compose tasks by separating the operations into a new method that returns a task.</span></span> <span data-ttu-id="26b56-209">Bu görevi beklemek ne zaman seçebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-209">You can choose when to await that task.</span></span> <span data-ttu-id="26b56-210">Eşzamanlı olarak başka görevler başlatabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="26b56-210">You can start other tasks concurrently.</span></span>

## <a name="await-tasks-efficiently"></a><span data-ttu-id="26b56-211">Görevleri verimli bir şekilde await</span><span class="sxs-lookup"><span data-stu-id="26b56-211">Await tasks efficiently</span></span>

<span data-ttu-id="26b56-212">Dizi `await` sonunda, yukarıdaki kod deyimlerini geliştirilmiş yöntemleri kullanılarak `Task` sınıfı.</span><span class="sxs-lookup"><span data-stu-id="26b56-212">The series of `await` statements at the end of the preceding code can be improved by using methods of the `Task` class.</span></span> <span data-ttu-id="26b56-213">Bu API'leri biri <xref:System.Threading.Tasks.Task.WhenAll%2A>, döndüren bir <xref:System.Threading.Tasks.Task> tamamlanan kendi bağımsız değişken listesindeki tüm görevleri tamamladıktan sonra aşağıdaki kodda gösterildiği gibi:</span><span class="sxs-lookup"><span data-stu-id="26b56-213">One of those APIs is <xref:System.Threading.Tasks.Task.WhenAll%2A>, which returns a <xref:System.Threading.Tasks.Task> that completes when all the tasks in its argument list have completed, as shown in the following code:</span></span>

```csharp
await Task.WhenAll(eggTask, baconTask, toastTask);
Console.WriteLine("eggs are ready");
Console.WriteLine("bacon is ready");
Console.WriteLine("toast is ready");
Console.WriteLine("Breakfast is ready!");
```

<span data-ttu-id="26b56-214">Başka bir seçenek kullanmaktır <xref:System.Threading.Tasks.Task.WhenAny%2A>, döndüren bir `Task<Task>` tamamlanan bağımsız değişkenlerinden biri tamamlar.</span><span class="sxs-lookup"><span data-stu-id="26b56-214">Another option is to use <xref:System.Threading.Tasks.Task.WhenAny%2A>, which returns a `Task<Task>` that completes when any of its arguments completes.</span></span> <span data-ttu-id="26b56-215">Zaten bitmiş bilerek döndürülen göreve await.</span><span class="sxs-lookup"><span data-stu-id="26b56-215">You can await the returned task, knowing that it has already finished.</span></span> <span data-ttu-id="26b56-216">Aşağıdaki kod nasıl kullanabileceğinizi gösterir <xref:System.Threading.Tasks.Task.WhenAny%2A> tamamlayın ve ardından sonucunu işlemek için ilk görevi beklemek için.</span><span class="sxs-lookup"><span data-stu-id="26b56-216">The following code shows how you could use <xref:System.Threading.Tasks.Task.WhenAny%2A> to await the first task to finish and then process its result.</span></span> <span data-ttu-id="26b56-217">Tamamlanan görevin sonucu işlendikten sonra tamamlanmış bir görevin geçirilen görevler listesinden kaldırmak `WhenAny`.</span><span class="sxs-lookup"><span data-stu-id="26b56-217">After processing the result from the completed task, you remove that completed task from the list of tasks passed to `WhenAny`.</span></span>

[!code-csharp[AwaitAnyTask](~/samples/snippets/csharp/tour-of-async/AsyncBreakfast-final/Program.cs#AwaitAnyTask)]

<span data-ttu-id="26b56-218">Tüm bu değişiklikler, son sürümü sonra `Main` şu kod gibi görünür:</span><span class="sxs-lookup"><span data-stu-id="26b56-218">After all those changes, the final version of `Main` looks like the following code:</span></span>

[!code-csharp[Final](~/samples/snippets/csharp/tour-of-async/AsyncBreakfast-final/Program.cs#Main)]

<span data-ttu-id="26b56-219">Bu son kod zaman uyumsuzdur.</span><span class="sxs-lookup"><span data-stu-id="26b56-219">This final code is asynchronous.</span></span> <span data-ttu-id="26b56-220">Daha doğru bir şekilde, bir kişinin bir kahvaltı nasıl cook yansıtır.</span><span class="sxs-lookup"><span data-stu-id="26b56-220">It more accurately reflects how a person would cook a breakfast.</span></span> <span data-ttu-id="26b56-221">Bu makalede ilk kod örneği önceki kodla karşılaştırın.</span><span class="sxs-lookup"><span data-stu-id="26b56-221">Compare the preceding code with the first code sample in this article.</span></span> <span data-ttu-id="26b56-222">Kod okumasını hala NET core eylemlerdir.</span><span class="sxs-lookup"><span data-stu-id="26b56-222">The core actions are still clear from reading the code.</span></span> <span data-ttu-id="26b56-223">Bu kod, bu makalenin başında bir kahvaltı yapmak için bu yönergeleri okuduğunuz aynı şekilde okuyabilir.</span><span class="sxs-lookup"><span data-stu-id="26b56-223">You can read this code the same way you'd read those instructions for making a breakfast at the beginning of this article.</span></span> <span data-ttu-id="26b56-224">Dil özellikleri için `async` ve `await` herkesin hale getirir bu yazılı yönergelere izlemek için çeviri sağlayın: oluşturabilir ve görevlerin tamamlanmasını beklerken engelleme gibi görevleri başlatın.</span><span class="sxs-lookup"><span data-stu-id="26b56-224">The language features for `async` and `await` provide the translation every person makes to follow those written instructions: start tasks as you can and don't block waiting for tasks to complete.</span></span>
