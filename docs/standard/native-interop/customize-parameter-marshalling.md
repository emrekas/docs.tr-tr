---
title: Özelleştirme parametre taşıma - .NET
description: .NET yerel gösterimine parametrelerinizi nasıl sürekliliğe devreder özelleştirmeyi öğrenin.
author: jkoritzinsky
ms.author: jekoritz
ms.date: 01/18/2019
ms.openlocfilehash: 7821da546e0ed0ab5fa97d00a638aa5cc1a3089c
ms.sourcegitcommit: b56d59ad42140d277f2acbd003b74d655fdbc9f1
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 01/19/2019
ms.locfileid: "54416251"
---
# <a name="customizing-parameter-marshalling"></a><span data-ttu-id="fbe13-103">Parametre taşıma özelleştirme</span><span class="sxs-lookup"><span data-stu-id="fbe13-103">Customizing parameter marshalling</span></span>

<span data-ttu-id="fbe13-104">.NET çalışma zamanının varsayılan parametre sıralama davranışını istediklerinizi yapmaz, kullanım kullanabilirsiniz <xref:System.Runtime.InteropServices.MarshalAsAttribute?displayProperty=nameWithType> parametrelerinizi nasıl sıralanmış özelleştirmek için özniteliği.</span><span class="sxs-lookup"><span data-stu-id="fbe13-104">When the .NET runtime's default parameter marshalling behavior doesn't do what you want, use can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute?displayProperty=nameWithType> attribute to customize how your parameters are marshaled.</span></span>

## <a name="customizing-string-parameters"></a><span data-ttu-id="fbe13-105">Dize parametreleri özelleştirme</span><span class="sxs-lookup"><span data-stu-id="fbe13-105">Customizing string parameters</span></span>

<span data-ttu-id="fbe13-106">.NET, çeşitli biçimlerde düzenleme dizeler için vardır.</span><span class="sxs-lookup"><span data-stu-id="fbe13-106">.NET has a variety of formats for marshalling strings.</span></span> <span data-ttu-id="fbe13-107">Bu yöntemler, C stili dizeler ve dize biçimleri Windows merkezli ayrı bölümlere ayrılır.</span><span class="sxs-lookup"><span data-stu-id="fbe13-107">These methods are split into distinct sections on C-style strings and Windows-centric string formats.</span></span>

### <a name="c-style-strings"></a><span data-ttu-id="fbe13-108">C stili dizeler</span><span class="sxs-lookup"><span data-stu-id="fbe13-108">C-Style strings</span></span>

<span data-ttu-id="fbe13-109">Her biri Bu biçimler yerel kod için null ile sonlandırılmış bir dize geçirir.</span><span class="sxs-lookup"><span data-stu-id="fbe13-109">Each of these formats passes a null-terminated string to native code.</span></span> <span data-ttu-id="fbe13-110">Bunlar, yerel dizesi kodlayarak farklılık gösterir.</span><span class="sxs-lookup"><span data-stu-id="fbe13-110">They differ by the encoding of the native string.</span></span>

| <span data-ttu-id="fbe13-111">`System.Runtime.InteropServices.UnmanagedType` Değer</span><span class="sxs-lookup"><span data-stu-id="fbe13-111">`System.Runtime.InteropServices.UnmanagedType` value</span></span> | <span data-ttu-id="fbe13-112">Encoding</span><span class="sxs-lookup"><span data-stu-id="fbe13-112">Encoding</span></span> |
|------------------------------------------------------|----------|
| <span data-ttu-id="fbe13-113">LPStr</span><span class="sxs-lookup"><span data-stu-id="fbe13-113">LPStr</span></span> | <span data-ttu-id="fbe13-114">ANSI</span><span class="sxs-lookup"><span data-stu-id="fbe13-114">ANSI</span></span> |
| <span data-ttu-id="fbe13-115">LPUTF8Str</span><span class="sxs-lookup"><span data-stu-id="fbe13-115">LPUTF8Str</span></span> | <span data-ttu-id="fbe13-116">UTF-8</span><span class="sxs-lookup"><span data-stu-id="fbe13-116">UTF-8</span></span> | 
| <span data-ttu-id="fbe13-117">LPWStr</span><span class="sxs-lookup"><span data-stu-id="fbe13-117">LPWStr</span></span> | <span data-ttu-id="fbe13-118">UTF-16</span><span class="sxs-lookup"><span data-stu-id="fbe13-118">UTF-16</span></span> |

<span data-ttu-id="fbe13-119"><xref:System.Runtime.InteropServices.UnmanagedType.VBByRefStr?displayProperty=nameWithType> Biçimi biraz farklıdır.</span><span class="sxs-lookup"><span data-stu-id="fbe13-119">The <xref:System.Runtime.InteropServices.UnmanagedType.VBByRefStr?displayProperty=nameWithType> format is slightly different.</span></span> <span data-ttu-id="fbe13-120">Gibi `LPWStr`, yerel C stili dizeyi UTF-16 kodlamalı dize sıralar.</span><span class="sxs-lookup"><span data-stu-id="fbe13-120">Like `LPWStr`, it marshals the string to a native C-style string encoded in UTF-16.</span></span> <span data-ttu-id="fbe13-121">Ancak, başvuruya göre dizesine geçmenizi yönetilen imzaya sahip ve eşleşen yerel imza dize değerine göre alır.</span><span class="sxs-lookup"><span data-stu-id="fbe13-121">However, the managed signature has you pass in the string by reference and the matching native signature takes the string by value.</span></span> <span data-ttu-id="fbe13-122">Bu ayrım değere göre bir dize alır ve değiştirdiği bir yerel API kullanmak üzere yerinde kullanmak zorunda kalmadan sağlar bir `StringBuilder`.</span><span class="sxs-lookup"><span data-stu-id="fbe13-122">This distinction allows you to use a native API that takes a string by value and modifies it in-place without having to use a `StringBuilder`.</span></span> <span data-ttu-id="fbe13-123">Eşleşmeyen yerel ve yönetilen imzalarla karışıklığa neden eğilimlidir olduğundan el ile şu biçimi kullanarak karşı öneririz.</span><span class="sxs-lookup"><span data-stu-id="fbe13-123">We recommend against manually using this format since it's prone to cause confusion with the mismatching native and managed signatures.</span></span>

### <a name="windows-centric-string-formats"></a><span data-ttu-id="fbe13-124">Windows merkezli dize biçimleri</span><span class="sxs-lookup"><span data-stu-id="fbe13-124">Windows-centric string formats</span></span>

<span data-ttu-id="fbe13-125">COM veya OLE arabirimleri ile etkileşim kurulurken, büyük olasılıkla yerel işlevleri dize olarak alın bulabilirsiniz `BSTR` bağımsız değişkenler.</span><span class="sxs-lookup"><span data-stu-id="fbe13-125">When interacting with COM or OLE interfaces, you'll likely find that the native functions take strings as `BSTR` arguments.</span></span> <span data-ttu-id="fbe13-126">Kullanabileceğiniz <xref:System.Runtime.InteropServices.UnmanagedType.BStr?displayProperty=nameWithType> türü bir dize olarak hazırlamak için yönetilmeyen bir `BSTR`.</span><span class="sxs-lookup"><span data-stu-id="fbe13-126">You can use the <xref:System.Runtime.InteropServices.UnmanagedType.BStr?displayProperty=nameWithType> unmanaged type to marshal a string as a `BSTR`.</span></span>

<span data-ttu-id="fbe13-127">WinRT API'lar ile etkileşim kurma, kullanabileceğiniz <xref:System.Runtime.InteropServices.UnmanagedType.HString?displayProperty=nameWithType> biçiminde bir dize olarak hazırlamak için bir `HSTRING`.</span><span class="sxs-lookup"><span data-stu-id="fbe13-127">If you're interacting with WinRT APIs, you can use the <xref:System.Runtime.InteropServices.UnmanagedType.HString?displayProperty=nameWithType> format to marshal a string as an `HSTRING`.</span></span>

## <a name="customizing-array-parameters"></a><span data-ttu-id="fbe13-128">Dizi parametreleri özelleştirme</span><span class="sxs-lookup"><span data-stu-id="fbe13-128">Customizing array parameters</span></span>

<span data-ttu-id="fbe13-129">.NET de sıralama dizi parametreleri için birden çok yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="fbe13-129">.NET also provides you multiple ways to marshal array parameters.</span></span> <span data-ttu-id="fbe13-130">Bir C tarzı dizi alan bir API arıyoruz kullanırsanız <xref:System.Runtime.InteropServices.UnmanagedType.LPArray?displayProperty=nameWithType> yönetilmeyen türü.</span><span class="sxs-lookup"><span data-stu-id="fbe13-130">If you're calling an API that takes a C-style array, use the <xref:System.Runtime.InteropServices.UnmanagedType.LPArray?displayProperty=nameWithType> unmanaged type.</span></span> <span data-ttu-id="fbe13-131">Dizideki değerleri, özelleştirilmiş taşıma gerekiyorsa, kullanabileceğiniz <xref:System.Runtime.InteropServices.MarshalAsAttribute.ArraySubType> alanını `[MarshalAs]` söz konusu öznitelik.</span><span class="sxs-lookup"><span data-stu-id="fbe13-131">If the values in the array need customized marshalling, you can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute.ArraySubType> field on the `[MarshalAs]` attribute for that.</span></span>

<span data-ttu-id="fbe13-132">COM API kullanıyorsanız, büyük olasılıkla, dizi parametreleri olarak sıralamanız gerekir `SAFEARRAY*`s.</span><span class="sxs-lookup"><span data-stu-id="fbe13-132">If you're using COM APIs, you'll likely have to marshal your array parameters as `SAFEARRAY*`s.</span></span> <span data-ttu-id="fbe13-133">Bunu yapmak için kullanabileceğiniz <xref:System.Runtime.InteropServices.UnmanagedType.SafeArray?displayProperty=nameWithType> yönetilmeyen türü.</span><span class="sxs-lookup"><span data-stu-id="fbe13-133">To do so, you can use the <xref:System.Runtime.InteropServices.UnmanagedType.SafeArray?displayProperty=nameWithType> unmanaged type.</span></span> <span data-ttu-id="fbe13-134">Varsayılan tür öğelerinin `SAFEARRAY` tablodaki görülebilir [özelleştirme `object` alanları](./customize-struct-marshalling.md#marshalling-systemobjects).</span><span class="sxs-lookup"><span data-stu-id="fbe13-134">The default type of the elements of the `SAFEARRAY` can be seen in the table on [customizing `object` fields](./customize-struct-marshalling.md#marshalling-systemobjects).</span></span> <span data-ttu-id="fbe13-135">Kullanabileceğiniz <xref:System.Runtime.InteropServices.MarshalAsAttribute.SafeArraySubType?displayProperty=nameWithType> ve <xref:System.Runtime.InteropServices.MarshalAsAttribute.SafeArrayUserDefinedSubType?displayProperty=nameWithType> tam öğe özelleştirmek için alanları türü `SAFEARRAY`.</span><span class="sxs-lookup"><span data-stu-id="fbe13-135">You can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute.SafeArraySubType?displayProperty=nameWithType> and <xref:System.Runtime.InteropServices.MarshalAsAttribute.SafeArrayUserDefinedSubType?displayProperty=nameWithType> fields to customize the exact element type of the `SAFEARRAY`.</span></span>

## <a name="customizing-boolean-or-decimal-parameters"></a><span data-ttu-id="fbe13-136">Ondalık ya da Boole parametreleri özelleştirme</span><span class="sxs-lookup"><span data-stu-id="fbe13-136">Customizing boolean or decimal parameters</span></span>

<span data-ttu-id="fbe13-137">Ondalık ya da Boole parametreleri taşıma hakkında daha fazla bilgi için bkz: [yapısı taşıma özelleştirme](customize-struct-marshalling.md).</span><span class="sxs-lookup"><span data-stu-id="fbe13-137">For information on marshalling boolean or decimal parameters, see [Customizing structure marshalling](customize-struct-marshalling.md).</span></span>

## <a name="customizing-object-parameters-windows-only"></a><span data-ttu-id="fbe13-138">Nesnesi parametrelerini özelleştirme (yalnızca Windows)</span><span class="sxs-lookup"><span data-stu-id="fbe13-138">Customizing object parameters (Windows-only)</span></span>

<span data-ttu-id="fbe13-139">Windows üzerinde .NET çalışma zamanı bir nesne parametreleri yerel kod için hazırlamak için farklı yollar sağlar.</span><span class="sxs-lookup"><span data-stu-id="fbe13-139">On Windows, the .NET runtime provides a number of different ways to marshal object parameters to native code.</span></span>

### <a name="marshalling-as-specific-com-interfaces"></a><span data-ttu-id="fbe13-140">Belirli bir COM arabirimleri olarak taşıma</span><span class="sxs-lookup"><span data-stu-id="fbe13-140">Marshalling as specific COM interfaces</span></span>

<span data-ttu-id="fbe13-141">API'nizi bir COM nesnesi için bir işaretçi alır, aşağıdakilerden herhangi birini kullanabilirsiniz `UnmanagedType` biçimleri üzerinde bir `object`-yazılan bu belirli arabirimleri hazırlamak için .NET bildirmek için parametre:</span><span class="sxs-lookup"><span data-stu-id="fbe13-141">If your API takes a pointer to a COM object, you can use any of the following `UnmanagedType` formats on an `object`-typed parameter to tell .NET to marshal as these specific interfaces:</span></span>

- `IUnknown`
- `IDispatch`
- `IInspectable`

<span data-ttu-id="fbe13-142">Ayrıca, türünüz işaretlenmişse `[ComVisible(true)]` veya taşıma `object` kullanabileceğiniz türü <xref:System.Runtime.InteropServices.UnmanagedType.Interface?displayProperty=nameWithType> COM çağrılabilir sarmalayıcı COM görünümün türünüz olarak nesnenizin sıralamakta biçimi.</span><span class="sxs-lookup"><span data-stu-id="fbe13-142">Additionally, if your type is marked `[ComVisible(true)]` or you're marshalling the `object` type, you can use the <xref:System.Runtime.InteropServices.UnmanagedType.Interface?displayProperty=nameWithType> format to marshal your object as a COM callable wrapper for the COM view of your type.</span></span>

### <a name="marshalling-to-a-variant"></a><span data-ttu-id="fbe13-143">Taşıma için bir `VARIANT`</span><span class="sxs-lookup"><span data-stu-id="fbe13-143">Marshalling to a `VARIANT`</span></span>

<span data-ttu-id="fbe13-144">API'nizi yerel bir Win32 sürerse `VARIANT`, kullanabileceğiniz <xref:System.Runtime.InteropServices.UnmanagedType.Struct?displayProperty=nameWithType> Biçimlendir, `object` nesnelerinizi olarak hazırlamak için parametre `VARIANT`s.</span><span class="sxs-lookup"><span data-stu-id="fbe13-144">If your native API takes a Win32 `VARIANT`, you can use the <xref:System.Runtime.InteropServices.UnmanagedType.Struct?displayProperty=nameWithType> format on your `object` parameter to marshal your objects as `VARIANT`s.</span></span> <span data-ttu-id="fbe13-145">İlgili belgelere bakın [özelleştirme `object` alanları](customize-struct-marshalling.md#marshalling-systemobjects) .NET türleri arasında bir eşleme için ve `VARIANT` türleri.</span><span class="sxs-lookup"><span data-stu-id="fbe13-145">See the documentation on [customizing `object` fields](customize-struct-marshalling.md#marshalling-systemobjects) for a mapping between .NET types and `VARIANT` types.</span></span>

### <a name="custom-marshalers"></a><span data-ttu-id="fbe13-146">Özel sıralayıcılara</span><span class="sxs-lookup"><span data-stu-id="fbe13-146">Custom marshalers</span></span>

<span data-ttu-id="fbe13-147">Yerel bir COM arabirimi farklı bir yönetilen türü proje istiyorsanız kullanabileceğiniz `UnmanagedType.CustomMarshaler` biçimi ve uygulaması <xref:System.Runtime.InteropServices.ICustomMarshaler> kendi özel sıralama kodu sağlayabilir.</span><span class="sxs-lookup"><span data-stu-id="fbe13-147">If you want to project a native COM interface into a different managed type, you can use the `UnmanagedType.CustomMarshaler` format and an implementation of <xref:System.Runtime.InteropServices.ICustomMarshaler> to provide your own custom marshalling code.</span></span>
